"use strict";var su=Object.create;var en=Object.defineProperty;var ou=Object.getOwnPropertyDescriptor;var iu=Object.getOwnPropertyNames;var cu=Object.getPrototypeOf,uu=Object.prototype.hasOwnProperty;var sr=(r,t)=>()=>(r&&(t=r(r=0)),t);var it=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports),ta=(r,t)=>{for(var n in t)en(r,n,{get:t[n],enumerable:!0})},Gs=(r,t,n,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of iu(t))!uu.call(r,o)&&o!==n&&en(r,o,{get:()=>t[o],enumerable:!(s=ou(t,o))||s.enumerable});return r};var te=(r,t,n)=>(n=r!=null?su(cu(r)):{},Gs(t||!r||!r.__esModule?en(n,"default",{value:r,enumerable:!0}):n,r)),lu=r=>Gs(en({},"__esModule",{value:!0}),r);var ba=it(re=>{"use strict";var fo=re&&re.__awaiter||function(r,t,n,s){function o(c){return c instanceof n?c:new n(function(u){u(c)})}return new(n||(n=Promise))(function(c,u){function m(y){try{b(s.next(y))}catch(_){u(_)}}function f(y){try{b(s.throw(y))}catch(_){u(_)}}function b(y){y.done?c(y.value):o(y.value).then(m,f)}b((s=s.apply(r,t||[])).next())})};Object.defineProperty(re,"__esModule",{value:!0});re.HttpError=re.optimistic=re.okify=re.ok=re.SUCCESS_CODES=re.handle=void 0;function Eu(r,t){return fo(this,void 0,void 0,function*(){let{status:n,data:s,headers:o}=yield r,c=t[n];if(c)return c(s);if(t.default)return t.default(n,s);throw new ir(n,s,o)})}re.handle=Eu;re.SUCCESS_CODES=[200,201,202,204];function po(r){return fo(this,void 0,void 0,function*(){let t=yield r;if(re.SUCCESS_CODES.some(n=>n==t.status))return t.data;throw new ir(t.status,t.data,t.headers)})}re.ok=po;function mo(r){return(...t)=>po(r(...t))}re.okify=mo;function Ru(r){let t={};return Object.entries(r).forEach(([n,s])=>{t[n]=typeof s=="function"?mo(s):s}),t}re.optimistic=Ru;var ir=class extends Error{constructor(t,n,s){super(`Error: ${t}`),this.status=t,this.data=n,this.headers=s}};re.HttpError=ir});var wa=it(ie=>{"use strict";Object.defineProperty(ie,"__esModule",{value:!0});ie.joinUrl=ie.stripUndefined=ie.delimited=ie.encode=ie.allowReserved=ie.encodeReserved=void 0;ie.encodeReserved=[encodeURIComponent,encodeURIComponent];ie.allowReserved=[encodeURIComponent,encodeURI];function ho(r,t=","){let n=(s,o)=>{let c=r[o%r.length];return typeof s>"u"?"":typeof s=="object"?Array.isArray(s)?s.map(c).join(t):Object.entries(s).reduce((m,f)=>[...m,...f],[]).map(c).join(t):c(String(s))};return(s,...o)=>s.reduce((c,u,m)=>`${c}${u}${n(o[m],m)}`,"")}ie.encode=ho;function xu(r=","){return(t,n=ie.encodeReserved)=>Object.entries(t).filter(([,s])=>s!==void 0).map(([s,o])=>ho(n,r)`${s}=${o}`).join("&")}ie.delimited=xu;function ju(r){return r&&JSON.parse(JSON.stringify(r))}ie.stripUndefined=ju;function vu(...r){return r.filter(Boolean).map((t,n)=>n===0?t:t.replace(/^\/+/,"")).map((t,n,s)=>n===s.length-1?t:t.replace(/\/+$/,"")).join("/")}ie.joinUrl=vu});var _a=it(ae=>{"use strict";Object.defineProperty(ae,"__esModule",{value:!0});ae.space=ae.pipe=ae.form=ae.json=ae.explode=ae.deep=ae.query=void 0;var qe=wa();function Au(...r){let t=r.filter(Boolean).join("&");return t&&`?${t}`}ae.query=Au;function Cu(r,[t,n]=qe.encodeReserved){let s=(0,qe.encode)([u=>u,t]),o=(0,qe.encode)([u=>u,n]),c=(u,m="")=>Object.entries(u).filter(([,f])=>f!==void 0).map(([f,b])=>{let y=Array.isArray(u)?"":f,_=m?s`${m}[${y}]`:f;return typeof b=="object"?c(b,_):o`${_}=${b}`}).join("&");return c(r)}ae.deep=Cu;function bo(r,t=qe.encodeReserved){let n=(0,qe.encode)(t);return Object.entries(r).filter(([,s])=>s!==void 0).map(([s,o])=>Array.isArray(o)?o.map(c=>n`${s}=${c}`).join("&"):typeof o=="object"?bo(o,t):n`${s}=${o}`).join("&")}ae.explode=bo;function Iu(r,t=qe.encodeReserved){let n=(0,qe.encode)(t);return Object.entries(r).filter(([,s])=>s!==void 0).map(([s,o])=>{let c=JSON.stringify(o);return n`${s}=${c}`}).join("&")}ae.json=Iu;ae.form=(0,qe.delimited)();ae.pipe=(0,qe.delimited)("|");ae.space=(0,qe.delimited)("%20")});var go=it(de=>{"use strict";var Uu=de&&de.__createBinding||(Object.create?(function(r,t,n,s){s===void 0&&(s=n);var o=Object.getOwnPropertyDescriptor(t,n);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(r,s,o)}):(function(r,t,n,s){s===void 0&&(s=n),r[s]=t[n]})),qu=de&&de.__setModuleDefault||(Object.create?(function(r,t){Object.defineProperty(r,"default",{enumerable:!0,value:t})}):function(r,t){r.default=t}),Mu=de&&de.__importStar||function(r){if(r&&r.__esModule)return r;var t={};if(r!=null)for(var n in r)n!=="default"&&Object.prototype.hasOwnProperty.call(r,n)&&Uu(t,r,n);return qu(t,r),t},un=de&&de.__awaiter||function(r,t,n,s){function o(c){return c instanceof n?c:new n(function(u){u(c)})}return new(n||(n=Promise))(function(c,u){function m(y){try{b(s.next(y))}catch(_){u(_)}}function f(y){try{b(s.throw(y))}catch(_){u(_)}}function b(y){y.done?c(y.value):o(y.value).then(m,f)}b((s=s.apply(r,t||[])).next())})},ln=de&&de.__rest||function(r,t){var n={};for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&t.indexOf(s)<0&&(n[s]=r[s]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(r);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(r,s[o])&&(n[s[o]]=r[s[o]]);return n};Object.defineProperty(de,"__esModule",{value:!0});de.runtime=void 0;var zu=Mu(_a()),yo=wa(),Lu=ba();function Du(r){function t(f,b){return un(this,void 0,void 0,function*(){let y=yield o(f,b),_;try{_=yield y.text()}catch{}return{status:y.status,headers:y.headers,contentType:y.headers.get("content-type"),data:_}})}function n(f,b={}){return un(this,void 0,void 0,function*(){let{status:y,headers:_,contentType:k,data:O}=yield t(f,Object.assign(Object.assign({},b),{headers:Object.assign({Accept:"application/json"},b.headers)}));return(k?k.includes("json"):!1)?{status:y,headers:_,data:O?JSON.parse(O):null}:{status:y,headers:_,data:O}})}function s(f,b={}){return un(this,void 0,void 0,function*(){let y=yield o(f,b),_;try{_=yield y.blob()}catch{}return{status:y.status,headers:y.headers,data:_}})}function o(f,b={}){return un(this,void 0,void 0,function*(){let y=Object.assign(Object.assign({},r),b),{baseUrl:_,headers:k,fetch:O}=y,w=ln(y,["baseUrl","headers","fetch"]),E=(0,yo.joinUrl)(_,f);return yield(O||fetch)(E,Object.assign(Object.assign({},w),{headers:(0,yo.stripUndefined)(Object.assign(Object.assign({},r.headers),k))}))})}function c(f){return f?.match(/\bjson\b/i)?f:"application/json"}function u(f){return f?.startsWith("application/x-www-form-urlencoded")?f:"application/x-www-form-urlencoded"}function m(f){return f?.startsWith("multipart/form-data")?f:"multipart/form-data"}return{ok:Lu.ok,fetchText:t,fetchJson:n,fetchBlob:s,json(f){var{body:b,headers:y}=f,_=ln(f,["body","headers"]);return Object.assign(Object.assign(Object.assign({},_),b!=null&&{body:JSON.stringify(b)}),{headers:Object.assign(Object.assign({},y),{"Content-Type":c(String(y?.["Content-Type"]))})})},form(f){var{body:b,headers:y}=f,_=ln(f,["body","headers"]);return Object.assign(Object.assign(Object.assign({},_),b!=null&&{body:zu.form(b)}),{headers:Object.assign(Object.assign({},y),{"Content-Type":u(String(y?.["Content-Type"]))})})},multipart(f){var{body:b,headers:y}=f,_=ln(f,["body","headers"]);if(b==null)return _;let k=new(r.formDataConstructor||_.formDataConstructor||FormData),O=(w,E)=>{typeof E=="string"||E instanceof Blob?k.append(w,E):k.append(w,new Blob([JSON.stringify(E)],{type:"application/json"}))};return Object.entries(b).forEach(([w,E])=>{Array.isArray(E)?E.forEach($=>O(w,$)):O(w,E)}),Object.assign(Object.assign({},_),{body:k,headers:Object.assign(Object.assign({},y),{"Content-Type":m(String(y?.["Content-Type"]))})})}}}de.runtime=Du});var ko=it((dn,Oo)=>{(function(r,t){typeof dn=="object"&&typeof Oo<"u"?t(dn):typeof define=="function"&&define.amd?define(["exports"],t):(r=typeof globalThis<"u"?globalThis:r||self,t(r.WebStreamsPolyfill={}))})(dn,(function(r){"use strict";let t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol:e=>`Symbol(${e})`;function n(){}function s(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global}let o=s();function c(e){return typeof e=="object"&&e!==null||typeof e=="function"}let u=n,m=Promise,f=Promise.prototype.then,b=Promise.resolve.bind(m),y=Promise.reject.bind(m);function _(e){return new m(e)}function k(e){return b(e)}function O(e){return y(e)}function w(e,a,i){return f.call(e,a,i)}function E(e,a,i){w(w(e,a,i),void 0,u)}function $(e,a){E(e,a)}function x(e,a){E(e,void 0,a)}function W(e,a,i){return w(e,a,i)}function F(e){w(e,void 0,u)}let T=(()=>{let e=o&&o.queueMicrotask;if(typeof e=="function")return e;let a=k(void 0);return i=>w(a,i)})();function z(e,a,i){if(typeof e!="function")throw new TypeError("Argument is not a function");return Function.prototype.apply.call(e,a,i)}function C(e,a,i){try{return k(z(e,a,i))}catch(l){return O(l)}}let se=16384;class ee{constructor(){this._cursor=0,this._size=0,this._front={_elements:[],_next:void 0},this._back=this._front,this._cursor=0,this._size=0}get length(){return this._size}push(a){let i=this._back,l=i;i._elements.length===se-1&&(l={_elements:[],_next:void 0}),i._elements.push(a),l!==i&&(this._back=l,i._next=l),++this._size}shift(){let a=this._front,i=a,l=this._cursor,p=l+1,g=a._elements,S=g[l];return p===se&&(i=a._next,p=0),--this._size,this._cursor=p,a!==i&&(this._front=i),g[l]=void 0,S}forEach(a){let i=this._cursor,l=this._front,p=l._elements;for(;(i!==p.length||l._next!==void 0)&&!(i===p.length&&(l=l._next,p=l._elements,i=0,p.length===0));)a(p[i]),++i}peek(){let a=this._front,i=this._cursor;return a._elements[i]}}function yt(e,a){e._ownerReadableStream=a,a._reader=e,a._state==="readable"?_e(e):a._state==="closed"?M(e):Te(e,a._storedError)}function et(e,a){let i=e._ownerReadableStream;return je(i,a)}function G(e){e._ownerReadableStream._state==="readable"?he(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):Dt(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")),e._ownerReadableStream._reader=void 0,e._ownerReadableStream=void 0}function H(e){return new TypeError("Cannot "+e+" a stream using a released reader")}function _e(e){e._closedPromise=_((a,i)=>{e._closedPromise_resolve=a,e._closedPromise_reject=i})}function Te(e,a){_e(e),he(e,a)}function M(e){_e(e),gt(e)}function he(e,a){e._closedPromise_reject!==void 0&&(F(e._closedPromise),e._closedPromise_reject(a),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}function Dt(e,a){Te(e,a)}function gt(e){e._closedPromise_resolve!==void 0&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}let gr=t("[[AbortSteps]]"),Sr=t("[[ErrorSteps]]"),Bt=t("[[CancelSteps]]"),Wt=t("[[PullSteps]]"),wr=Number.isFinite||function(e){return typeof e=="number"&&isFinite(e)},Tn=Math.trunc||function(e){return e<0?Math.ceil(e):Math.floor(e)};function Pn(e){return typeof e=="object"||typeof e=="function"}function Pe(e,a){if(e!==void 0&&!Pn(e))throw new TypeError(`${a} is not an object.`)}function be(e,a){if(typeof e!="function")throw new TypeError(`${a} is not a function.`)}function $n(e){return typeof e=="object"&&e!==null||typeof e=="function"}function _r(e,a){if(!$n(e))throw new TypeError(`${a} is not an object.`)}function $e(e,a,i){if(e===void 0)throw new TypeError(`Parameter ${a} is required in '${i}'.`)}function Ft(e,a,i){if(e===void 0)throw new TypeError(`${a} is required in '${i}'.`)}function xn(e){return Number(e)}function Ba(e){return e===0?0:e}function Li(e){return Ba(Tn(e))}function Wa(e,a){let l=Number.MAX_SAFE_INTEGER,p=Number(e);if(p=Ba(p),!wr(p))throw new TypeError(`${a} is not a finite number`);if(p=Li(p),p<0||p>l)throw new TypeError(`${a} is outside the accepted range of 0 to ${l}, inclusive`);return!wr(p)||p===0?0:p}function jn(e,a){if(!He(e))throw new TypeError(`${a} is not a ReadableStream.`)}function St(e){return new Nt(e)}function Fa(e,a){e._reader._readRequests.push(a)}function vn(e,a,i){let p=e._reader._readRequests.shift();i?p._closeSteps():p._chunkSteps(a)}function Or(e){return e._reader._readRequests.length}function Na(e){let a=e._reader;return!(a===void 0||!Ne(a))}class Nt{constructor(a){if($e(a,1,"ReadableStreamDefaultReader"),jn(a,"First parameter"),Ge(a))throw new TypeError("This stream has already been locked for exclusive reading by another reader");yt(this,a),this._readRequests=new ee}get closed(){return Ne(this)?this._closedPromise:O(kr("closed"))}cancel(a=void 0){return Ne(this)?this._ownerReadableStream===void 0?O(H("cancel")):et(this,a):O(kr("cancel"))}read(){if(!Ne(this))return O(kr("read"));if(this._ownerReadableStream===void 0)return O(H("read from"));let a,i,l=_((g,S)=>{a=g,i=S});return Qt(this,{_chunkSteps:g=>a({value:g,done:!1}),_closeSteps:()=>a({value:void 0,done:!0}),_errorSteps:g=>i(g)}),l}releaseLock(){if(!Ne(this))throw kr("releaseLock");if(this._ownerReadableStream!==void 0){if(this._readRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");G(this)}}}Object.defineProperties(Nt.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Nt.prototype,t.toStringTag,{value:"ReadableStreamDefaultReader",configurable:!0});function Ne(e){return!c(e)||!Object.prototype.hasOwnProperty.call(e,"_readRequests")?!1:e instanceof Nt}function Qt(e,a){let i=e._ownerReadableStream;i._disturbed=!0,i._state==="closed"?a._closeSteps():i._state==="errored"?a._errorSteps(i._storedError):i._readableStreamController[Wt](a)}function kr(e){return new TypeError(`ReadableStreamDefaultReader.prototype.${e} can only be used on a ReadableStreamDefaultReader`)}let Qa=Object.getPrototypeOf(Object.getPrototypeOf(async function*(){}).prototype);class Va{constructor(a,i){this._ongoingPromise=void 0,this._isFinished=!1,this._reader=a,this._preventCancel=i}next(){let a=()=>this._nextSteps();return this._ongoingPromise=this._ongoingPromise?W(this._ongoingPromise,a,a):a(),this._ongoingPromise}return(a){let i=()=>this._returnSteps(a);return this._ongoingPromise?W(this._ongoingPromise,i,i):i()}_nextSteps(){if(this._isFinished)return Promise.resolve({value:void 0,done:!0});let a=this._reader;if(a._ownerReadableStream===void 0)return O(H("iterate"));let i,l,p=_((S,R)=>{i=S,l=R});return Qt(a,{_chunkSteps:S=>{this._ongoingPromise=void 0,T(()=>i({value:S,done:!1}))},_closeSteps:()=>{this._ongoingPromise=void 0,this._isFinished=!0,G(a),i({value:void 0,done:!0})},_errorSteps:S=>{this._ongoingPromise=void 0,this._isFinished=!0,G(a),l(S)}}),p}_returnSteps(a){if(this._isFinished)return Promise.resolve({value:a,done:!0});this._isFinished=!0;let i=this._reader;if(i._ownerReadableStream===void 0)return O(H("finish iterating"));if(!this._preventCancel){let l=et(i,a);return G(i),W(l,()=>({value:a,done:!0}))}return G(i),k({value:a,done:!0})}}let Ja={next(){return Ha(this)?this._asyncIteratorImpl.next():O(Ga("next"))},return(e){return Ha(this)?this._asyncIteratorImpl.return(e):O(Ga("return"))}};Qa!==void 0&&Object.setPrototypeOf(Ja,Qa);function Di(e,a){let i=St(e),l=new Va(i,a),p=Object.create(Ja);return p._asyncIteratorImpl=l,p}function Ha(e){if(!c(e)||!Object.prototype.hasOwnProperty.call(e,"_asyncIteratorImpl"))return!1;try{return e._asyncIteratorImpl instanceof Va}catch{return!1}}function Ga(e){return new TypeError(`ReadableStreamAsyncIterator.${e} can only be used on a ReadableSteamAsyncIterator`)}let Ya=Number.isNaN||function(e){return e!==e};function Vt(e){return e.slice()}function Ka(e,a,i,l,p){new Uint8Array(e).set(new Uint8Array(i,l,p),a)}function Hd(e){return e}function Er(e){return!1}function Za(e,a,i){if(e.slice)return e.slice(a,i);let l=i-a,p=new ArrayBuffer(l);return Ka(p,0,e,a,l),p}function Bi(e){return!(typeof e!="number"||Ya(e)||e<0)}function Xa(e){let a=Za(e.buffer,e.byteOffset,e.byteOffset+e.byteLength);return new Uint8Array(a)}function An(e){let a=e._queue.shift();return e._queueTotalSize-=a.size,e._queueTotalSize<0&&(e._queueTotalSize=0),a.value}function Cn(e,a,i){if(!Bi(i)||i===1/0)throw new RangeError("Size must be a finite, non-NaN, non-negative number.");e._queue.push({value:a,size:i}),e._queueTotalSize+=i}function Wi(e){return e._queue.peek().value}function Qe(e){e._queue=new ee,e._queueTotalSize=0}class Jt{constructor(){throw new TypeError("Illegal constructor")}get view(){if(!In(this))throw zn("view");return this._view}respond(a){if(!In(this))throw zn("respond");if($e(a,1,"respond"),a=Wa(a,"First parameter"),this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");Er(this._view.buffer),xr(this._associatedReadableByteStreamController,a)}respondWithNewView(a){if(!In(this))throw zn("respondWithNewView");if($e(a,1,"respondWithNewView"),!ArrayBuffer.isView(a))throw new TypeError("You can only respond with array buffer views");if(this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");Er(a.buffer),jr(this._associatedReadableByteStreamController,a)}}Object.defineProperties(Jt.prototype,{respond:{enumerable:!0},respondWithNewView:{enumerable:!0},view:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Jt.prototype,t.toStringTag,{value:"ReadableStreamBYOBRequest",configurable:!0});class wt{constructor(){throw new TypeError("Illegal constructor")}get byobRequest(){if(!tt(this))throw Gt("byobRequest");return Mn(this)}get desiredSize(){if(!tt(this))throw Gt("desiredSize");return is(this)}close(){if(!tt(this))throw Gt("close");if(this._closeRequested)throw new TypeError("The stream has already been closed; do not close it again!");let a=this._controlledReadableByteStream._state;if(a!=="readable")throw new TypeError(`The stream (in ${a} state) is not in the readable state and cannot be closed`);Ht(this)}enqueue(a){if(!tt(this))throw Gt("enqueue");if($e(a,1,"enqueue"),!ArrayBuffer.isView(a))throw new TypeError("chunk must be an array buffer view");if(a.byteLength===0)throw new TypeError("chunk must have non-zero byteLength");if(a.buffer.byteLength===0)throw new TypeError("chunk's buffer must have non-zero byteLength");if(this._closeRequested)throw new TypeError("stream is closed or draining");let i=this._controlledReadableByteStream._state;if(i!=="readable")throw new TypeError(`The stream (in ${i} state) is not in the readable state and cannot be enqueued to`);$r(this,a)}error(a=void 0){if(!tt(this))throw Gt("error");xe(this,a)}[Bt](a){es(this),Qe(this);let i=this._cancelAlgorithm(a);return Pr(this),i}[Wt](a){let i=this._controlledReadableByteStream;if(this._queueTotalSize>0){let p=this._queue.shift();this._queueTotalSize-=p.byteLength,as(this);let g=new Uint8Array(p.buffer,p.byteOffset,p.byteLength);a._chunkSteps(g);return}let l=this._autoAllocateChunkSize;if(l!==void 0){let p;try{p=new ArrayBuffer(l)}catch(S){a._errorSteps(S);return}let g={buffer:p,bufferByteLength:l,byteOffset:0,byteLength:l,bytesFilled:0,elementSize:1,viewConstructor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(g)}Fa(i,a),rt(this)}}Object.defineProperties(wt.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},byobRequest:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(wt.prototype,t.toStringTag,{value:"ReadableByteStreamController",configurable:!0});function tt(e){return!c(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledReadableByteStream")?!1:e instanceof wt}function In(e){return!c(e)||!Object.prototype.hasOwnProperty.call(e,"_associatedReadableByteStreamController")?!1:e instanceof Jt}function rt(e){if(!Vi(e))return;if(e._pulling){e._pullAgain=!0;return}e._pulling=!0;let i=e._pullAlgorithm();E(i,()=>{e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,rt(e))},l=>{xe(e,l)})}function es(e){qn(e),e._pendingPullIntos=new ee}function Un(e,a){let i=!1;e._state==="closed"&&(i=!0);let l=ts(a);a.readerType==="default"?vn(e,l,i):Gi(e,l,i)}function ts(e){let a=e.bytesFilled,i=e.elementSize;return new e.viewConstructor(e.buffer,e.byteOffset,a/i)}function Rr(e,a,i,l){e._queue.push({buffer:a,byteOffset:i,byteLength:l}),e._queueTotalSize+=l}function rs(e,a){let i=a.elementSize,l=a.bytesFilled-a.bytesFilled%i,p=Math.min(e._queueTotalSize,a.byteLength-a.bytesFilled),g=a.bytesFilled+p,S=g-g%i,R=p,A=!1;S>l&&(R=S-a.bytesFilled,A=!0);let q=e._queue;for(;R>0;){let L=q.peek(),D=Math.min(R,L.byteLength),Y=a.byteOffset+a.bytesFilled;Ka(a.buffer,Y,L.buffer,L.byteOffset,D),L.byteLength===D?q.shift():(L.byteOffset+=D,L.byteLength-=D),e._queueTotalSize-=D,ns(e,D,a),R-=D}return A}function ns(e,a,i){i.bytesFilled+=a}function as(e){e._queueTotalSize===0&&e._closeRequested?(Pr(e),nr(e._controlledReadableByteStream)):rt(e)}function qn(e){e._byobRequest!==null&&(e._byobRequest._associatedReadableByteStreamController=void 0,e._byobRequest._view=null,e._byobRequest=null)}function ss(e){for(;e._pendingPullIntos.length>0;){if(e._queueTotalSize===0)return;let a=e._pendingPullIntos.peek();rs(e,a)&&(Tr(e),Un(e._controlledReadableByteStream,a))}}function Fi(e,a,i){let l=e._controlledReadableByteStream,p=1;a.constructor!==DataView&&(p=a.constructor.BYTES_PER_ELEMENT);let g=a.constructor,S=a.buffer,R={buffer:S,bufferByteLength:S.byteLength,byteOffset:a.byteOffset,byteLength:a.byteLength,bytesFilled:0,elementSize:p,viewConstructor:g,readerType:"byob"};if(e._pendingPullIntos.length>0){e._pendingPullIntos.push(R),ls(l,i);return}if(l._state==="closed"){let A=new g(R.buffer,R.byteOffset,0);i._closeSteps(A);return}if(e._queueTotalSize>0){if(rs(e,R)){let A=ts(R);as(e),i._chunkSteps(A);return}if(e._closeRequested){let A=new TypeError("Insufficient bytes to fill elements in the given buffer");xe(e,A),i._errorSteps(A);return}}e._pendingPullIntos.push(R),ls(l,i),rt(e)}function Ni(e,a){let i=e._controlledReadableByteStream;if(Ln(i))for(;ds(i)>0;){let l=Tr(e);Un(i,l)}}function Qi(e,a,i){if(ns(e,a,i),i.bytesFilled<i.elementSize)return;Tr(e);let l=i.bytesFilled%i.elementSize;if(l>0){let p=i.byteOffset+i.bytesFilled,g=Za(i.buffer,p-l,p);Rr(e,g,0,g.byteLength)}i.bytesFilled-=l,Un(e._controlledReadableByteStream,i),ss(e)}function os(e,a){let i=e._pendingPullIntos.peek();qn(e),e._controlledReadableByteStream._state==="closed"?Ni(e):Qi(e,a,i),rt(e)}function Tr(e){return e._pendingPullIntos.shift()}function Vi(e){let a=e._controlledReadableByteStream;return a._state!=="readable"||e._closeRequested||!e._started?!1:!!(Na(a)&&Or(a)>0||Ln(a)&&ds(a)>0||is(e)>0)}function Pr(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0}function Ht(e){let a=e._controlledReadableByteStream;if(!(e._closeRequested||a._state!=="readable")){if(e._queueTotalSize>0){e._closeRequested=!0;return}if(e._pendingPullIntos.length>0&&e._pendingPullIntos.peek().bytesFilled>0){let l=new TypeError("Insufficient bytes to fill elements in the given buffer");throw xe(e,l),l}Pr(e),nr(a)}}function $r(e,a){let i=e._controlledReadableByteStream;if(e._closeRequested||i._state!=="readable")return;let l=a.buffer,p=a.byteOffset,g=a.byteLength,S=l;if(e._pendingPullIntos.length>0){let R=e._pendingPullIntos.peek();Er(R.buffer),R.buffer=R.buffer}if(qn(e),Na(i))if(Or(i)===0)Rr(e,S,p,g);else{e._pendingPullIntos.length>0&&Tr(e);let R=new Uint8Array(S,p,g);vn(i,R,!1)}else Ln(i)?(Rr(e,S,p,g),ss(e)):Rr(e,S,p,g);rt(e)}function xe(e,a){let i=e._controlledReadableByteStream;i._state==="readable"&&(es(e),Qe(e),Pr(e),Us(i,a))}function Mn(e){if(e._byobRequest===null&&e._pendingPullIntos.length>0){let a=e._pendingPullIntos.peek(),i=new Uint8Array(a.buffer,a.byteOffset+a.bytesFilled,a.byteLength-a.bytesFilled),l=Object.create(Jt.prototype);Hi(l,e,i),e._byobRequest=l}return e._byobRequest}function is(e){let a=e._controlledReadableByteStream._state;return a==="errored"?null:a==="closed"?0:e._strategyHWM-e._queueTotalSize}function xr(e,a){let i=e._pendingPullIntos.peek();if(e._controlledReadableByteStream._state==="closed"){if(a!==0)throw new TypeError("bytesWritten must be 0 when calling respond() on a closed stream")}else{if(a===0)throw new TypeError("bytesWritten must be greater than 0 when calling respond() on a readable stream");if(i.bytesFilled+a>i.byteLength)throw new RangeError("bytesWritten out of range")}i.buffer=i.buffer,os(e,a)}function jr(e,a){let i=e._pendingPullIntos.peek();if(e._controlledReadableByteStream._state==="closed"){if(a.byteLength!==0)throw new TypeError("The view's length must be 0 when calling respondWithNewView() on a closed stream")}else if(a.byteLength===0)throw new TypeError("The view's length must be greater than 0 when calling respondWithNewView() on a readable stream");if(i.byteOffset+i.bytesFilled!==a.byteOffset)throw new RangeError("The region specified by view does not match byobRequest");if(i.bufferByteLength!==a.buffer.byteLength)throw new RangeError("The buffer of view has different capacity than byobRequest");if(i.bytesFilled+a.byteLength>i.byteLength)throw new RangeError("The region specified by view is larger than byobRequest");let p=a.byteLength;i.buffer=a.buffer,os(e,p)}function cs(e,a,i,l,p,g,S){a._controlledReadableByteStream=e,a._pullAgain=!1,a._pulling=!1,a._byobRequest=null,a._queue=a._queueTotalSize=void 0,Qe(a),a._closeRequested=!1,a._started=!1,a._strategyHWM=g,a._pullAlgorithm=l,a._cancelAlgorithm=p,a._autoAllocateChunkSize=S,a._pendingPullIntos=new ee,e._readableStreamController=a;let R=i();E(k(R),()=>{a._started=!0,rt(a)},A=>{xe(a,A)})}function Ji(e,a,i){let l=Object.create(wt.prototype),p=()=>{},g=()=>k(void 0),S=()=>k(void 0);a.start!==void 0&&(p=()=>a.start(l)),a.pull!==void 0&&(g=()=>a.pull(l)),a.cancel!==void 0&&(S=A=>a.cancel(A));let R=a.autoAllocateChunkSize;if(R===0)throw new TypeError("autoAllocateChunkSize must be greater than 0");cs(e,l,p,g,S,i,R)}function Hi(e,a,i){e._associatedReadableByteStreamController=a,e._view=i}function zn(e){return new TypeError(`ReadableStreamBYOBRequest.prototype.${e} can only be used on a ReadableStreamBYOBRequest`)}function Gt(e){return new TypeError(`ReadableByteStreamController.prototype.${e} can only be used on a ReadableByteStreamController`)}function us(e){return new Yt(e)}function ls(e,a){e._reader._readIntoRequests.push(a)}function Gi(e,a,i){let p=e._reader._readIntoRequests.shift();i?p._closeSteps(a):p._chunkSteps(a)}function ds(e){return e._reader._readIntoRequests.length}function Ln(e){let a=e._reader;return!(a===void 0||!nt(a))}class Yt{constructor(a){if($e(a,1,"ReadableStreamBYOBReader"),jn(a,"First parameter"),Ge(a))throw new TypeError("This stream has already been locked for exclusive reading by another reader");if(!tt(a._readableStreamController))throw new TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");yt(this,a),this._readIntoRequests=new ee}get closed(){return nt(this)?this._closedPromise:O(vr("closed"))}cancel(a=void 0){return nt(this)?this._ownerReadableStream===void 0?O(H("cancel")):et(this,a):O(vr("cancel"))}read(a){if(!nt(this))return O(vr("read"));if(!ArrayBuffer.isView(a))return O(new TypeError("view must be an array buffer view"));if(a.byteLength===0)return O(new TypeError("view must have non-zero byteLength"));if(a.buffer.byteLength===0)return O(new TypeError("view's buffer must have non-zero byteLength"));if(Er(a.buffer),this._ownerReadableStream===void 0)return O(H("read from"));let i,l,p=_((S,R)=>{i=S,l=R});return fs(this,a,{_chunkSteps:S=>i({value:S,done:!1}),_closeSteps:S=>i({value:S,done:!0}),_errorSteps:S=>l(S)}),p}releaseLock(){if(!nt(this))throw vr("releaseLock");if(this._ownerReadableStream!==void 0){if(this._readIntoRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");G(this)}}}Object.defineProperties(Yt.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Yt.prototype,t.toStringTag,{value:"ReadableStreamBYOBReader",configurable:!0});function nt(e){return!c(e)||!Object.prototype.hasOwnProperty.call(e,"_readIntoRequests")?!1:e instanceof Yt}function fs(e,a,i){let l=e._ownerReadableStream;l._disturbed=!0,l._state==="errored"?i._errorSteps(l._storedError):Fi(l._readableStreamController,a,i)}function vr(e){return new TypeError(`ReadableStreamBYOBReader.prototype.${e} can only be used on a ReadableStreamBYOBReader`)}function Kt(e,a){let{highWaterMark:i}=e;if(i===void 0)return a;if(Ya(i)||i<0)throw new RangeError("Invalid highWaterMark");return i}function Ar(e){let{size:a}=e;return a||(()=>1)}function Cr(e,a){Pe(e,a);let i=e?.highWaterMark,l=e?.size;return{highWaterMark:i===void 0?void 0:xn(i),size:l===void 0?void 0:Yi(l,`${a} has member 'size' that`)}}function Yi(e,a){return be(e,a),i=>xn(e(i))}function Ki(e,a){Pe(e,a);let i=e?.abort,l=e?.close,p=e?.start,g=e?.type,S=e?.write;return{abort:i===void 0?void 0:Zi(i,e,`${a} has member 'abort' that`),close:l===void 0?void 0:Xi(l,e,`${a} has member 'close' that`),start:p===void 0?void 0:ec(p,e,`${a} has member 'start' that`),write:S===void 0?void 0:tc(S,e,`${a} has member 'write' that`),type:g}}function Zi(e,a,i){return be(e,i),l=>C(e,a,[l])}function Xi(e,a,i){return be(e,i),()=>C(e,a,[])}function ec(e,a,i){return be(e,i),l=>z(e,a,[l])}function tc(e,a,i){return be(e,i),(l,p)=>C(e,a,[l,p])}function ps(e,a){if(!_t(e))throw new TypeError(`${a} is not a WritableStream.`)}function rc(e){if(typeof e!="object"||e===null)return!1;try{return typeof e.aborted=="boolean"}catch{return!1}}let nc=typeof AbortController=="function";function ac(){if(nc)return new AbortController}class Zt{constructor(a={},i={}){a===void 0?a=null:_r(a,"First parameter");let l=Cr(i,"Second parameter"),p=Ki(a,"First parameter");if(hs(this),p.type!==void 0)throw new RangeError("Invalid type is specified");let S=Ar(l),R=Kt(l,1);gc(this,p,R,S)}get locked(){if(!_t(this))throw zr("locked");return Ot(this)}abort(a=void 0){return _t(this)?Ot(this)?O(new TypeError("Cannot abort a stream that already has a writer")):Ir(this,a):O(zr("abort"))}close(){return _t(this)?Ot(this)?O(new TypeError("Cannot close a stream that already has a writer")):Ie(this)?O(new TypeError("Cannot close an already-closing stream")):bs(this):O(zr("close"))}getWriter(){if(!_t(this))throw zr("getWriter");return ms(this)}}Object.defineProperties(Zt.prototype,{abort:{enumerable:!0},close:{enumerable:!0},getWriter:{enumerable:!0},locked:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Zt.prototype,t.toStringTag,{value:"WritableStream",configurable:!0});function ms(e){return new Xt(e)}function sc(e,a,i,l,p=1,g=()=>1){let S=Object.create(Zt.prototype);hs(S);let R=Object.create(kt.prototype);return Os(S,R,e,a,i,l,p,g),S}function hs(e){e._state="writable",e._storedError=void 0,e._writer=void 0,e._writableStreamController=void 0,e._writeRequests=new ee,e._inFlightWriteRequest=void 0,e._closeRequest=void 0,e._inFlightCloseRequest=void 0,e._pendingAbortRequest=void 0,e._backpressure=!1}function _t(e){return!c(e)||!Object.prototype.hasOwnProperty.call(e,"_writableStreamController")?!1:e instanceof Zt}function Ot(e){return e._writer!==void 0}function Ir(e,a){var i;if(e._state==="closed"||e._state==="errored")return k(void 0);e._writableStreamController._abortReason=a,(i=e._writableStreamController._abortController)===null||i===void 0||i.abort();let l=e._state;if(l==="closed"||l==="errored")return k(void 0);if(e._pendingAbortRequest!==void 0)return e._pendingAbortRequest._promise;let p=!1;l==="erroring"&&(p=!0,a=void 0);let g=_((S,R)=>{e._pendingAbortRequest={_promise:void 0,_resolve:S,_reject:R,_reason:a,_wasAlreadyErroring:p}});return e._pendingAbortRequest._promise=g,p||Bn(e,a),g}function bs(e){let a=e._state;if(a==="closed"||a==="errored")return O(new TypeError(`The stream (in ${a} state) is not in the writable state and cannot be closed`));let i=_((p,g)=>{let S={_resolve:p,_reject:g};e._closeRequest=S}),l=e._writer;return l!==void 0&&e._backpressure&&a==="writable"&&Yn(l),Sc(e._writableStreamController),i}function oc(e){return _((i,l)=>{let p={_resolve:i,_reject:l};e._writeRequests.push(p)})}function Dn(e,a){if(e._state==="writable"){Bn(e,a);return}Wn(e)}function Bn(e,a){let i=e._writableStreamController;e._state="erroring",e._storedError=a;let l=e._writer;l!==void 0&&gs(l,a),!dc(e)&&i._started&&Wn(e)}function Wn(e){e._state="errored",e._writableStreamController[Sr]();let a=e._storedError;if(e._writeRequests.forEach(p=>{p._reject(a)}),e._writeRequests=new ee,e._pendingAbortRequest===void 0){Ur(e);return}let i=e._pendingAbortRequest;if(e._pendingAbortRequest=void 0,i._wasAlreadyErroring){i._reject(a),Ur(e);return}let l=e._writableStreamController[gr](i._reason);E(l,()=>{i._resolve(),Ur(e)},p=>{i._reject(p),Ur(e)})}function ic(e){e._inFlightWriteRequest._resolve(void 0),e._inFlightWriteRequest=void 0}function cc(e,a){e._inFlightWriteRequest._reject(a),e._inFlightWriteRequest=void 0,Dn(e,a)}function uc(e){e._inFlightCloseRequest._resolve(void 0),e._inFlightCloseRequest=void 0,e._state==="erroring"&&(e._storedError=void 0,e._pendingAbortRequest!==void 0&&(e._pendingAbortRequest._resolve(),e._pendingAbortRequest=void 0)),e._state="closed";let i=e._writer;i!==void 0&&Ts(i)}function lc(e,a){e._inFlightCloseRequest._reject(a),e._inFlightCloseRequest=void 0,e._pendingAbortRequest!==void 0&&(e._pendingAbortRequest._reject(a),e._pendingAbortRequest=void 0),Dn(e,a)}function Ie(e){return!(e._closeRequest===void 0&&e._inFlightCloseRequest===void 0)}function dc(e){return!(e._inFlightWriteRequest===void 0&&e._inFlightCloseRequest===void 0)}function fc(e){e._inFlightCloseRequest=e._closeRequest,e._closeRequest=void 0}function pc(e){e._inFlightWriteRequest=e._writeRequests.shift()}function Ur(e){e._closeRequest!==void 0&&(e._closeRequest._reject(e._storedError),e._closeRequest=void 0);let a=e._writer;a!==void 0&&Hn(a,e._storedError)}function Fn(e,a){let i=e._writer;i!==void 0&&a!==e._backpressure&&(a?Tc(i):Yn(i)),e._backpressure=a}class Xt{constructor(a){if($e(a,1,"WritableStreamDefaultWriter"),ps(a,"First parameter"),Ot(a))throw new TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=a,a._writer=this;let i=a._state;if(i==="writable")!Ie(a)&&a._backpressure?Dr(this):Ps(this),Lr(this);else if(i==="erroring")Gn(this,a._storedError),Lr(this);else if(i==="closed")Ps(this),Ec(this);else{let l=a._storedError;Gn(this,l),Rs(this,l)}}get closed(){return at(this)?this._closedPromise:O(st("closed"))}get desiredSize(){if(!at(this))throw st("desiredSize");if(this._ownerWritableStream===void 0)throw er("desiredSize");return yc(this)}get ready(){return at(this)?this._readyPromise:O(st("ready"))}abort(a=void 0){return at(this)?this._ownerWritableStream===void 0?O(er("abort")):mc(this,a):O(st("abort"))}close(){if(!at(this))return O(st("close"));let a=this._ownerWritableStream;return a===void 0?O(er("close")):Ie(a)?O(new TypeError("Cannot close an already-closing stream")):ys(this)}releaseLock(){if(!at(this))throw st("releaseLock");this._ownerWritableStream!==void 0&&Ss(this)}write(a=void 0){return at(this)?this._ownerWritableStream===void 0?O(er("write to")):ws(this,a):O(st("write"))}}Object.defineProperties(Xt.prototype,{abort:{enumerable:!0},close:{enumerable:!0},releaseLock:{enumerable:!0},write:{enumerable:!0},closed:{enumerable:!0},desiredSize:{enumerable:!0},ready:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Xt.prototype,t.toStringTag,{value:"WritableStreamDefaultWriter",configurable:!0});function at(e){return!c(e)||!Object.prototype.hasOwnProperty.call(e,"_ownerWritableStream")?!1:e instanceof Xt}function mc(e,a){let i=e._ownerWritableStream;return Ir(i,a)}function ys(e){let a=e._ownerWritableStream;return bs(a)}function hc(e){let a=e._ownerWritableStream,i=a._state;return Ie(a)||i==="closed"?k(void 0):i==="errored"?O(a._storedError):ys(e)}function bc(e,a){e._closedPromiseState==="pending"?Hn(e,a):Rc(e,a)}function gs(e,a){e._readyPromiseState==="pending"?$s(e,a):Pc(e,a)}function yc(e){let a=e._ownerWritableStream,i=a._state;return i==="errored"||i==="erroring"?null:i==="closed"?0:ks(a._writableStreamController)}function Ss(e){let a=e._ownerWritableStream,i=new TypeError("Writer was released and can no longer be used to monitor the stream's closedness");gs(e,i),bc(e,i),a._writer=void 0,e._ownerWritableStream=void 0}function ws(e,a){let i=e._ownerWritableStream,l=i._writableStreamController,p=wc(l,a);if(i!==e._ownerWritableStream)return O(er("write to"));let g=i._state;if(g==="errored")return O(i._storedError);if(Ie(i)||g==="closed")return O(new TypeError("The stream is closing or closed and cannot be written to"));if(g==="erroring")return O(i._storedError);let S=oc(i);return _c(l,a,p),S}let _s={};class kt{constructor(){throw new TypeError("Illegal constructor")}get abortReason(){if(!Nn(this))throw Jn("abortReason");return this._abortReason}get signal(){if(!Nn(this))throw Jn("signal");if(this._abortController===void 0)throw new TypeError("WritableStreamDefaultController.prototype.signal is not supported");return this._abortController.signal}error(a=void 0){if(!Nn(this))throw Jn("error");this._controlledWritableStream._state==="writable"&&Es(this,a)}[gr](a){let i=this._abortAlgorithm(a);return qr(this),i}[Sr](){Qe(this)}}Object.defineProperties(kt.prototype,{abortReason:{enumerable:!0},signal:{enumerable:!0},error:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(kt.prototype,t.toStringTag,{value:"WritableStreamDefaultController",configurable:!0});function Nn(e){return!c(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledWritableStream")?!1:e instanceof kt}function Os(e,a,i,l,p,g,S,R){a._controlledWritableStream=e,e._writableStreamController=a,a._queue=void 0,a._queueTotalSize=void 0,Qe(a),a._abortReason=void 0,a._abortController=ac(),a._started=!1,a._strategySizeAlgorithm=R,a._strategyHWM=S,a._writeAlgorithm=l,a._closeAlgorithm=p,a._abortAlgorithm=g;let A=Vn(a);Fn(e,A);let q=i(),L=k(q);E(L,()=>{a._started=!0,Mr(a)},D=>{a._started=!0,Dn(e,D)})}function gc(e,a,i,l){let p=Object.create(kt.prototype),g=()=>{},S=()=>k(void 0),R=()=>k(void 0),A=()=>k(void 0);a.start!==void 0&&(g=()=>a.start(p)),a.write!==void 0&&(S=q=>a.write(q,p)),a.close!==void 0&&(R=()=>a.close()),a.abort!==void 0&&(A=q=>a.abort(q)),Os(e,p,g,S,R,A,i,l)}function qr(e){e._writeAlgorithm=void 0,e._closeAlgorithm=void 0,e._abortAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function Sc(e){Cn(e,_s,0),Mr(e)}function wc(e,a){try{return e._strategySizeAlgorithm(a)}catch(i){return Qn(e,i),1}}function ks(e){return e._strategyHWM-e._queueTotalSize}function _c(e,a,i){try{Cn(e,a,i)}catch(p){Qn(e,p);return}let l=e._controlledWritableStream;if(!Ie(l)&&l._state==="writable"){let p=Vn(e);Fn(l,p)}Mr(e)}function Mr(e){let a=e._controlledWritableStream;if(!e._started||a._inFlightWriteRequest!==void 0)return;if(a._state==="erroring"){Wn(a);return}if(e._queue.length===0)return;let l=Wi(e);l===_s?Oc(e):kc(e,l)}function Qn(e,a){e._controlledWritableStream._state==="writable"&&Es(e,a)}function Oc(e){let a=e._controlledWritableStream;fc(a),An(e);let i=e._closeAlgorithm();qr(e),E(i,()=>{uc(a)},l=>{lc(a,l)})}function kc(e,a){let i=e._controlledWritableStream;pc(i);let l=e._writeAlgorithm(a);E(l,()=>{ic(i);let p=i._state;if(An(e),!Ie(i)&&p==="writable"){let g=Vn(e);Fn(i,g)}Mr(e)},p=>{i._state==="writable"&&qr(e),cc(i,p)})}function Vn(e){return ks(e)<=0}function Es(e,a){let i=e._controlledWritableStream;qr(e),Bn(i,a)}function zr(e){return new TypeError(`WritableStream.prototype.${e} can only be used on a WritableStream`)}function Jn(e){return new TypeError(`WritableStreamDefaultController.prototype.${e} can only be used on a WritableStreamDefaultController`)}function st(e){return new TypeError(`WritableStreamDefaultWriter.prototype.${e} can only be used on a WritableStreamDefaultWriter`)}function er(e){return new TypeError("Cannot "+e+" a stream using a released writer")}function Lr(e){e._closedPromise=_((a,i)=>{e._closedPromise_resolve=a,e._closedPromise_reject=i,e._closedPromiseState="pending"})}function Rs(e,a){Lr(e),Hn(e,a)}function Ec(e){Lr(e),Ts(e)}function Hn(e,a){e._closedPromise_reject!==void 0&&(F(e._closedPromise),e._closedPromise_reject(a),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="rejected")}function Rc(e,a){Rs(e,a)}function Ts(e){e._closedPromise_resolve!==void 0&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="resolved")}function Dr(e){e._readyPromise=_((a,i)=>{e._readyPromise_resolve=a,e._readyPromise_reject=i}),e._readyPromiseState="pending"}function Gn(e,a){Dr(e),$s(e,a)}function Ps(e){Dr(e),Yn(e)}function $s(e,a){e._readyPromise_reject!==void 0&&(F(e._readyPromise),e._readyPromise_reject(a),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="rejected")}function Tc(e){Dr(e)}function Pc(e,a){Gn(e,a)}function Yn(e){e._readyPromise_resolve!==void 0&&(e._readyPromise_resolve(void 0),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="fulfilled")}let xs=typeof DOMException<"u"?DOMException:void 0;function $c(e){if(!(typeof e=="function"||typeof e=="object"))return!1;try{return new e,!0}catch{return!1}}function xc(){let e=function(i,l){this.message=i||"",this.name=l||"Error",Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)};return e.prototype=Object.create(Error.prototype),Object.defineProperty(e.prototype,"constructor",{value:e,writable:!0,configurable:!0}),e}let jc=$c(xs)?xs:xc();function js(e,a,i,l,p,g){let S=St(e),R=ms(a);e._disturbed=!0;let A=!1,q=k(void 0);return _((L,D)=>{let Y;if(g!==void 0){if(Y=()=>{let P=new jc("Aborted","AbortError"),I=[];l||I.push(()=>a._state==="writable"?Ir(a,P):k(void 0)),p||I.push(()=>e._state==="readable"?je(e,P):k(void 0)),le(()=>Promise.all(I.map(Q=>Q())),!0,P)},g.aborted){Y();return}g.addEventListener("abort",Y)}function ve(){return _((P,I)=>{function Q(ye){ye?P():w(Tt(),Q,I)}Q(!1)})}function Tt(){return A?k(!0):w(R._readyPromise,()=>_((P,I)=>{Qt(S,{_chunkSteps:Q=>{q=w(ws(R,Q),void 0,n),P(!1)},_closeSteps:()=>P(!0),_errorSteps:I})}))}if(Le(e,S._closedPromise,P=>{l?Oe(!0,P):le(()=>Ir(a,P),!0,P)}),Le(a,R._closedPromise,P=>{p?Oe(!0,P):le(()=>je(e,P),!0,P)}),oe(e,S._closedPromise,()=>{i?Oe():le(()=>hc(R))}),Ie(a)||a._state==="closed"){let P=new TypeError("the destination writable stream closed before all data could be piped to it");p?Oe(!0,P):le(()=>je(e,P),!0,P)}F(ve());function Ye(){let P=q;return w(q,()=>P!==q?Ye():void 0)}function Le(P,I,Q){P._state==="errored"?Q(P._storedError):x(I,Q)}function oe(P,I,Q){P._state==="closed"?Q():$(I,Q)}function le(P,I,Q){if(A)return;A=!0,a._state==="writable"&&!Ie(a)?$(Ye(),ye):ye();function ye(){E(P(),()=>De(I,Q),Pt=>De(!0,Pt))}}function Oe(P,I){A||(A=!0,a._state==="writable"&&!Ie(a)?$(Ye(),()=>De(P,I)):De(P,I))}function De(P,I){Ss(R),G(S),g!==void 0&&g.removeEventListener("abort",Y),P?D(I):L(void 0)}})}class Et{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!Br(this))throw Nr("desiredSize");return Kn(this)}close(){if(!Br(this))throw Nr("close");if(!Rt(this))throw new TypeError("The stream is not in a state that permits close");rr(this)}enqueue(a=void 0){if(!Br(this))throw Nr("enqueue");if(!Rt(this))throw new TypeError("The stream is not in a state that permits enqueue");return Fr(this,a)}error(a=void 0){if(!Br(this))throw Nr("error");Ve(this,a)}[Bt](a){Qe(this);let i=this._cancelAlgorithm(a);return Wr(this),i}[Wt](a){let i=this._controlledReadableStream;if(this._queue.length>0){let l=An(this);this._closeRequested&&this._queue.length===0?(Wr(this),nr(i)):tr(this),a._chunkSteps(l)}else Fa(i,a),tr(this)}}Object.defineProperties(Et.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Et.prototype,t.toStringTag,{value:"ReadableStreamDefaultController",configurable:!0});function Br(e){return!c(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledReadableStream")?!1:e instanceof Et}function tr(e){if(!vs(e))return;if(e._pulling){e._pullAgain=!0;return}e._pulling=!0;let i=e._pullAlgorithm();E(i,()=>{e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,tr(e))},l=>{Ve(e,l)})}function vs(e){let a=e._controlledReadableStream;return!Rt(e)||!e._started?!1:!!(Ge(a)&&Or(a)>0||Kn(e)>0)}function Wr(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function rr(e){if(!Rt(e))return;let a=e._controlledReadableStream;e._closeRequested=!0,e._queue.length===0&&(Wr(e),nr(a))}function Fr(e,a){if(!Rt(e))return;let i=e._controlledReadableStream;if(Ge(i)&&Or(i)>0)vn(i,a,!1);else{let l;try{l=e._strategySizeAlgorithm(a)}catch(p){throw Ve(e,p),p}try{Cn(e,a,l)}catch(p){throw Ve(e,p),p}}tr(e)}function Ve(e,a){let i=e._controlledReadableStream;i._state==="readable"&&(Qe(e),Wr(e),Us(i,a))}function Kn(e){let a=e._controlledReadableStream._state;return a==="errored"?null:a==="closed"?0:e._strategyHWM-e._queueTotalSize}function vc(e){return!vs(e)}function Rt(e){let a=e._controlledReadableStream._state;return!e._closeRequested&&a==="readable"}function As(e,a,i,l,p,g,S){a._controlledReadableStream=e,a._queue=void 0,a._queueTotalSize=void 0,Qe(a),a._started=!1,a._closeRequested=!1,a._pullAgain=!1,a._pulling=!1,a._strategySizeAlgorithm=S,a._strategyHWM=g,a._pullAlgorithm=l,a._cancelAlgorithm=p,e._readableStreamController=a;let R=i();E(k(R),()=>{a._started=!0,tr(a)},A=>{Ve(a,A)})}function Ac(e,a,i,l){let p=Object.create(Et.prototype),g=()=>{},S=()=>k(void 0),R=()=>k(void 0);a.start!==void 0&&(g=()=>a.start(p)),a.pull!==void 0&&(S=()=>a.pull(p)),a.cancel!==void 0&&(R=A=>a.cancel(A)),As(e,p,g,S,R,i,l)}function Nr(e){return new TypeError(`ReadableStreamDefaultController.prototype.${e} can only be used on a ReadableStreamDefaultController`)}function Cc(e,a){return tt(e._readableStreamController)?Uc(e):Ic(e)}function Ic(e,a){let i=St(e),l=!1,p=!1,g=!1,S=!1,R,A,q,L,D,Y=_(oe=>{D=oe});function ve(){return l?(p=!0,k(void 0)):(l=!0,Qt(i,{_chunkSteps:le=>{T(()=>{p=!1;let Oe=le,De=le;g||Fr(q._readableStreamController,Oe),S||Fr(L._readableStreamController,De),l=!1,p&&ve()})},_closeSteps:()=>{l=!1,g||rr(q._readableStreamController),S||rr(L._readableStreamController),(!g||!S)&&D(void 0)},_errorSteps:()=>{l=!1}}),k(void 0))}function Tt(oe){if(g=!0,R=oe,S){let le=Vt([R,A]),Oe=je(e,le);D(Oe)}return Y}function Ye(oe){if(S=!0,A=oe,g){let le=Vt([R,A]),Oe=je(e,le);D(Oe)}return Y}function Le(){}return q=Zn(Le,ve,Tt),L=Zn(Le,ve,Ye),x(i._closedPromise,oe=>{Ve(q._readableStreamController,oe),Ve(L._readableStreamController,oe),(!g||!S)&&D(void 0)}),[q,L]}function Uc(e){let a=St(e),i=!1,l=!1,p=!1,g=!1,S=!1,R,A,q,L,D,Y=_(P=>{D=P});function ve(P){x(P._closedPromise,I=>{P===a&&(xe(q._readableStreamController,I),xe(L._readableStreamController,I),(!g||!S)&&D(void 0))})}function Tt(){nt(a)&&(G(a),a=St(e),ve(a)),Qt(a,{_chunkSteps:I=>{T(()=>{l=!1,p=!1;let Q=I,ye=I;if(!g&&!S)try{ye=Xa(I)}catch(Pt){xe(q._readableStreamController,Pt),xe(L._readableStreamController,Pt),D(je(e,Pt));return}g||$r(q._readableStreamController,Q),S||$r(L._readableStreamController,ye),i=!1,l?Le():p&&oe()})},_closeSteps:()=>{i=!1,g||Ht(q._readableStreamController),S||Ht(L._readableStreamController),q._readableStreamController._pendingPullIntos.length>0&&xr(q._readableStreamController,0),L._readableStreamController._pendingPullIntos.length>0&&xr(L._readableStreamController,0),(!g||!S)&&D(void 0)},_errorSteps:()=>{i=!1}})}function Ye(P,I){Ne(a)&&(G(a),a=us(e),ve(a));let Q=I?L:q,ye=I?q:L;fs(a,P,{_chunkSteps:$t=>{T(()=>{l=!1,p=!1;let xt=I?S:g;if(I?g:S)xt||jr(Q._readableStreamController,$t);else{let Hs;try{Hs=Xa($t)}catch(ea){xe(Q._readableStreamController,ea),xe(ye._readableStreamController,ea),D(je(e,ea));return}xt||jr(Q._readableStreamController,$t),$r(ye._readableStreamController,Hs)}i=!1,l?Le():p&&oe()})},_closeSteps:$t=>{i=!1;let xt=I?S:g,Xr=I?g:S;xt||Ht(Q._readableStreamController),Xr||Ht(ye._readableStreamController),$t!==void 0&&(xt||jr(Q._readableStreamController,$t),!Xr&&ye._readableStreamController._pendingPullIntos.length>0&&xr(ye._readableStreamController,0)),(!xt||!Xr)&&D(void 0)},_errorSteps:()=>{i=!1}})}function Le(){if(i)return l=!0,k(void 0);i=!0;let P=Mn(q._readableStreamController);return P===null?Tt():Ye(P._view,!1),k(void 0)}function oe(){if(i)return p=!0,k(void 0);i=!0;let P=Mn(L._readableStreamController);return P===null?Tt():Ye(P._view,!0),k(void 0)}function le(P){if(g=!0,R=P,S){let I=Vt([R,A]),Q=je(e,I);D(Q)}return Y}function Oe(P){if(S=!0,A=P,g){let I=Vt([R,A]),Q=je(e,I);D(Q)}return Y}function De(){}return q=Is(De,Le,le),L=Is(De,oe,Oe),ve(a),[q,L]}function qc(e,a){Pe(e,a);let i=e,l=i?.autoAllocateChunkSize,p=i?.cancel,g=i?.pull,S=i?.start,R=i?.type;return{autoAllocateChunkSize:l===void 0?void 0:Wa(l,`${a} has member 'autoAllocateChunkSize' that`),cancel:p===void 0?void 0:Mc(p,i,`${a} has member 'cancel' that`),pull:g===void 0?void 0:zc(g,i,`${a} has member 'pull' that`),start:S===void 0?void 0:Lc(S,i,`${a} has member 'start' that`),type:R===void 0?void 0:Dc(R,`${a} has member 'type' that`)}}function Mc(e,a,i){return be(e,i),l=>C(e,a,[l])}function zc(e,a,i){return be(e,i),l=>C(e,a,[l])}function Lc(e,a,i){return be(e,i),l=>z(e,a,[l])}function Dc(e,a){if(e=`${e}`,e!=="bytes")throw new TypeError(`${a} '${e}' is not a valid enumeration value for ReadableStreamType`);return e}function Bc(e,a){Pe(e,a);let i=e?.mode;return{mode:i===void 0?void 0:Wc(i,`${a} has member 'mode' that`)}}function Wc(e,a){if(e=`${e}`,e!=="byob")throw new TypeError(`${a} '${e}' is not a valid enumeration value for ReadableStreamReaderMode`);return e}function Fc(e,a){return Pe(e,a),{preventCancel:!!e?.preventCancel}}function Cs(e,a){Pe(e,a);let i=e?.preventAbort,l=e?.preventCancel,p=e?.preventClose,g=e?.signal;return g!==void 0&&Nc(g,`${a} has member 'signal' that`),{preventAbort:!!i,preventCancel:!!l,preventClose:!!p,signal:g}}function Nc(e,a){if(!rc(e))throw new TypeError(`${a} is not an AbortSignal.`)}function Qc(e,a){Pe(e,a);let i=e?.readable;Ft(i,"readable","ReadableWritablePair"),jn(i,`${a} has member 'readable' that`);let l=e?.writable;return Ft(l,"writable","ReadableWritablePair"),ps(l,`${a} has member 'writable' that`),{readable:i,writable:l}}class Je{constructor(a={},i={}){a===void 0?a=null:_r(a,"First parameter");let l=Cr(i,"Second parameter"),p=qc(a,"First parameter");if(Xn(this),p.type==="bytes"){if(l.size!==void 0)throw new RangeError("The strategy for a byte stream cannot have a size function");let g=Kt(l,0);Ji(this,p,g)}else{let g=Ar(l),S=Kt(l,1);Ac(this,p,S,g)}}get locked(){if(!He(this))throw ot("locked");return Ge(this)}cancel(a=void 0){return He(this)?Ge(this)?O(new TypeError("Cannot cancel a stream that already has a reader")):je(this,a):O(ot("cancel"))}getReader(a=void 0){if(!He(this))throw ot("getReader");return Bc(a,"First parameter").mode===void 0?St(this):us(this)}pipeThrough(a,i={}){if(!He(this))throw ot("pipeThrough");$e(a,1,"pipeThrough");let l=Qc(a,"First parameter"),p=Cs(i,"Second parameter");if(Ge(this))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked ReadableStream");if(Ot(l.writable))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked WritableStream");let g=js(this,l.writable,p.preventClose,p.preventAbort,p.preventCancel,p.signal);return F(g),l.readable}pipeTo(a,i={}){if(!He(this))return O(ot("pipeTo"));if(a===void 0)return O("Parameter 1 is required in 'pipeTo'.");if(!_t(a))return O(new TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream"));let l;try{l=Cs(i,"Second parameter")}catch(p){return O(p)}return Ge(this)?O(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream")):Ot(a)?O(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream")):js(this,a,l.preventClose,l.preventAbort,l.preventCancel,l.signal)}tee(){if(!He(this))throw ot("tee");let a=Cc(this);return Vt(a)}values(a=void 0){if(!He(this))throw ot("values");let i=Fc(a,"First parameter");return Di(this,i.preventCancel)}}Object.defineProperties(Je.prototype,{cancel:{enumerable:!0},getReader:{enumerable:!0},pipeThrough:{enumerable:!0},pipeTo:{enumerable:!0},tee:{enumerable:!0},values:{enumerable:!0},locked:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Je.prototype,t.toStringTag,{value:"ReadableStream",configurable:!0}),typeof t.asyncIterator=="symbol"&&Object.defineProperty(Je.prototype,t.asyncIterator,{value:Je.prototype.values,writable:!0,configurable:!0});function Zn(e,a,i,l=1,p=()=>1){let g=Object.create(Je.prototype);Xn(g);let S=Object.create(Et.prototype);return As(g,S,e,a,i,l,p),g}function Is(e,a,i){let l=Object.create(Je.prototype);Xn(l);let p=Object.create(wt.prototype);return cs(l,p,e,a,i,0,void 0),l}function Xn(e){e._state="readable",e._reader=void 0,e._storedError=void 0,e._disturbed=!1}function He(e){return!c(e)||!Object.prototype.hasOwnProperty.call(e,"_readableStreamController")?!1:e instanceof Je}function Ge(e){return e._reader!==void 0}function je(e,a){if(e._disturbed=!0,e._state==="closed")return k(void 0);if(e._state==="errored")return O(e._storedError);nr(e);let i=e._reader;i!==void 0&&nt(i)&&(i._readIntoRequests.forEach(p=>{p._closeSteps(void 0)}),i._readIntoRequests=new ee);let l=e._readableStreamController[Bt](a);return W(l,n)}function nr(e){e._state="closed";let a=e._reader;a!==void 0&&(gt(a),Ne(a)&&(a._readRequests.forEach(i=>{i._closeSteps()}),a._readRequests=new ee))}function Us(e,a){e._state="errored",e._storedError=a;let i=e._reader;i!==void 0&&(he(i,a),Ne(i)?(i._readRequests.forEach(l=>{l._errorSteps(a)}),i._readRequests=new ee):(i._readIntoRequests.forEach(l=>{l._errorSteps(a)}),i._readIntoRequests=new ee))}function ot(e){return new TypeError(`ReadableStream.prototype.${e} can only be used on a ReadableStream`)}function qs(e,a){Pe(e,a);let i=e?.highWaterMark;return Ft(i,"highWaterMark","QueuingStrategyInit"),{highWaterMark:xn(i)}}let Ms=e=>e.byteLength;try{Object.defineProperty(Ms,"name",{value:"size",configurable:!0})}catch{}class Qr{constructor(a){$e(a,1,"ByteLengthQueuingStrategy"),a=qs(a,"First parameter"),this._byteLengthQueuingStrategyHighWaterMark=a.highWaterMark}get highWaterMark(){if(!Ls(this))throw zs("highWaterMark");return this._byteLengthQueuingStrategyHighWaterMark}get size(){if(!Ls(this))throw zs("size");return Ms}}Object.defineProperties(Qr.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Qr.prototype,t.toStringTag,{value:"ByteLengthQueuingStrategy",configurable:!0});function zs(e){return new TypeError(`ByteLengthQueuingStrategy.prototype.${e} can only be used on a ByteLengthQueuingStrategy`)}function Ls(e){return!c(e)||!Object.prototype.hasOwnProperty.call(e,"_byteLengthQueuingStrategyHighWaterMark")?!1:e instanceof Qr}let Ds=()=>1;try{Object.defineProperty(Ds,"name",{value:"size",configurable:!0})}catch{}class Vr{constructor(a){$e(a,1,"CountQueuingStrategy"),a=qs(a,"First parameter"),this._countQueuingStrategyHighWaterMark=a.highWaterMark}get highWaterMark(){if(!Ws(this))throw Bs("highWaterMark");return this._countQueuingStrategyHighWaterMark}get size(){if(!Ws(this))throw Bs("size");return Ds}}Object.defineProperties(Vr.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Vr.prototype,t.toStringTag,{value:"CountQueuingStrategy",configurable:!0});function Bs(e){return new TypeError(`CountQueuingStrategy.prototype.${e} can only be used on a CountQueuingStrategy`)}function Ws(e){return!c(e)||!Object.prototype.hasOwnProperty.call(e,"_countQueuingStrategyHighWaterMark")?!1:e instanceof Vr}function Vc(e,a){Pe(e,a);let i=e?.flush,l=e?.readableType,p=e?.start,g=e?.transform,S=e?.writableType;return{flush:i===void 0?void 0:Jc(i,e,`${a} has member 'flush' that`),readableType:l,start:p===void 0?void 0:Hc(p,e,`${a} has member 'start' that`),transform:g===void 0?void 0:Gc(g,e,`${a} has member 'transform' that`),writableType:S}}function Jc(e,a,i){return be(e,i),l=>C(e,a,[l])}function Hc(e,a,i){return be(e,i),l=>z(e,a,[l])}function Gc(e,a,i){return be(e,i),(l,p)=>C(e,a,[l,p])}class Jr{constructor(a={},i={},l={}){a===void 0&&(a=null);let p=Cr(i,"Second parameter"),g=Cr(l,"Third parameter"),S=Vc(a,"First parameter");if(S.readableType!==void 0)throw new RangeError("Invalid readableType specified");if(S.writableType!==void 0)throw new RangeError("Invalid writableType specified");let R=Kt(g,0),A=Ar(g),q=Kt(p,1),L=Ar(p),D,Y=_(ve=>{D=ve});Yc(this,Y,q,L,R,A),Zc(this,S),S.start!==void 0?D(S.start(this._transformStreamController)):D(void 0)}get readable(){if(!Fs(this))throw Js("readable");return this._readable}get writable(){if(!Fs(this))throw Js("writable");return this._writable}}Object.defineProperties(Jr.prototype,{readable:{enumerable:!0},writable:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Jr.prototype,t.toStringTag,{value:"TransformStream",configurable:!0});function Yc(e,a,i,l,p,g){function S(){return a}function R(Y){return tu(e,Y)}function A(Y){return ru(e,Y)}function q(){return nu(e)}e._writable=sc(S,R,q,A,i,l);function L(){return au(e)}function D(Y){return Gr(e,Y),k(void 0)}e._readable=Zn(S,L,D,p,g),e._backpressure=void 0,e._backpressureChangePromise=void 0,e._backpressureChangePromise_resolve=void 0,Yr(e,!0),e._transformStreamController=void 0}function Fs(e){return!c(e)||!Object.prototype.hasOwnProperty.call(e,"_transformStreamController")?!1:e instanceof Jr}function Hr(e,a){Ve(e._readable._readableStreamController,a),Gr(e,a)}function Gr(e,a){Ns(e._transformStreamController),Qn(e._writable._writableStreamController,a),e._backpressure&&Yr(e,!1)}function Yr(e,a){e._backpressureChangePromise!==void 0&&e._backpressureChangePromise_resolve(),e._backpressureChangePromise=_(i=>{e._backpressureChangePromise_resolve=i}),e._backpressure=a}class ar{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!Kr(this))throw Zr("desiredSize");let a=this._controlledTransformStream._readable._readableStreamController;return Kn(a)}enqueue(a=void 0){if(!Kr(this))throw Zr("enqueue");Qs(this,a)}error(a=void 0){if(!Kr(this))throw Zr("error");Xc(this,a)}terminate(){if(!Kr(this))throw Zr("terminate");eu(this)}}Object.defineProperties(ar.prototype,{enqueue:{enumerable:!0},error:{enumerable:!0},terminate:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(ar.prototype,t.toStringTag,{value:"TransformStreamDefaultController",configurable:!0});function Kr(e){return!c(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledTransformStream")?!1:e instanceof ar}function Kc(e,a,i,l){a._controlledTransformStream=e,e._transformStreamController=a,a._transformAlgorithm=i,a._flushAlgorithm=l}function Zc(e,a){let i=Object.create(ar.prototype),l=g=>{try{return Qs(i,g),k(void 0)}catch(S){return O(S)}},p=()=>k(void 0);a.transform!==void 0&&(l=g=>a.transform(g,i)),a.flush!==void 0&&(p=()=>a.flush(i)),Kc(e,i,l,p)}function Ns(e){e._transformAlgorithm=void 0,e._flushAlgorithm=void 0}function Qs(e,a){let i=e._controlledTransformStream,l=i._readable._readableStreamController;if(!Rt(l))throw new TypeError("Readable side is not in a state that permits enqueue");try{Fr(l,a)}catch(g){throw Gr(i,g),i._readable._storedError}vc(l)!==i._backpressure&&Yr(i,!0)}function Xc(e,a){Hr(e._controlledTransformStream,a)}function Vs(e,a){let i=e._transformAlgorithm(a);return W(i,void 0,l=>{throw Hr(e._controlledTransformStream,l),l})}function eu(e){let a=e._controlledTransformStream,i=a._readable._readableStreamController;rr(i);let l=new TypeError("TransformStream terminated");Gr(a,l)}function tu(e,a){let i=e._transformStreamController;if(e._backpressure){let l=e._backpressureChangePromise;return W(l,()=>{let p=e._writable;if(p._state==="erroring")throw p._storedError;return Vs(i,a)})}return Vs(i,a)}function ru(e,a){return Hr(e,a),k(void 0)}function nu(e){let a=e._readable,i=e._transformStreamController,l=i._flushAlgorithm();return Ns(i),W(l,()=>{if(a._state==="errored")throw a._storedError;rr(a._readableStreamController)},p=>{throw Hr(e,p),a._storedError})}function au(e){return Yr(e,!1),e._backpressureChangePromise}function Zr(e){return new TypeError(`TransformStreamDefaultController.prototype.${e} can only be used on a TransformStreamDefaultController`)}function Js(e){return new TypeError(`TransformStream.prototype.${e} can only be used on a TransformStream`)}r.ByteLengthQueuingStrategy=Qr,r.CountQueuingStrategy=Vr,r.ReadableByteStreamController=wt,r.ReadableStream=Je,r.ReadableStreamBYOBReader=Yt,r.ReadableStreamBYOBRequest=Jt,r.ReadableStreamDefaultController=Et,r.ReadableStreamDefaultReader=Nt,r.TransformStream=Jr,r.TransformStreamDefaultController=ar,r.WritableStream=Zt,r.WritableStreamDefaultController=kt,r.WritableStreamDefaultWriter=Xt,Object.defineProperty(r,"__esModule",{value:!0})}))});var Eo=it(()=>{if(!globalThis.ReadableStream)try{let r=require("node:process"),{emitWarning:t}=r;try{r.emitWarning=()=>{},Object.assign(globalThis,require("node:stream/web")),r.emitWarning=t}catch(n){throw r.emitWarning=t,n}}catch{Object.assign(globalThis,ko())}try{let{Blob:r}=require("buffer");r&&!r.prototype.stream&&(r.prototype.stream=function(n){let s=0,o=this;return new ReadableStream({type:"bytes",async pull(c){let m=await o.slice(s,Math.min(o.size,s+65536)).arrayBuffer();s+=m.byteLength,c.enqueue(new Uint8Array(m)),s===o.size&&c.close()}})})}catch{}});async function*ka(r,t=!0){for(let n of r)if("stream"in n)yield*n.stream();else if(ArrayBuffer.isView(n))if(t){let s=n.byteOffset,o=n.byteOffset+n.byteLength;for(;s!==o;){let c=Math.min(o-s,Ro),u=n.buffer.slice(s,s+c);s+=u.byteLength,yield new Uint8Array(u)}}else yield n;else{let s=0,o=n;for(;s!==o.size;){let u=await o.slice(s,Math.min(o.size,s+Ro)).arrayBuffer();s+=u.byteLength,yield new Uint8Array(u)}}}var lf,Ro,To,Ed,Be,ur=sr(()=>{lf=te(Eo(),1);Ro=65536;To=class Ea{#t=[];#r="";#e=0;#s="transparent";constructor(t=[],n={}){if(typeof t!="object"||t===null)throw new TypeError("Failed to construct 'Blob': The provided value cannot be converted to a sequence.");if(typeof t[Symbol.iterator]!="function")throw new TypeError("Failed to construct 'Blob': The object must have a callable @@iterator property.");if(typeof n!="object"&&typeof n!="function")throw new TypeError("Failed to construct 'Blob': parameter 2 cannot convert to dictionary.");n===null&&(n={});let s=new TextEncoder;for(let c of t){let u;ArrayBuffer.isView(c)?u=new Uint8Array(c.buffer.slice(c.byteOffset,c.byteOffset+c.byteLength)):c instanceof ArrayBuffer?u=new Uint8Array(c.slice(0)):c instanceof Ea?u=c:u=s.encode(`${c}`),this.#e+=ArrayBuffer.isView(u)?u.byteLength:u.size,this.#t.push(u)}this.#s=`${n.endings===void 0?"transparent":n.endings}`;let o=n.type===void 0?"":String(n.type);this.#r=/^[\x20-\x7E]*$/.test(o)?o:""}get size(){return this.#e}get type(){return this.#r}async text(){let t=new TextDecoder,n="";for await(let s of ka(this.#t,!1))n+=t.decode(s,{stream:!0});return n+=t.decode(),n}async arrayBuffer(){let t=new Uint8Array(this.size),n=0;for await(let s of ka(this.#t,!1))t.set(s,n),n+=s.length;return t.buffer}stream(){let t=ka(this.#t,!0);return new globalThis.ReadableStream({type:"bytes",async pull(n){let s=await t.next();s.done?n.close():n.enqueue(s.value)},async cancel(){await t.return()}})}slice(t=0,n=this.size,s=""){let{size:o}=this,c=t<0?Math.max(o+t,0):Math.min(t,o),u=n<0?Math.max(o+n,0):Math.min(n,o),m=Math.max(u-c,0),f=this.#t,b=[],y=0;for(let k of f){if(y>=m)break;let O=ArrayBuffer.isView(k)?k.byteLength:k.size;if(c&&O<=c)c-=O,u-=O;else{let w;ArrayBuffer.isView(k)?(w=k.subarray(c,Math.min(O,u)),y+=w.byteLength):(w=k.slice(c,Math.min(O,u)),y+=w.size),u-=O,b.push(w),c=0}}let _=new Ea([],{type:String(s).toLowerCase()});return _.#e=m,_.#t=b,_}get[Symbol.toStringTag](){return"Blob"}static[Symbol.hasInstance](t){return t&&typeof t=="object"&&typeof t.constructor=="function"&&(typeof t.stream=="function"||typeof t.arrayBuffer=="function")&&/^(Blob|File)$/.test(t[Symbol.toStringTag])}};Object.defineProperties(To.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}});Ed=To,Be=Ed});var Rd,Td,It,Ra=sr(()=>{ur();Rd=class extends Be{#t=0;#r="";constructor(t,n,s={}){if(arguments.length<2)throw new TypeError(`Failed to construct 'File': 2 arguments required, but only ${arguments.length} present.`);super(t,s),s===null&&(s={});let o=s.lastModified===void 0?Date.now():Number(s.lastModified);Number.isNaN(o)||(this.#t=o),this.#r=String(n)}get name(){return this.#r}get lastModified(){return this.#t}get[Symbol.toStringTag](){return"File"}static[Symbol.hasInstance](t){return!!t&&t instanceof Be&&/^(File)$/.test(t[Symbol.toStringTag])}},Td=Rd,It=Td});function xo(r,t=Be){var n=`${Po()}${Po()}`.replace(/\./g,"").slice(-28).padStart(32,"-"),s=[],o=`--${n}\r
Content-Disposition: form-data; name="`;return r.forEach((c,u)=>typeof c=="string"?s.push(o+Ta(u)+`"\r
\r
${c.replace(/\r(?!\n)|(?<!\r)\n/g,`\r
`)}\r
`):s.push(o+Ta(u)+`"; filename="${Ta(c.name,1)}"\r
Content-Type: ${c.type||"application/octet-stream"}\r
\r
`,c,`\r
`)),s.push(`--${n}--`),new t(s,{type:"multipart/form-data; boundary="+n})}var lr,Pd,$d,Po,xd,$o,Ta,lt,dt,fn=sr(()=>{ur();Ra();({toStringTag:lr,iterator:Pd,hasInstance:$d}=Symbol),Po=Math.random,xd="append,set,get,getAll,delete,keys,values,entries,forEach,constructor".split(","),$o=(r,t,n)=>(r+="",/^(Blob|File)$/.test(t&&t[lr])?[(n=n!==void 0?n+"":t[lr]=="File"?t.name:"blob",r),t.name!==n||t[lr]=="blob"?new It([t],n,t):t]:[r,t+""]),Ta=(r,t)=>(t?r:r.replace(/\r?\n|\r/g,`\r
`)).replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22"),lt=(r,t,n)=>{if(t.length<n)throw new TypeError(`Failed to execute '${r}' on 'FormData': ${n} arguments required, but only ${t.length} present.`)},dt=class{#t=[];constructor(...t){if(t.length)throw new TypeError("Failed to construct 'FormData': parameter 1 is not of type 'HTMLFormElement'.")}get[lr](){return"FormData"}[Pd](){return this.entries()}static[$d](t){return t&&typeof t=="object"&&t[lr]==="FormData"&&!xd.some(n=>typeof t[n]!="function")}append(...t){lt("append",arguments,2),this.#t.push($o(...t))}delete(t){lt("delete",arguments,1),t+="",this.#t=this.#t.filter(([n])=>n!==t)}get(t){lt("get",arguments,1),t+="";for(var n=this.#t,s=n.length,o=0;o<s;o++)if(n[o][0]===t)return n[o][1];return null}getAll(t,n){return lt("getAll",arguments,1),n=[],t+="",this.#t.forEach(s=>s[0]===t&&n.push(s[1])),n}has(t){return lt("has",arguments,1),t+="",this.#t.some(n=>n[0]===t)}forEach(t,n){lt("forEach",arguments,1);for(var[s,o]of this)t.call(n,o,s,this)}set(...t){lt("set",arguments,2);var n=[],s=!0;t=$o(...t),this.#t.forEach(o=>{o[0]===t[0]?s&&(s=!n.push(t)):n.push(o)}),s&&n.push(t),this.#t=n}*entries(){yield*this.#t}*keys(){for(var[t]of this)yield t}*values(){for(var[,t]of this)yield t}}});var Io=it((kf,Co)=>{if(!globalThis.DOMException)try{let{MessageChannel:r}=require("worker_threads"),t=new r().port1,n=new ArrayBuffer;t.postMessage(n,[n,n])}catch(r){r.constructor.name==="DOMException"&&(globalThis.DOMException=r.constructor)}Co.exports=globalThis.DOMException});var mn,jd,Tf,$a=sr(()=>{mn=require("node:fs"),jd=te(Io(),1);Ra();ur();({stat:Tf}=mn.promises)});var qo={};ta(qo,{toFormData:()=>Md});function qd(r){let t=r.match(/\bfilename=("(.*?)"|([^()<>@,;:\\"/[\]?={}\s\t]+))($|;\s)/i);if(!t)return;let n=t[2]||t[3]||"",s=n.slice(n.lastIndexOf("\\")+1);return s=s.replace(/%22/g,'"'),s=s.replace(/&#(\d{4});/g,(o,c)=>String.fromCharCode(c)),s}async function Md(r,t){if(!/multipart/i.test(t))throw new TypeError("Failed to fetch");let n=t.match(/boundary=(?:"([^"]+)"|([^;]+))/i);if(!n)throw new TypeError("no or bad content-type header, no multipart boundary");let s=new xa(n[1]||n[2]),o,c,u,m,f,b,y=[],_=new dt,k=x=>{u+=$.decode(x,{stream:!0})},O=x=>{y.push(x)},w=()=>{let x=new It(y,b,{type:f});_.append(m,x)},E=()=>{_.append(m,u)},$=new TextDecoder("utf-8");$.decode(),s.onPartBegin=function(){s.onPartData=k,s.onPartEnd=E,o="",c="",u="",m="",f="",b=null,y.length=0},s.onHeaderField=function(x){o+=$.decode(x,{stream:!0})},s.onHeaderValue=function(x){c+=$.decode(x,{stream:!0})},s.onHeaderEnd=function(){if(c+=$.decode(),o=o.toLowerCase(),o==="content-disposition"){let x=c.match(/\bname=("([^"]*)"|([^()<>@,;:\\"/[\]?={}\s\t]+))/i);x&&(m=x[2]||x[3]||""),b=qd(c),b&&(s.onPartData=O,s.onPartEnd=w)}else o==="content-type"&&(f=c);c="",o=""};for await(let x of r)s.write(x);return s.end(),_}var Me,V,Uo,Ke,hn,bn,vd,fr,Ad,Cd,Id,Ud,ft,xa,Mo=sr(()=>{$a();fn();Me=0,V={START_BOUNDARY:Me++,HEADER_FIELD_START:Me++,HEADER_FIELD:Me++,HEADER_VALUE_START:Me++,HEADER_VALUE:Me++,HEADER_VALUE_ALMOST_DONE:Me++,HEADERS_ALMOST_DONE:Me++,PART_DATA_START:Me++,PART_DATA:Me++,END:Me++},Uo=1,Ke={PART_BOUNDARY:Uo,LAST_BOUNDARY:Uo*=2},hn=10,bn=13,vd=32,fr=45,Ad=58,Cd=97,Id=122,Ud=r=>r|32,ft=()=>{},xa=class{constructor(t){this.index=0,this.flags=0,this.onHeaderEnd=ft,this.onHeaderField=ft,this.onHeadersEnd=ft,this.onHeaderValue=ft,this.onPartBegin=ft,this.onPartData=ft,this.onPartEnd=ft,this.boundaryChars={},t=`\r
--`+t;let n=new Uint8Array(t.length);for(let s=0;s<t.length;s++)n[s]=t.charCodeAt(s),this.boundaryChars[n[s]]=!0;this.boundary=n,this.lookbehind=new Uint8Array(this.boundary.length+8),this.state=V.START_BOUNDARY}write(t){let n=0,s=t.length,o=this.index,{lookbehind:c,boundary:u,boundaryChars:m,index:f,state:b,flags:y}=this,_=this.boundary.length,k=_-1,O=t.length,w,E,$=T=>{this[T+"Mark"]=n},x=T=>{delete this[T+"Mark"]},W=(T,z,C,se)=>{(z===void 0||z!==C)&&this[T](se&&se.subarray(z,C))},F=(T,z)=>{let C=T+"Mark";C in this&&(z?(W(T,this[C],n,t),delete this[C]):(W(T,this[C],t.length,t),this[C]=0))};for(n=0;n<s;n++)switch(w=t[n],b){case V.START_BOUNDARY:if(f===u.length-2){if(w===fr)y|=Ke.LAST_BOUNDARY;else if(w!==bn)return;f++;break}else if(f-1===u.length-2){if(y&Ke.LAST_BOUNDARY&&w===fr)b=V.END,y=0;else if(!(y&Ke.LAST_BOUNDARY)&&w===hn)f=0,W("onPartBegin"),b=V.HEADER_FIELD_START;else return;break}w!==u[f+2]&&(f=-2),w===u[f+2]&&f++;break;case V.HEADER_FIELD_START:b=V.HEADER_FIELD,$("onHeaderField"),f=0;case V.HEADER_FIELD:if(w===bn){x("onHeaderField"),b=V.HEADERS_ALMOST_DONE;break}if(f++,w===fr)break;if(w===Ad){if(f===1)return;F("onHeaderField",!0),b=V.HEADER_VALUE_START;break}if(E=Ud(w),E<Cd||E>Id)return;break;case V.HEADER_VALUE_START:if(w===vd)break;$("onHeaderValue"),b=V.HEADER_VALUE;case V.HEADER_VALUE:w===bn&&(F("onHeaderValue",!0),W("onHeaderEnd"),b=V.HEADER_VALUE_ALMOST_DONE);break;case V.HEADER_VALUE_ALMOST_DONE:if(w!==hn)return;b=V.HEADER_FIELD_START;break;case V.HEADERS_ALMOST_DONE:if(w!==hn)return;W("onHeadersEnd"),b=V.PART_DATA_START;break;case V.PART_DATA_START:b=V.PART_DATA,$("onPartData");case V.PART_DATA:if(o=f,f===0){for(n+=k;n<O&&!(t[n]in m);)n+=_;n-=k,w=t[n]}if(f<u.length)u[f]===w?(f===0&&F("onPartData",!0),f++):f=0;else if(f===u.length)f++,w===bn?y|=Ke.PART_BOUNDARY:w===fr?y|=Ke.LAST_BOUNDARY:f=0;else if(f-1===u.length)if(y&Ke.PART_BOUNDARY){if(f=0,w===hn){y&=~Ke.PART_BOUNDARY,W("onPartEnd"),W("onPartBegin"),b=V.HEADER_FIELD_START;break}}else y&Ke.LAST_BOUNDARY&&w===fr?(W("onPartEnd"),b=V.END,y=0):f=0;if(f>0)c[f-1]=w;else if(o>0){let T=new Uint8Array(c.buffer,c.byteOffset,c.byteLength);W("onPartData",0,o,T),o=0,$("onPartData"),n--}break;case V.END:break;default:throw new Error(`Unexpected state entered: ${b}`)}F("onHeaderField"),F("onHeaderValue"),F("onPartData"),this.index=f,this.state=b,this.flags=y}end(){if(this.state===V.HEADER_FIELD_START&&this.index===0||this.state===V.PART_DATA&&this.index===this.boundary.length)this.onPartEnd();else if(this.state!==V.END)throw new Error("MultipartParser.end(): stream ended unexpectedly")}}});var Jd={};ta(Jd,{default:()=>zi});module.exports=lu(Jd);var N=require("@raycast/api");var U=te(require("react")),j=require("@raycast/api");var Ys=Object.prototype.hasOwnProperty;function tn(r,t){var n,s;if(r===t)return!0;if(r&&t&&(n=r.constructor)===t.constructor){if(n===Date)return r.getTime()===t.getTime();if(n===RegExp)return r.toString()===t.toString();if(n===Array){if((s=r.length)===t.length)for(;s--&&tn(r[s],t[s]););return s===-1}if(!n||typeof r=="object"){s=0;for(n in r)if(Ys.call(r,n)&&++s&&!Ys.call(t,n)||!(n in t)||!tn(r[n],t[n]))return!1;return Object.keys(t).length===s}}return r!==r&&t!==t}var ct=te(require("node:fs")),on=te(require("node:path")),no=te(require("node:crypto")),fa=te(require("node:child_process")),ao=require("node:buffer"),At=te(require("node:stream")),so=require("node:util");var pa=require("react/jsx-runtime");var ra=globalThis;function du(r){let t=(0,U.useRef)(r),n=(0,U.useRef)(0);return tn(r,t.current)||(t.current=r,n.current+=1),(0,U.useMemo)(()=>t.current,[n.current])}function ke(r){let t=(0,U.useRef)(r);return t.current=r,t}function Ct(r,t){let n=r instanceof Error?r.message:String(r);return(0,j.showToast)({style:j.Toast.Style.Failure,title:t?.title??"Something went wrong",message:t?.message??n,primaryAction:t?.primaryAction??Ks(r),secondaryAction:t?.primaryAction?Ks(r):void 0})}var Ks=r=>{let t=!0,n="[Extension Name]...",s="";try{let u=JSON.parse((0,ct.readFileSync)((0,on.join)(j.environment.assetsPath,"..","package.json"),"utf8"));n=`[${u.title}]...`,s=`https://raycast.com/${u.owner||u.author}/${u.name}`,(!u.owner||u.access==="public")&&(t=!1)}catch{}let o=j.environment.isDevelopment||t,c=r instanceof Error?r?.stack||r?.message||"":String(r);return{title:o?"Copy Logs":"Report Error",onAction(u){u.hide(),o?j.Clipboard.copy(c):(0,j.open)(`https://github.com/raycast/extensions/issues/new?&labels=extension%2Cbug&template=extension_bug_report.yml&title=${encodeURIComponent(n)}&extension-url=${encodeURI(s)}&description=${encodeURIComponent(`#### Error:
\`\`\`
${c}
\`\`\`
`)}`)}}};function ma(r,t,n){let s=(0,U.useRef)(0),[o,c]=(0,U.useState)({isLoading:!0}),u=ke(r),m=ke(n?.abortable),f=ke(t||[]),b=ke(n?.onError),y=ke(n?.onData),_=ke(n?.onWillExecute),k=ke(n?.failureToastOptions),O=ke(o.data),w=(0,U.useRef)(null),E=(0,U.useRef)({page:0}),$=(0,U.useRef)(!1),x=(0,U.useRef)(!0),W=(0,U.useRef)(50),F=(0,U.useCallback)(()=>(m.current&&(m.current.current?.abort(),m.current.current=new AbortController),++s.current),[m]),T=(0,U.useCallback)((...G)=>{let H=F();_.current?.(G),c(M=>({...M,isLoading:!0}));let _e=fu(u.current)(...G);function Te(M){return M.name=="AbortError"||H===s.current&&(b.current?b.current(M):j.environment.launchType!==j.LaunchType.Background&&Ct(M,{title:"Failed to fetch latest data",primaryAction:{title:"Retry",onAction(he){he.hide(),w.current?.(...f.current||[])}},...k.current}),c({error:M,isLoading:!1})),M}return typeof _e=="function"?($.current=!0,_e(E.current).then(({data:M,hasMore:he,cursor:Dt})=>(H===s.current&&(E.current&&(E.current.cursor=Dt,E.current.lastItem=M?.[M.length-1]),y.current&&y.current(M,E.current),he&&(W.current=M.length),x.current=he,c(gt=>E.current.page===0?{data:M,isLoading:!1}:{data:(gt.data||[])?.concat(M),isLoading:!1})),M),M=>(x.current=!1,Te(M)))):($.current=!1,_e.then(M=>(H===s.current&&(y.current&&y.current(M),c({data:M,isLoading:!1})),M),Te))},[y,b,f,u,c,w,_,E,k,F]);w.current=T;let z=(0,U.useCallback)(()=>{E.current={page:0};let G=f.current||[];return T(...G)},[T,f]),C=(0,U.useCallback)(async(G,H)=>{let _e;try{if(H?.optimisticUpdate){F(),typeof H?.rollbackOnError!="function"&&H?.rollbackOnError!==!1&&(_e=structuredClone(O.current?.value));let Te=H.optimisticUpdate;c(M=>({...M,data:Te(M.data)}))}return await G}catch(Te){if(typeof H?.rollbackOnError=="function"){let M=H.rollbackOnError;c(he=>({...he,data:M(he.data)}))}else H?.optimisticUpdate&&H?.rollbackOnError!==!1&&c(M=>({...M,data:_e}));throw Te}finally{H?.shouldRevalidateAfter!==!1&&(j.environment.launchType===j.LaunchType.Background||j.environment.commandMode==="menu-bar"?await z():z())}},[z,O,c,F]),se=(0,U.useCallback)(()=>{E.current.page+=1;let G=f.current||[];T(...G)},[E,f,T]);(0,U.useEffect)(()=>{E.current={page:0},n?.execute!==!1?T(...t||[]):F()},[du([t,n?.execute,T]),m,E]),(0,U.useEffect)(()=>()=>{F()},[F]);let ee=n?.execute!==!1?o.isLoading:!1,yt={...o,isLoading:ee},et=$.current?{pageSize:W.current,hasMore:x.current,onLoadMore:se}:void 0;return{...yt,revalidate:z,mutate:C,pagination:et}}function fu(r){return r===Promise.all||r===Promise.race||r===Promise.resolve||r===Promise.reject?r.bind(Promise):r}function Zs(r){return typeof r!="function"?!1:/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(r))!==null}function pu(r){return r instanceof URLSearchParams?r.toString():r}function oo(r,t=[]){function n(s){return"update"in r?r.update(s,"utf8"):r.write(s)}return{dispatch:function(s){s=pu(s),s===null?this._null():this["_"+typeof s](s)},_object:function(s){let o=/\[object (.*)\]/i,c=Object.prototype.toString.call(s),u=o.exec(c)?.[1]??"unknown:["+c+"]";u=u.toLowerCase();let m=null;if((m=t.indexOf(s))>=0){this.dispatch("[CIRCULAR:"+m+"]");return}else t.push(s);if(Buffer.isBuffer(s))return n("buffer:"),n(s.toString("utf8"));if(u!=="object"&&u!=="function"&&u!=="asyncfunction")if(this["_"+u])this["_"+u](s);else throw new Error('Unknown object type "'+u+'"');else{let f=Object.keys(s);f=f.sort(),Zs(s)||f.splice(0,0,"prototype","__proto__","constructor"),n("object:"+f.length+":");let b=this;return f.forEach(function(y){b.dispatch(y),n(":"),b.dispatch(s[y]),n(",")})}},_array:function(s,o){o=typeof o<"u"?o:!1;let c=this;if(n("array:"+s.length+":"),!o||s.length<=1){s.forEach(function(f){c.dispatch(f)});return}let u=[],m=s.map(function(f){let b=mu(),y=t.slice();return oo(b,y).dispatch(f),u=u.concat(y.slice(t.length)),b.read().toString()});t=t.concat(u),m.sort(),this._array(m,!1)},_date:function(s){n("date:"+s.toJSON())},_symbol:function(s){n("symbol:"+s.toString())},_error:function(s){n("error:"+s.toString())},_boolean:function(s){n("bool:"+s.toString())},_string:function(s){n("string:"+s.length+":"),n(s.toString())},_function:function(s){n("fn:"),Zs(s)?this.dispatch("[native]"):this.dispatch(s.toString()),this.dispatch("function-name:"+String(s.name)),this._object(s)},_number:function(s){n("number:"+s.toString())},_xml:function(s){n("xml:"+s.toString())},_null:function(){n("Null")},_undefined:function(){n("Undefined")},_regexp:function(s){n("regex:"+s.toString())},_uint8array:function(s){n("uint8array:"),this.dispatch(Array.prototype.slice.call(s))},_uint8clampedarray:function(s){n("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(s))},_int8array:function(s){n("int8array:"),this.dispatch(Array.prototype.slice.call(s))},_uint16array:function(s){n("uint16array:"),this.dispatch(Array.prototype.slice.call(s))},_int16array:function(s){n("int16array:"),this.dispatch(Array.prototype.slice.call(s))},_uint32array:function(s){n("uint32array:"),this.dispatch(Array.prototype.slice.call(s))},_int32array:function(s){n("int32array:"),this.dispatch(Array.prototype.slice.call(s))},_float32array:function(s){n("float32array:"),this.dispatch(Array.prototype.slice.call(s))},_float64array:function(s){n("float64array:"),this.dispatch(Array.prototype.slice.call(s))},_arraybuffer:function(s){n("arraybuffer:"),this.dispatch(new Uint8Array(s))},_url:function(s){n("url:"+s.toString())},_map:function(s){n("map:");let o=Array.from(s);this._array(o,!0)},_set:function(s){n("set:");let o=Array.from(s);this._array(o,!0)},_file:function(s){n("file:"),this.dispatch([s.name,s.size,s.type,s.lastModified])},_blob:function(){throw Error(`Hashing Blob objects is currently not supported
(see https://github.com/puleos/object-hash/issues/26)
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow:function(){n("domwindow")},_bigint:function(s){n("bigint:"+s.toString())},_process:function(){n("process")},_timer:function(){n("timer")},_pipe:function(){n("pipe")},_tcp:function(){n("tcp")},_udp:function(){n("udp")},_tty:function(){n("tty")},_statwatcher:function(){n("statwatcher")},_securecontext:function(){n("securecontext")},_connection:function(){n("connection")},_zlib:function(){n("zlib")},_context:function(){n("context")},_nodescript:function(){n("nodescript")},_httpparser:function(){n("httpparser")},_dataview:function(){n("dataview")},_signal:function(){n("signal")},_fsevent:function(){n("fsevent")},_tlswrap:function(){n("tlswrap")}}}function mu(){return{buf:"",write:function(r){this.buf+=r},end:function(r){this.buf+=r},read:function(){return this.buf}}}function hu(r,t){let n=this[r];return n instanceof Date?`__raycast_cached_date__${n.toISOString()}`:Buffer.isBuffer(n)?`__raycast_cached_buffer__${n.toString("base64")}`:t}function bu(r,t){return typeof t=="string"&&t.startsWith("__raycast_cached_date__")?new Date(t.replace("__raycast_cached_date__","")):typeof t=="string"&&t.startsWith("__raycast_cached_buffer__")?Buffer.from(t.replace("__raycast_cached_buffer__",""),"base64"):t}function Xs(r){let t=no.default.createHash("sha1");return oo(t).dispatch(r),t.digest("hex")}var yu=Symbol("cache without namespace"),eo=new Map;function gu(r,t,n){let s=n?.cacheNamespace||yu,o=eo.get(s)||eo.set(s,new j.Cache({namespace:n?.cacheNamespace})).get(s);if(!o)throw new Error("Missing cache");let c=ke(r),u=ke(t),m=(0,U.useSyncExternalStore)(o.subscribe,()=>{try{return o.get(c.current)}catch(_){console.error("Could not get Cache data:",_);return}}),f=(0,U.useMemo)(()=>{if(typeof m<"u"){if(m==="undefined")return;try{return JSON.parse(m,bu)}catch(_){return console.warn("The cached data is corrupted",_),u.current}}else return u.current},[m,u]),b=ke(f),y=(0,U.useCallback)(_=>{let k=typeof _=="function"?_(b.current):_;if(typeof k>"u")o.set(c.current,"undefined");else{let O=JSON.stringify(k,hu);o.set(c.current,O)}return k},[o,c,b]);return[f,y]}var jt=Symbol();function Ue(r,t,n){let{initialData:s,keepPreviousData:o,internal_cacheKeySuffix:c,...u}=n||{},m=(0,U.useRef)(null),[f,b]=gu(Xs(t||[])+c,jt,{cacheNamespace:Xs(r)}),y=(0,U.useRef)(f!==jt?f:s),_=(0,U.useRef)(void 0),{mutate:k,revalidate:O,...w}=ma(r,t||[],{...u,onData(F,T){_.current=T,u.onData&&u.onData(F,T),!(T&&T.page>0)&&(m.current="promise",y.current=F,b(F))}}),E,$=w.pagination;_.current&&_.current.page>0&&w.data?E=w.data:m.current==="promise"?E=y.current:o&&f!==jt?(E=f,$&&($.hasMore=!0,$.pageSize=f.length)):o&&f===jt?E=y.current:f!==jt?(E=f,$&&($.hasMore=!0,$.pageSize=f.length)):E=s;let x=ke(E),W=(0,U.useCallback)(async(F,T)=>{let z;try{if(T?.optimisticUpdate){typeof T?.rollbackOnError!="function"&&T?.rollbackOnError!==!1&&(z=structuredClone(x.current));let C=T.optimisticUpdate(x.current);m.current="cache",y.current=C,b(C)}return await k(F,{shouldRevalidateAfter:T?.shouldRevalidateAfter})}catch(C){if(typeof T?.rollbackOnError=="function"){let se=T.rollbackOnError(x.current);m.current="cache",y.current=se,b(se)}else T?.optimisticUpdate&&T?.rollbackOnError!==!1&&(m.current="cache",y.current=z,b(z));throw C}},[b,k,x,y,m]);return(0,U.useEffect)(()=>{f!==jt&&(m.current="cache",y.current=f)},[f]),{data:E,isLoading:w.isLoading,error:w.error,mutate:_.current&&_.current.page>0?k:W,pagination:$,revalidate:O}}var nn=r=>!!r&&typeof r=="object"&&typeof r.removeListener=="function"&&typeof r.emit=="function"&&typeof r.reallyExit=="function"&&typeof r.listeners=="function"&&typeof r.kill=="function"&&typeof r.pid=="number"&&typeof r.on=="function",na=Symbol.for("signal-exit emitter"),ca=class{constructor(){if(this.emitted={afterExit:!1,exit:!1},this.listeners={afterExit:[],exit:[]},this.count=0,this.id=Math.random(),ra[na])return ra[na];Object.defineProperty(ra,na,{value:this,writable:!1,enumerable:!1,configurable:!1})}on(t,n){this.listeners[t].push(n)}removeListener(t,n){let s=this.listeners[t],o=s.indexOf(n);o!==-1&&(o===0&&s.length===1?s.length=0:s.splice(o,1))}emit(t,n,s){if(this.emitted[t])return!1;this.emitted[t]=!0;let o=!1;for(let c of this.listeners[t])o=c(n,s)===!0||o;return t==="exit"&&(o=this.emit("afterExit",n,s)||o),o}},ua=class{onExit(){return()=>{}}load(){}unload(){}},la=class{#t;#r;#e;#s;#i;#o;#a;#n;constructor(t){this.#t=process.platform==="win32"?"SIGINT":"SIGHUP",this.#r=new ca,this.#o={},this.#a=!1,this.#n=[],this.#n.push("SIGHUP","SIGINT","SIGTERM"),globalThis.process.platform!=="win32"&&this.#n.push("SIGALRM","SIGABRT","SIGVTALRM","SIGXCPU","SIGXFSZ","SIGUSR2","SIGTRAP","SIGSYS","SIGQUIT","SIGIOT"),globalThis.process.platform==="linux"&&this.#n.push("SIGIO","SIGPOLL","SIGPWR","SIGSTKFLT"),this.#e=t,this.#o={};for(let n of this.#n)this.#o[n]=()=>{let s=this.#e.listeners(n),{count:o}=this.#r,c=t;if(typeof c.__signal_exit_emitter__=="object"&&typeof c.__signal_exit_emitter__.count=="number"&&(o+=c.__signal_exit_emitter__.count),s.length===o){this.unload();let u=this.#r.emit("exit",null,n),m=n==="SIGHUP"?this.#t:n;u||t.kill(t.pid,m)}};this.#i=t.reallyExit,this.#s=t.emit}onExit(t,n){if(!nn(this.#e))return()=>{};this.#a===!1&&this.load();let s=n?.alwaysLast?"afterExit":"exit";return this.#r.on(s,t),()=>{this.#r.removeListener(s,t),this.#r.listeners.exit.length===0&&this.#r.listeners.afterExit.length===0&&this.unload()}}load(){if(!this.#a){this.#a=!0,this.#r.count+=1;for(let t of this.#n)try{let n=this.#o[t];n&&this.#e.on(t,n)}catch{}this.#e.emit=(t,...n)=>this.#u(t,...n),this.#e.reallyExit=t=>this.#c(t)}}unload(){this.#a&&(this.#a=!1,this.#n.forEach(t=>{let n=this.#o[t];if(!n)throw new Error("Listener not defined for signal: "+t);try{this.#e.removeListener(t,n)}catch{}}),this.#e.emit=this.#s,this.#e.reallyExit=this.#i,this.#r.count-=1)}#c(t){return nn(this.#e)?(this.#e.exitCode=t||0,this.#r.emit("exit",this.#e.exitCode,null),this.#i.call(this.#e,this.#e.exitCode)):0}#u(t,...n){let s=this.#s;if(t==="exit"&&nn(this.#e)){typeof n[0]=="number"&&(this.#e.exitCode=n[0]);let o=s.call(this.#e,t,...n);return this.#r.emit("exit",this.#e.exitCode,null),o}else return s.call(this.#e,t,...n)}},aa=null,Su=(r,t)=>(aa||(aa=nn(process)?new la(process):new ua),aa.onExit(r,t));function io(r,{timeout:t}={}){let n=new Promise((m,f)=>{r.on("exit",(b,y)=>{m({exitCode:b,signal:y,timedOut:!1})}),r.on("error",b=>{f(b)}),r.stdin&&r.stdin.on("error",b=>{f(b)})}),s=Su(()=>{r.kill()});if(t===0||t===void 0)return n.finally(()=>s());let o,c=new Promise((m,f)=>{o=setTimeout(()=>{r.kill("SIGTERM"),f(Object.assign(new Error("Timed out"),{timedOut:!0,signal:"SIGTERM"}))},t)}),u=n.finally(()=>{clearTimeout(o)});return Promise.race([c,u]).finally(()=>s())}var da=class extends Error{constructor(){super("The output is too big"),this.name="MaxBufferError"}};function wu(r){let{encoding:t}=r,n=t==="buffer",s=new At.default.PassThrough({objectMode:!1});t&&t!=="buffer"&&s.setEncoding(t);let o=0,c=[];return s.on("data",u=>{c.push(u),o+=u.length}),s.getBufferedValue=()=>n?Buffer.concat(c,o):c.join(""),s.getBufferedLength=()=>o,s}async function to(r,t){let n=wu(t);return await new Promise((s,o)=>{let c=u=>{u&&n.getBufferedLength()<=ao.constants.MAX_LENGTH&&(u.bufferedData=n.getBufferedValue()),o(u)};(async()=>{try{await(0,so.promisify)(At.default.pipeline)(r,n),s()}catch(u){c(u)}})(),n.on("data",()=>{n.getBufferedLength()>8e7&&c(new da)})}),n.getBufferedValue()}async function ro(r,t){r.destroy();try{return await t}catch(n){return n.bufferedData}}async function co({stdout:r,stderr:t},{encoding:n},s){let o=to(r,{encoding:n}),c=to(t,{encoding:n});try{return await Promise.all([s,o,c])}catch(u){return Promise.all([{error:u,exitCode:null,signal:u.signal,timedOut:u.timedOut||!1},ro(r,o),ro(t,c)])}}function _u(r){let t=typeof r=="string"?`
`:10,n=typeof r=="string"?"\r":13;return r[r.length-1]===t&&(r=r.slice(0,-1)),r[r.length-1]===n&&(r=r.slice(0,-1)),r}function an(r,t){return r.stripFinalNewline?_u(t):t}function Ou({timedOut:r,timeout:t,signal:n,exitCode:s}){return r?`timed out after ${t} milliseconds`:n!=null?`was killed with ${n}`:s!=null?`failed with exit code ${s}`:"failed"}function ku({stdout:r,stderr:t,error:n,signal:s,exitCode:o,command:c,timedOut:u,options:m,parentError:f}){let y=`Command ${Ou({timedOut:u,timeout:m?.timeout,signal:s,exitCode:o})}: ${c}`,_=n?`${y}
${n.message}`:y,k=[_,t,r].filter(Boolean).join(`
`);return n?n.originalMessage=n.message:n=f,n.message=k,n.shortMessage=_,n.command=c,n.exitCode=o,n.signal=s,n.stdout=r,n.stderr=t,"bufferedData"in n&&delete n.bufferedData,n}function uo({stdout:r,stderr:t,error:n,exitCode:s,signal:o,timedOut:c,command:u,options:m,parentError:f}){if(n||s!==0||o!==null)throw ku({error:n,exitCode:s,signal:o,stdout:r,stderr:t,command:u,timedOut:c,options:m,parentError:f});return r}var rn={asana:"1191201745684312",github:"7235fe8d42157f1f38c0",linear:"c8ff37b9225c3c9aefd7d66ea0e5b6f1",slack:"851756884692.5546927290212"},sn=class r{constructor(t){this.clientId=t.clientId,this.scope=Array.isArray(t.scope)?t.scope.join(" "):t.scope,this.personalAccessToken=t.personalAccessToken,this.bodyEncoding=t.bodyEncoding,this.client=t.client,this.extraParameters=t.extraParameters,this.authorizeUrl=t.authorizeUrl,this.tokenUrl=t.tokenUrl,this.refreshTokenUrl=t.refreshTokenUrl,this.onAuthorize=t.onAuthorize,this.tokenResponseParser=t.tokenResponseParser??(n=>n),this.tokenRefreshResponseParser=t.tokenRefreshResponseParser??(n=>n),this.authorize=this.authorize.bind(this)}static asana(t){return new r({client:new j.OAuth.PKCEClient({redirectMethod:j.OAuth.RedirectMethod.Web,providerName:"Asana",providerIcon:`data:image/svg+xml,${encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" width="251" height="232" fill="none"><path fill="#F06A6A" d="M179.383 54.373c0 30.017-24.337 54.374-54.354 54.374-30.035 0-54.373-24.338-54.373-54.374C70.656 24.338 94.993 0 125.029 0c30.017 0 54.354 24.338 54.354 54.373ZM54.393 122.33C24.376 122.33.02 146.668.02 176.685c0 30.017 24.337 54.373 54.373 54.373 30.035 0 54.373-24.338 54.373-54.373 0-30.017-24.338-54.355-54.373-54.355Zm141.253 0c-30.035 0-54.373 24.338-54.373 54.374 0 30.035 24.338 54.373 54.373 54.373 30.017 0 54.374-24.338 54.374-54.373 0-30.036-24.338-54.374-54.374-54.374Z"/></svg>')}`,providerId:"asana",description:"Connect your Asana account"}),clientId:t.clientId??rn.asana,authorizeUrl:t.authorizeUrl??"https://asana.oauth.raycast.com/authorize",tokenUrl:t.tokenUrl??"https://asana.oauth.raycast.com/token",refreshTokenUrl:t.refreshTokenUrl??"https://asana.oauth.raycast.com/refresh-token",scope:t.scope,personalAccessToken:t.personalAccessToken,onAuthorize:t.onAuthorize,bodyEncoding:t.bodyEncoding,tokenRefreshResponseParser:t.tokenRefreshResponseParser,tokenResponseParser:t.tokenResponseParser})}static github(t){return new r({client:new j.OAuth.PKCEClient({redirectMethod:j.OAuth.RedirectMethod.Web,providerName:"GitHub",providerIcon:{source:`data:image/svg+xml,${encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"/></svg>')}`,tintColor:j.Color.PrimaryText},providerId:"github",description:"Connect your GitHub account"}),clientId:t.clientId??rn.github,authorizeUrl:t.authorizeUrl??"https://github.oauth.raycast.com/authorize",tokenUrl:t.tokenUrl??"https://github.oauth.raycast.com/token",refreshTokenUrl:t.refreshTokenUrl??"https://github.oauth.raycast.com/refresh-token",scope:t.scope,personalAccessToken:t.personalAccessToken,onAuthorize:t.onAuthorize,bodyEncoding:t.bodyEncoding,tokenRefreshResponseParser:t.tokenRefreshResponseParser,tokenResponseParser:t.tokenResponseParser})}static google(t){return new r({client:new j.OAuth.PKCEClient({redirectMethod:j.OAuth.RedirectMethod.AppURI,providerName:"Google",providerIcon:`data:image/svg+xml,${encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" style="display:block" viewBox="0 0 48 48"><path fill="#EA4335" d="M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z"/><path fill="#4285F4" d="M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"/><path fill="#FBBC05" d="M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z"/><path fill="#34A853" d="M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z"/><path fill="none" d="M0 0h48v48H0z"/></svg>')}`,providerId:"google",description:"Connect your Google account"}),clientId:t.clientId,authorizeUrl:t.authorizeUrl??"https://accounts.google.com/o/oauth2/v2/auth",tokenUrl:t.tokenUrl??"https://oauth2.googleapis.com/token",refreshTokenUrl:t.tokenUrl,scope:t.scope,personalAccessToken:t.personalAccessToken,bodyEncoding:t.bodyEncoding??"url-encoded",onAuthorize:t.onAuthorize,tokenRefreshResponseParser:t.tokenRefreshResponseParser,tokenResponseParser:t.tokenResponseParser})}static jira(t){return new r({client:new j.OAuth.PKCEClient({redirectMethod:j.OAuth.RedirectMethod.Web,providerName:"Jira",providerIcon:`data:image/svg+xml,${encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="2361" height="2500" viewBox="2.59 0 214.091 224"><linearGradient id="a" x1="102.4" x2="56.15" y1="218.63" y2="172.39" gradientTransform="matrix(1 0 0 -1 0 264)" gradientUnits="userSpaceOnUse"><stop offset=".18" stop-color="#0052cc"/><stop offset="1" stop-color="#2684ff"/></linearGradient><linearGradient xlink:href="#a" id="b" x1="114.65" x2="160.81" y1="85.77" y2="131.92"/><path fill="#2684ff" d="M214.06 105.73 117.67 9.34 108.33 0 35.77 72.56 2.59 105.73a8.89 8.89 0 0 0 0 12.54l66.29 66.29L108.33 224l72.55-72.56 1.13-1.12 32.05-32a8.87 8.87 0 0 0 0-12.59zm-105.73 39.39L75.21 112l33.12-33.12L141.44 112z"/><path fill="url(#a)" d="M108.33 78.88a55.75 55.75 0 0 1-.24-78.61L35.62 72.71l39.44 39.44z"/><path fill="url(#b)" d="m141.53 111.91-33.2 33.21a55.77 55.77 0 0 1 0 78.86L181 151.35z"/></svg>')}`,providerId:"jira",description:"Connect your Jira account"}),clientId:t.clientId,authorizeUrl:t.authorizeUrl??"https://auth.atlassian.com/authorize",tokenUrl:t.tokenUrl??"https://auth.atlassian.com/oauth/token",refreshTokenUrl:t.refreshTokenUrl,scope:t.scope,personalAccessToken:t.personalAccessToken,onAuthorize:t.onAuthorize,bodyEncoding:t.bodyEncoding,tokenRefreshResponseParser:t.tokenRefreshResponseParser,tokenResponseParser:t.tokenResponseParser})}static linear(t){return new r({client:new j.OAuth.PKCEClient({redirectMethod:j.OAuth.RedirectMethod.Web,providerName:"Linear",providerIcon:{source:{light:`data:image/svg+xml,${encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" fill="#222326" width="200" height="200" viewBox="0 0 100 100"><path d="M1.22541 61.5228c-.2225-.9485.90748-1.5459 1.59638-.857L39.3342 97.1782c.6889.6889.0915 1.8189-.857 1.5964C20.0515 94.4522 5.54779 79.9485 1.22541 61.5228ZM.00189135 46.8891c-.01764375.2833.08887215.5599.28957165.7606L52.3503 99.7085c.2007.2007.4773.3075.7606.2896 2.3692-.1476 4.6938-.46 6.9624-.9259.7645-.157 1.0301-1.0963.4782-1.6481L2.57595 39.4485c-.55186-.5519-1.49117-.2863-1.648174.4782-.465915 2.2686-.77832 4.5932-.92588465 6.9624ZM4.21093 29.7054c-.16649.3738-.08169.8106.20765 1.1l64.77602 64.776c.2894.2894.7262.3742 1.1.2077 1.7861-.7956 3.5171-1.6927 5.1855-2.684.5521-.328.6373-1.0867.1832-1.5407L8.43566 24.3367c-.45409-.4541-1.21271-.3689-1.54074.1832-.99132 1.6684-1.88843 3.3994-2.68399 5.1855ZM12.6587 18.074c-.3701-.3701-.393-.9637-.0443-1.3541C21.7795 6.45931 35.1114 0 49.9519 0 77.5927 0 100 22.4073 100 50.0481c0 14.8405-6.4593 28.1724-16.7199 37.3375-.3903.3487-.984.3258-1.3542-.0443L12.6587 18.074Z"/></svg>')}`,dark:`data:image/svg+xml,${encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" fill="#fff" width="200" height="200" viewBox="0 0 100 100"><path d="M1.22541 61.5228c-.2225-.9485.90748-1.5459 1.59638-.857L39.3342 97.1782c.6889.6889.0915 1.8189-.857 1.5964C20.0515 94.4522 5.54779 79.9485 1.22541 61.5228ZM.00189135 46.8891c-.01764375.2833.08887215.5599.28957165.7606L52.3503 99.7085c.2007.2007.4773.3075.7606.2896 2.3692-.1476 4.6938-.46 6.9624-.9259.7645-.157 1.0301-1.0963.4782-1.6481L2.57595 39.4485c-.55186-.5519-1.49117-.2863-1.648174.4782-.465915 2.2686-.77832 4.5932-.92588465 6.9624ZM4.21093 29.7054c-.16649.3738-.08169.8106.20765 1.1l64.77602 64.776c.2894.2894.7262.3742 1.1.2077 1.7861-.7956 3.5171-1.6927 5.1855-2.684.5521-.328.6373-1.0867.1832-1.5407L8.43566 24.3367c-.45409-.4541-1.21271-.3689-1.54074.1832-.99132 1.6684-1.88843 3.3994-2.68399 5.1855ZM12.6587 18.074c-.3701-.3701-.393-.9637-.0443-1.3541C21.7795 6.45931 35.1114 0 49.9519 0 77.5927 0 100 22.4073 100 50.0481c0 14.8405-6.4593 28.1724-16.7199 37.3375-.3903.3487-.984.3258-1.3542-.0443L12.6587 18.074Z" /></svg>')}`}},providerId:"linear",description:"Connect your Linear account"}),clientId:t.clientId??rn.linear,authorizeUrl:t.authorizeUrl??"https://linear.oauth.raycast.com/authorize",tokenUrl:t.tokenUrl??"https://linear.oauth.raycast.com/token",refreshTokenUrl:t.refreshTokenUrl??"https://linear.oauth.raycast.com/refresh-token",scope:t.scope,extraParameters:{actor:"user"},onAuthorize:t.onAuthorize,bodyEncoding:t.bodyEncoding,tokenRefreshResponseParser:t.tokenRefreshResponseParser,tokenResponseParser:t.tokenResponseParser})}static slack(t){return new r({client:new j.OAuth.PKCEClient({redirectMethod:j.OAuth.RedirectMethod.Web,providerName:"Slack",providerIcon:`data:image/svg+xml,${encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" viewBox="73 73 124 124"><style>.st0{fill:#e01e5a}.st1{fill:#36c5f0}.st2{fill:#2eb67d}.st3{fill:#ecb22e}</style><path d="M99.4 151.2c0 7.1-5.8 12.9-12.9 12.9-7.1 0-12.9-5.8-12.9-12.9 0-7.1 5.8-12.9 12.9-12.9h12.9v12.9zM105.9 151.2c0-7.1 5.8-12.9 12.9-12.9s12.9 5.8 12.9 12.9v32.3c0 7.1-5.8 12.9-12.9 12.9s-12.9-5.8-12.9-12.9v-32.3z" class="st0"/><path d="M118.8 99.4c-7.1 0-12.9-5.8-12.9-12.9 0-7.1 5.8-12.9 12.9-12.9s12.9 5.8 12.9 12.9v12.9h-12.9zM118.8 105.9c7.1 0 12.9 5.8 12.9 12.9s-5.8 12.9-12.9 12.9H86.5c-7.1 0-12.9-5.8-12.9-12.9s5.8-12.9 12.9-12.9h32.3z" class="st1"/><path d="M170.6 118.8c0-7.1 5.8-12.9 12.9-12.9 7.1 0 12.9 5.8 12.9 12.9s-5.8 12.9-12.9 12.9h-12.9v-12.9zM164.1 118.8c0 7.1-5.8 12.9-12.9 12.9-7.1 0-12.9-5.8-12.9-12.9V86.5c0-7.1 5.8-12.9 12.9-12.9 7.1 0 12.9 5.8 12.9 12.9v32.3z" class="st2"/><path d="M151.2 170.6c7.1 0 12.9 5.8 12.9 12.9 0 7.1-5.8 12.9-12.9 12.9-7.1 0-12.9-5.8-12.9-12.9v-12.9h12.9zM151.2 164.1c-7.1 0-12.9-5.8-12.9-12.9 0-7.1 5.8-12.9 12.9-12.9h32.3c7.1 0 12.9 5.8 12.9 12.9 0 7.1-5.8 12.9-12.9 12.9h-32.3z" class="st3"/></svg>')}`,providerId:"slack",description:"Connect your Slack account"}),clientId:t.clientId??rn.slack,authorizeUrl:t.authorizeUrl??"https://slack.oauth.raycast.com/authorize",tokenUrl:t.tokenUrl??"https://slack.oauth.raycast.com/token",refreshTokenUrl:t.tokenUrl??"https://slack.oauth.raycast.com/refresh-token",scope:"",extraParameters:{user_scope:t.scope},personalAccessToken:t.personalAccessToken,bodyEncoding:t.tokenUrl?t.bodyEncoding??"url-encoded":"json",onAuthorize:t.onAuthorize,tokenRefreshResponseParser:t.tokenRefreshResponseParser,tokenResponseParser:t.tokenResponseParser??(n=>({access_token:n.authed_user.access_token,scope:n.authed_user.scope}))})}static zoom(t){return new r({client:new j.OAuth.PKCEClient({redirectMethod:j.OAuth.RedirectMethod.Web,providerName:"Zoom",providerIcon:`data:image/svg+xml,${encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 351.845 80"><path d="M73.786 78.835H10.88A10.842 10.842 0 0 1 .833 72.122a10.841 10.841 0 0 1 2.357-11.85L46.764 16.7h-31.23C6.954 16.699 0 9.744 0 1.165h58.014c4.414 0 8.357 2.634 10.046 6.712a10.843 10.843 0 0 1-2.356 11.85L22.13 63.302h36.122c8.58 0 15.534 6.955 15.534 15.534Zm278.059-48.544C351.845 13.588 338.256 0 321.553 0c-8.934 0-16.975 3.89-22.524 10.063C293.48 3.89 285.44 0 276.505 0c-16.703 0-30.291 13.588-30.291 30.291v48.544c8.579 0 15.534-6.955 15.534-15.534v-33.01c0-8.137 6.62-14.757 14.757-14.757s14.757 6.62 14.757 14.757v33.01c0 8.58 6.955 15.534 15.534 15.534V30.291c0-8.137 6.62-14.757 14.757-14.757s14.758 6.62 14.758 14.757v33.01c0 8.58 6.954 15.534 15.534 15.534V30.291ZM238.447 40c0 22.091-17.909 40-40 40s-40-17.909-40-40 17.908-40 40-40 40 17.909 40 40Zm-15.534 0c0-13.512-10.954-24.466-24.466-24.466S173.98 26.488 173.98 40s10.953 24.466 24.466 24.466S222.913 53.512 222.913 40Zm-70.68 0c0 22.091-17.909 40-40 40s-40-17.909-40-40 17.909-40 40-40 40 17.909 40 40Zm-15.534 0c0-13.512-10.954-24.466-24.466-24.466S87.767 26.488 87.767 40s10.954 24.466 24.466 24.466S136.699 53.512 136.699 40Z" style="fill:#0b5cff"/></svg>')}`,providerId:"zoom",description:"Connect your Zoom account"}),clientId:t.clientId,authorizeUrl:t.authorizeUrl??"https://zoom.us/oauth/authorize",tokenUrl:t.tokenUrl??"https://zoom.us/oauth/token",refreshTokenUrl:t.refreshTokenUrl,scope:t.scope,personalAccessToken:t.personalAccessToken,bodyEncoding:t.bodyEncoding??"url-encoded",onAuthorize:t.onAuthorize,tokenRefreshResponseParser:t.tokenRefreshResponseParser,tokenResponseParser:t.tokenResponseParser})}async authorize(){let t=await this.client.getTokens();if(t?.accessToken){if(t.refreshToken&&t.isExpired()){let c=await this.refreshTokens({token:t.refreshToken});if(c)return await this.client.setTokens(c),c.access_token}return t.accessToken}let n=await this.client.authorizationRequest({endpoint:this.authorizeUrl,clientId:this.clientId,scope:this.scope,extraParameters:this.extraParameters}),{authorizationCode:s}=await this.client.authorize(n),o=await this.fetchTokens({authRequest:n,authorizationCode:s});return await this.client.setTokens(o),o.access_token}async fetchTokens({authRequest:t,authorizationCode:n}){let s;if(this.bodyEncoding==="url-encoded"){let u=new URLSearchParams;u.append("client_id",this.clientId),u.append("code",n),u.append("code_verifier",t.codeVerifier),u.append("grant_type","authorization_code"),u.append("redirect_uri",t.redirectURI),s={body:u}}else s={body:JSON.stringify({client_id:this.clientId,code:n,code_verifier:t.codeVerifier,grant_type:"authorization_code",redirect_uri:t.redirectURI}),headers:{"Content-Type":"application/json"}};let o=await fetch(this.tokenUrl,{method:"POST",...s});if(!o.ok){let u=await o.text();throw console.error("fetch tokens error:",u),new Error(`Error while fetching tokens: ${o.status} (${o.statusText})
${u}`)}let c=this.tokenResponseParser(await o.json());return Array.isArray(c.scope)?{...c,scope:c.scope.join(" ")}:c}async refreshTokens({token:t}){let n;if(this.bodyEncoding==="url-encoded"){let o=new URLSearchParams;o.append("client_id",this.clientId),o.append("refresh_token",t),o.append("grant_type","refresh_token"),n={body:o}}else n={body:JSON.stringify({client_id:this.clientId,refresh_token:t,grant_type:"refresh_token"}),headers:{"Content-Type":"application/json"}};let s=await fetch(this.refreshTokenUrl??this.tokenUrl,{method:"POST",...n});if(s.ok){let o=this.tokenRefreshResponseParser(await s.json());return o.refresh_token=o.refresh_token??t,o}else{let o=await s.text();console.error("refresh tokens error:",o),this.client.description=`${this.client.providerName} needs you to sign-in again. Press \u23CE or click the button below to continue.`,await this.client.removeTokens(),await this.authorize()}}},vt=null,or=null,sa=null,oa=null,ia=null;function lo(r){return j.environment.commandMode==="no-view"?t=>async s=>{if(!vt){vt=r.personalAccessToken??await r.authorize(),or=r.personalAccessToken?"personal":"oauth";let o=(await r.client?.getTokens())?.idToken;r.onAuthorize&&await Promise.resolve(r.onAuthorize({token:vt,type:or,idToken:o}))}return t(s)}:t=>{let n=s=>{r.personalAccessToken?(vt=r.personalAccessToken,or="personal"):(sa||(sa=r.authorize()),vt=U.default.use(sa),or="oauth");let o;return r.client&&(oa||(oa=r.client?.getTokens().then(c=>c?.idToken)),o=U.default.use(oa)),r.onAuthorize&&(ia||(ia=Promise.resolve(r.onAuthorize({token:vt,type:or,idToken:o}))),U.default.use(ia)),(0,pa.jsx)(t,{...s})};return n.displayName=`withAccessToken(${t.displayName||t.name})`,n}}async function cn(r,t,n){if(process.platform!=="darwin")throw new Error("AppleScript is only supported on macOS");let{humanReadableOutput:s,language:o,timeout:c,...u}=Array.isArray(t)?n||{}:t||{},m=s!==!1?[]:["-ss"];o==="JavaScript"&&m.push("-l","JavaScript"),Array.isArray(t)&&m.push("-",...t);let f=fa.default.spawn("osascript",m,{...u,env:{PATH:"/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin"}}),b=io(f,{timeout:c??1e4});f.stdin.end(r);let[{error:y,exitCode:_,signal:k,timedOut:O},w,E]=await co(f,{encoding:"utf8"},b),$=an({stripFinalNewline:!0},w),x=an({stripFinalNewline:!0},E);return uo({stdout:$,stderr:x,error:y,exitCode:_,signal:k,timedOut:O,command:"osascript",options:n,parentError:new Error})}async function ha(r,t){if(process.platform!=="win32")throw new Error("PowerShell is only supported on Windows");let{timeout:n,...s}=t||{},o=["-NoLogo","-NoProfile","-NonInteractive","-Command","-"],c=fa.default.spawn("powershell.exe",o,{...s}),u=io(c,{timeout:n??1e4});c.stdin.end(r);let[{error:m,exitCode:f,signal:b,timedOut:y},_,k]=await co(c,{encoding:"utf8"},u),O=an({stripFinalNewline:!0},_),w=an({stripFinalNewline:!0},k);return uo({stdout:O,stderr:w,error:m,exitCode:f,signal:b,timedOut:y,command:"powershell.exe",options:t,parentError:new Error})}var ya=te(ba());function ut(r){if(console.log("getError",r),r instanceof ya.HttpError)if(typeof r.data=="string")try{return JSON.parse(r.data).error}catch{return{status:r.status,message:r.data,reason:"UNKNOWN_ERROR"}}else return r.data.error;else{if(r instanceof Error)return{status:500,message:r.message,reason:"UNKNOWN_ERROR"};if(typeof r=="string")return{status:500,message:r,reason:"UNKNOWN_ERROR"}}return{status:500,message:"Unknown error",reason:"UNKNOWN_ERROR"}}function v(r){if(console.log("--- start getErrorMessage ---"),console.log("error",r),console.log("--- end getErrorMessage ---"),r instanceof ya.HttpError)try{return JSON.parse(r.data).error.message}catch{return typeof r.data=="string"?r.data:r.data.error.message}return r instanceof Error?r.message:String(r)}var ga=require("@raycast/api");var Tu="7bbb789c01ff44ed842907b7a80c404f",Pu=["playlist-modify-private","playlist-modify-public","playlist-read-collaborative","playlist-read-private","user-follow-read","user-library-modify","user-library-read","user-modify-playback-state","user-read-currently-playing","user-read-playback-state","user-read-private","user-top-read"].join(" "),$u=new ga.OAuth.PKCEClient({redirectMethod:ga.OAuth.RedirectMethod.Web,providerName:"Spotify",providerIcon:"spotify-icon.svg",description:"Connect your Spotify account",providerId:"spotify"}),Sa=new sn({client:$u,clientId:Tu,scope:Pu,authorizeUrl:"https://accounts.spotify.com/authorize/",tokenUrl:"https://accounts.spotify.com/api/token",refreshTokenUrl:"https://accounts.spotify.com/api/token",bodyEncoding:"url-encoded"});var Oa={};ta(Oa,{defaults:()=>cr,deleteMeAlbums:()=>Ol,deleteMeAudiobooks:()=>sl,deleteMeEpisodes:()=>jl,deleteMeFollowing:()=>Yl,deleteMeShows:()=>Il,deleteMeTracks:()=>Tl,deletePlaylistsByPlaylistIdFollowers:()=>Dl,deletePlaylistsByPlaylistIdTracks:()=>gl,getAlbums:()=>Wu,getAlbumsById:()=>Bu,getAlbumsByIdTracks:()=>Fu,getArtists:()=>Qu,getArtistsById:()=>Nu,getArtistsByIdAlbums:()=>Vu,getArtistsByIdRelatedArtists:()=>Hu,getArtistsByIdTopTracks:()=>Ju,getAudioAnalysisById:()=>td,getAudioFeatures:()=>Xl,getAudioFeaturesById:()=>ed,getAudiobooks:()=>tl,getAudiobooksById:()=>el,getAudiobooksByIdChapters:()=>rl,getBrowseCategories:()=>Wl,getBrowseCategoriesByCategoryId:()=>Fl,getBrowseCategoriesByCategoryIdPlaylists:()=>Nl,getBrowseFeaturedPlaylists:()=>Bl,getBrowseNewReleases:()=>Jl,getChapters:()=>cl,getChaptersById:()=>il,getEpisodes:()=>Xu,getEpisodesById:()=>Zu,getMarkets:()=>Sd,getMe:()=>fl,getMeAlbums:()=>wl,getMeAlbumsContains:()=>kl,getMeAudiobooks:()=>nl,getMeAudiobooksContains:()=>ol,getMeEpisodes:()=>$l,getMeEpisodesContains:()=>vl,getMeFollowing:()=>Hl,getMeFollowingContains:()=>Kl,getMePlayer:()=>ad,getMePlayerCurrentlyPlaying:()=>id,getMePlayerDevices:()=>od,getMePlayerQueue:()=>yd,getMePlayerRecentlyPlayed:()=>bd,getMePlaylists:()=>Sl,getMeShows:()=>Al,getMeShowsContains:()=>Ul,getMeTopArtists:()=>wd,getMeTopTracks:()=>_d,getMeTracks:()=>El,getMeTracksContains:()=>Pl,getNext:()=>Od,getPlaylistsByPlaylistId:()=>pl,getPlaylistsByPlaylistIdFollowersContains:()=>Zl,getPlaylistsByPlaylistIdImages:()=>Ql,getPlaylistsByPlaylistIdTracks:()=>hl,getRecommendations:()=>rd,getRecommendationsAvailableGenreSeeds:()=>nd,getShows:()=>Yu,getShowsById:()=>Gu,getShowsByIdEpisodes:()=>Ku,getTracks:()=>ll,getTracksById:()=>ul,getUsersByUserId:()=>ql,getUsersByUserIdPlaylists:()=>Ml,postMePlayerNext:()=>ld,postMePlayerPrevious:()=>dd,postMePlayerQueue:()=>gd,postPlaylistsByPlaylistIdTracks:()=>bl,postUsersByUserIdPlaylists:()=>zl,putMeAlbums:()=>_l,putMeAudiobooks:()=>al,putMeEpisodes:()=>xl,putMeFollowing:()=>Gl,putMePlayer:()=>sd,putMePlayerPause:()=>ud,putMePlayerPlay:()=>cd,putMePlayerRepeat:()=>pd,putMePlayerSeek:()=>fd,putMePlayerShuffle:()=>hd,putMePlayerVolume:()=>md,putMeShows:()=>Cl,putMeTracks:()=>Rl,putPlaylistsByPlaylistId:()=>ml,putPlaylistsByPlaylistIdFollowers:()=>Ll,putPlaylistsByPlaylistIdImages:()=>Vl,putPlaylistsByPlaylistIdTracks:()=>yl,search:()=>dl,servers:()=>wo});var So=te(go()),h=te(_a()),cr={baseUrl:"https://api.spotify.com/v1"},d=So.runtime(cr),wo={server1:"https://api.spotify.com/v1"};function Bu(r,{market:t}={},n){return d.ok(d.fetchJson(`/albums/${encodeURIComponent(r)}${h.query(h.explode({market:t}))}`,{...n}))}function Wu(r,{market:t}={},n){return d.ok(d.fetchJson(`/albums${h.query(h.explode({ids:r,market:t}))}`,{...n}))}function Fu(r,{market:t,limit:n,offset:s}={},o){return d.ok(d.fetchJson(`/albums/${encodeURIComponent(r)}/tracks${h.query(h.explode({market:t,limit:n,offset:s}))}`,{...o}))}function Nu(r,t){return d.ok(d.fetchJson(`/artists/${encodeURIComponent(r)}`,{...t}))}function Qu(r,t){return d.ok(d.fetchJson(`/artists${h.query(h.explode({ids:r}))}`,{...t}))}function Vu(r,{includeGroups:t,market:n,limit:s,offset:o}={},c){return d.ok(d.fetchJson(`/artists/${encodeURIComponent(r)}/albums${h.query(h.explode({include_groups:t,market:n,limit:s,offset:o}))}`,{...c}))}function Ju(r,{market:t}={},n){return d.ok(d.fetchJson(`/artists/${encodeURIComponent(r)}/top-tracks${h.query(h.explode({market:t}))}`,{...n}))}function Hu(r,t){return d.ok(d.fetchJson(`/artists/${encodeURIComponent(r)}/related-artists`,{...t}))}function Gu(r,{market:t}={},n){return d.ok(d.fetchJson(`/shows/${encodeURIComponent(r)}${h.query(h.explode({market:t}))}`,{...n}))}function Yu(r,{market:t}={},n){return d.ok(d.fetchJson(`/shows${h.query(h.explode({market:t,ids:r}))}`,{...n}))}function Ku(r,{market:t,limit:n,offset:s}={},o){return d.ok(d.fetchJson(`/shows/${encodeURIComponent(r)}/episodes${h.query(h.explode({market:t,limit:n,offset:s}))}`,{...o}))}function Zu(r,{market:t}={},n){return d.ok(d.fetchJson(`/episodes/${encodeURIComponent(r)}${h.query(h.explode({market:t}))}`,{...n}))}function Xu(r,{market:t}={},n){return d.ok(d.fetchJson(`/episodes${h.query(h.explode({ids:r,market:t}))}`,{...n}))}function el(r,{market:t}={},n){return d.ok(d.fetchJson(`/audiobooks/${encodeURIComponent(r)}${h.query(h.explode({market:t}))}`,{...n}))}function tl(r,{market:t}={},n){return d.ok(d.fetchJson(`/audiobooks${h.query(h.explode({ids:r,market:t}))}`,{...n}))}function rl(r,{market:t,limit:n,offset:s}={},o){return d.ok(d.fetchJson(`/audiobooks/${encodeURIComponent(r)}/chapters${h.query(h.explode({market:t,limit:n,offset:s}))}`,{...o}))}function nl({limit:r,offset:t}={},n){return d.ok(d.fetchJson(`/me/audiobooks${h.query(h.explode({limit:r,offset:t}))}`,{...n}))}function al(r,t){return d.ok(d.fetchJson(`/me/audiobooks${h.query(h.explode({ids:r}))}`,{...t,method:"PUT"}))}function sl(r,t){return d.ok(d.fetchJson(`/me/audiobooks${h.query(h.explode({ids:r}))}`,{...t,method:"DELETE"}))}function ol(r,t){return d.ok(d.fetchJson(`/me/audiobooks/contains${h.query(h.explode({ids:r}))}`,{...t}))}function il(r,{market:t}={},n){return d.ok(d.fetchJson(`/chapters/${encodeURIComponent(r)}${h.query(h.explode({market:t}))}`,{...n}))}function cl(r,{market:t}={},n){return d.ok(d.fetchJson(`/chapters${h.query(h.explode({ids:r,market:t}))}`,{...n}))}function ul(r,{market:t}={},n){return d.ok(d.fetchJson(`/tracks/${encodeURIComponent(r)}${h.query(h.explode({market:t}))}`,{...n}))}function ll(r,{market:t}={},n){return d.ok(d.fetchJson(`/tracks${h.query(h.explode({market:t,ids:r}))}`,{...n}))}function dl(r,t,{market:n,limit:s,offset:o,includeExternal:c}={},u){return d.ok(d.fetchJson(`/search${h.query(h.explode({q:r,market:n,limit:s,offset:o,include_external:c}),h.form({type:t}))}`,{...u}))}function fl(r){return d.ok(d.fetchJson("/me",{...r}))}function pl(r,{market:t,fields:n,additionalTypes:s}={},o){return d.ok(d.fetchJson(`/playlists/${encodeURIComponent(r)}${h.query(h.explode({market:t,fields:n,additional_types:s}))}`,{...o}))}function ml(r,t,n){return d.ok(d.fetchJson(`/playlists/${encodeURIComponent(r)}`,d.json({...n,method:"PUT",body:t})))}function hl(r,{market:t,fields:n,limit:s,offset:o,additionalTypes:c}={},u){return d.ok(d.fetchJson(`/playlists/${encodeURIComponent(r)}/tracks${h.query(h.explode({market:t,fields:n,limit:s,offset:o,additional_types:c}))}`,{...u}))}function bl(r,t,{position:n,uris:s}={},o){return d.ok(d.fetchJson(`/playlists/${encodeURIComponent(r)}/tracks${h.query(h.explode({position:n,uris:s}))}`,d.json({...o,method:"POST",body:t})))}function yl(r,t,{uris:n}={},s){return d.ok(d.fetchJson(`/playlists/${encodeURIComponent(r)}/tracks${h.query(h.explode({uris:n}))}`,d.json({...s,method:"PUT",body:t})))}function gl(r,t,n){return d.ok(d.fetchJson(`/playlists/${encodeURIComponent(r)}/tracks`,d.json({...n,method:"DELETE",body:t})))}function Sl({limit:r,offset:t}={},n){return d.ok(d.fetchJson(`/me/playlists${h.query(h.explode({limit:r,offset:t}))}`,{...n}))}function wl({limit:r,offset:t,market:n}={},s){return d.ok(d.fetchJson(`/me/albums${h.query(h.explode({limit:r,offset:t,market:n}))}`,{...s}))}function _l(r,t,n){return d.ok(d.fetchJson(`/me/albums${h.query(h.explode({ids:r}))}`,d.json({...n,method:"PUT",body:t})))}function Ol(r,t,n){return d.ok(d.fetchJson(`/me/albums${h.query(h.explode({ids:r}))}`,d.json({...n,method:"DELETE",body:t})))}function kl(r,t){return d.ok(d.fetchJson(`/me/albums/contains${h.query(h.explode({ids:r}))}`,{...t}))}function El({market:r,limit:t,offset:n}={},s){return d.ok(d.fetchJson(`/me/tracks${h.query(h.explode({market:r,limit:t,offset:n}))}`,{...s}))}function Rl(r,t,n){return d.ok(d.fetchJson(`/me/tracks${h.query(h.explode({ids:r}))}`,d.json({...n,method:"PUT",body:t})))}function Tl(r,t,n){return d.ok(d.fetchJson(`/me/tracks${h.query(h.explode({ids:r}))}`,d.json({...n,method:"DELETE",body:t})))}function Pl(r,t){return d.ok(d.fetchJson(`/me/tracks/contains${h.query(h.explode({ids:r}))}`,{...t}))}function $l({market:r,limit:t,offset:n}={},s){return d.ok(d.fetchJson(`/me/episodes${h.query(h.explode({market:r,limit:t,offset:n}))}`,{...s}))}function xl(r,t,n){return d.ok(d.fetchJson(`/me/episodes${h.query(h.explode({ids:r}))}`,d.json({...n,method:"PUT",body:t})))}function jl(r,t,n){return d.ok(d.fetchJson(`/me/episodes${h.query(h.explode({ids:r}))}`,d.json({...n,method:"DELETE",body:t})))}function vl(r,t){return d.ok(d.fetchJson(`/me/episodes/contains${h.query(h.explode({ids:r}))}`,{...t}))}function Al({limit:r,offset:t}={},n){return d.ok(d.fetchJson(`/me/shows${h.query(h.explode({limit:r,offset:t}))}`,{...n}))}function Cl(r,t,n){return d.ok(d.fetchJson(`/me/shows${h.query(h.explode({ids:r}))}`,d.json({...n,method:"PUT",body:t})))}function Il(r,t,{market:n}={},s){return d.ok(d.fetchJson(`/me/shows${h.query(h.explode({ids:r,market:n}))}`,d.json({...s,method:"DELETE",body:t})))}function Ul(r,t){return d.ok(d.fetchJson(`/me/shows/contains${h.query(h.explode({ids:r}))}`,{...t}))}function ql(r,t){return d.ok(d.fetchJson(`/users/${encodeURIComponent(r)}`,{...t}))}function Ml(r,{limit:t,offset:n}={},s){return d.ok(d.fetchJson(`/users/${encodeURIComponent(r)}/playlists${h.query(h.explode({limit:t,offset:n}))}`,{...s}))}function zl(r,t,n){return d.ok(d.fetchJson(`/users/${encodeURIComponent(r)}/playlists`,d.json({...n,method:"POST",body:t})))}function Ll(r,t,n){return d.ok(d.fetchJson(`/playlists/${encodeURIComponent(r)}/followers`,d.json({...n,method:"PUT",body:t})))}function Dl(r,t){return d.ok(d.fetchJson(`/playlists/${encodeURIComponent(r)}/followers`,{...t,method:"DELETE"}))}function Bl({country:r,locale:t,timestamp:n,limit:s,offset:o}={},c){return d.ok(d.fetchJson(`/browse/featured-playlists${h.query(h.explode({country:r,locale:t,timestamp:n,limit:s,offset:o}))}`,{...c}))}function Wl({country:r,locale:t,limit:n,offset:s}={},o){return d.ok(d.fetchJson(`/browse/categories${h.query(h.explode({country:r,locale:t,limit:n,offset:s}))}`,{...o}))}function Fl(r,{country:t,locale:n}={},s){return d.ok(d.fetchJson(`/browse/categories/${encodeURIComponent(r)}${h.query(h.explode({country:t,locale:n}))}`,{...s}))}function Nl(r,{country:t,limit:n,offset:s}={},o){return d.ok(d.fetchJson(`/browse/categories/${encodeURIComponent(r)}/playlists${h.query(h.explode({country:t,limit:n,offset:s}))}`,{...o}))}function Ql(r,t){return d.ok(d.fetchJson(`/playlists/${encodeURIComponent(r)}/images`,{...t}))}function Vl(r,t,n){return d.ok(d.fetchJson(`/playlists/${encodeURIComponent(r)}/images`,{...n,method:"PUT",body:t}))}function Jl({country:r,limit:t,offset:n}={},s){return d.ok(d.fetchJson(`/browse/new-releases${h.query(h.explode({country:r,limit:t,offset:n}))}`,{...s}))}function Hl(r,{after:t,limit:n}={},s){return d.ok(d.fetchJson(`/me/following${h.query(h.explode({type:r,after:t,limit:n}))}`,{...s}))}function Gl(r,t,n,s){return d.ok(d.fetchJson(`/me/following${h.query(h.explode({type:r,ids:t}))}`,d.json({...s,method:"PUT",body:n})))}function Yl(r,t,n,s){return d.ok(d.fetchJson(`/me/following${h.query(h.explode({type:r,ids:t}))}`,d.json({...s,method:"DELETE",body:n})))}function Kl(r,t,n){return d.ok(d.fetchJson(`/me/following/contains${h.query(h.explode({type:r,ids:t}))}`,{...n}))}function Zl(r,t,n){return d.ok(d.fetchJson(`/playlists/${encodeURIComponent(r)}/followers/contains${h.query(h.explode({ids:t}))}`,{...n}))}function Xl(r,t){return d.ok(d.fetchJson(`/audio-features${h.query(h.explode({ids:r}))}`,{...t}))}function ed(r,t){return d.ok(d.fetchJson(`/audio-features/${encodeURIComponent(r)}`,{...t}))}function td(r,t){return d.ok(d.fetchJson(`/audio-analysis/${encodeURIComponent(r)}`,{...t}))}function rd({limit:r,market:t,seedArtists:n,seedGenres:s,seedTracks:o,minAcousticness:c,maxAcousticness:u,targetAcousticness:m,minDanceability:f,maxDanceability:b,targetDanceability:y,minDurationMs:_,maxDurationMs:k,targetDurationMs:O,minEnergy:w,maxEnergy:E,targetEnergy:$,minInstrumentalness:x,maxInstrumentalness:W,targetInstrumentalness:F,minKey:T,maxKey:z,targetKey:C,minLiveness:se,maxLiveness:ee,targetLiveness:yt,minLoudness:et,maxLoudness:G,targetLoudness:H,minMode:_e,maxMode:Te,targetMode:M,minPopularity:he,maxPopularity:Dt,targetPopularity:gt,minSpeechiness:gr,maxSpeechiness:Sr,targetSpeechiness:Bt,minTempo:Wt,maxTempo:wr,targetTempo:Tn,minTimeSignature:Pn,maxTimeSignature:Pe,targetTimeSignature:be,minValence:$n,maxValence:_r,targetValence:$e}={},Ft){return d.ok(d.fetchJson(`/recommendations${h.query(h.explode({limit:r,market:t,seed_artists:n,seed_genres:s,seed_tracks:o,min_acousticness:c,max_acousticness:u,target_acousticness:m,min_danceability:f,max_danceability:b,target_danceability:y,min_duration_ms:_,max_duration_ms:k,target_duration_ms:O,min_energy:w,max_energy:E,target_energy:$,min_instrumentalness:x,max_instrumentalness:W,target_instrumentalness:F,min_key:T,max_key:z,target_key:C,min_liveness:se,max_liveness:ee,target_liveness:yt,min_loudness:et,max_loudness:G,target_loudness:H,min_mode:_e,max_mode:Te,target_mode:M,min_popularity:he,max_popularity:Dt,target_popularity:gt,min_speechiness:gr,max_speechiness:Sr,target_speechiness:Bt,min_tempo:Wt,max_tempo:wr,target_tempo:Tn,min_time_signature:Pn,max_time_signature:Pe,target_time_signature:be,min_valence:$n,max_valence:_r,target_valence:$e}))}`,{...Ft}))}function nd(r){return d.ok(d.fetchJson("/recommendations/available-genre-seeds",{...r}))}function ad({market:r,additionalTypes:t}={},n){return d.ok(d.fetchJson(`/me/player${h.query(h.explode({market:r,additional_types:t}))}`,{...n}))}function sd(r,t){return d.ok(d.fetchJson("/me/player",d.json({...t,method:"PUT",body:r})))}function od(r){return d.ok(d.fetchJson("/me/player/devices",{...r}))}function id({market:r,additionalTypes:t}={},n){return d.ok(d.fetchJson(`/me/player/currently-playing${h.query(h.explode({market:r,additional_types:t}))}`,{...n}))}function cd(r,{deviceId:t}={},n){return d.ok(d.fetchJson(`/me/player/play${h.query(h.explode({device_id:t}))}`,d.json({...n,method:"PUT",body:r})))}function ud({deviceId:r}={},t){return d.ok(d.fetchJson(`/me/player/pause${h.query(h.explode({device_id:r}))}`,{...t,method:"PUT"}))}function ld({deviceId:r}={},t){return d.ok(d.fetchJson(`/me/player/next${h.query(h.explode({device_id:r}))}`,{...t,method:"POST"}))}function dd({deviceId:r}={},t){return d.ok(d.fetchJson(`/me/player/previous${h.query(h.explode({device_id:r}))}`,{...t,method:"POST"}))}function fd(r,{deviceId:t}={},n){return d.ok(d.fetchJson(`/me/player/seek${h.query(h.explode({position_ms:r,device_id:t}))}`,{...n,method:"PUT"}))}function pd(r,{deviceId:t}={},n){return d.ok(d.fetchJson(`/me/player/repeat${h.query(h.explode({state:r,device_id:t}))}`,{...n,method:"PUT"}))}function md(r,{deviceId:t}={},n){return d.ok(d.fetchJson(`/me/player/volume${h.query(h.explode({volume_percent:r,device_id:t}))}`,{...n,method:"PUT"}))}function hd(r,{deviceId:t}={},n){return d.ok(d.fetchJson(`/me/player/shuffle${h.query(h.explode({state:r,device_id:t}))}`,{...n,method:"PUT"}))}function bd({limit:r,after:t,before:n}={},s){return d.ok(d.fetchJson(`/me/player/recently-played${h.query(h.explode({limit:r,after:t,before:n}))}`,{...s}))}function yd(r){return d.ok(d.fetchJson("/me/player/queue",{...r}))}function gd(r,{deviceId:t}={},n){return d.ok(d.fetchJson(`/me/player/queue${h.query(h.explode({uri:r,device_id:t}))}`,{...n,method:"POST"}))}function Sd(r){return d.ok(d.fetchJson("/markets",{...r}))}function wd({timeRange:r,limit:t,offset:n}={},s){return d.ok(d.fetchJson(`/me/top/artists${h.query(h.explode({time_range:r,limit:t,offset:n}))}`,{...s}))}function _d({timeRange:r,limit:t,offset:n}={},s){return d.ok(d.fetchJson(`/me/top/tracks${h.query(h.explode({time_range:r,limit:t,offset:n}))}`,{...s}))}function Od(r,t){let n=r.replace(wo.server1,"");return d.ok(d.fetchJson(n,{...t}))}var Zo=te(require("node:http"),1),Xo=te(require("node:https"),1),mt=te(require("node:zlib"),1),we=te(require("node:stream"),1),hr=require("node:buffer");function kd(r){if(!/^data:/i.test(r))throw new TypeError('`uri` does not appear to be a Data URI (must begin with "data:")');r=r.replace(/\r?\n/g,"");let t=r.indexOf(",");if(t===-1||t<=4)throw new TypeError("malformed data: URI");let n=r.substring(5,t).split(";"),s="",o=!1,c=n[0]||"text/plain",u=c;for(let y=1;y<n.length;y++)n[y]==="base64"?o=!0:n[y]&&(u+=`;${n[y]}`,n[y].indexOf("charset=")===0&&(s=n[y].substring(8)));!n[0]&&!s.length&&(u+=";charset=US-ASCII",s="US-ASCII");let m=o?"base64":"ascii",f=unescape(r.substring(t+1)),b=Buffer.from(f,m);return b.type=c,b.typeFull=u,b.charset=s,b}var _o=kd;var Ee=te(require("node:stream"),1),Fe=require("node:util"),ge=require("node:buffer");ur();fn();var We=class extends Error{constructor(t,n){super(t),Error.captureStackTrace(this,this.constructor),this.type=n}get name(){return this.constructor.name}get[Symbol.toStringTag](){return this.constructor.name}};var fe=class extends We{constructor(t,n,s){super(t,n),s&&(this.code=this.errno=s.code,this.erroredSysCall=s.syscall)}};var pn=Symbol.toStringTag,Pa=r=>typeof r=="object"&&typeof r.append=="function"&&typeof r.delete=="function"&&typeof r.get=="function"&&typeof r.getAll=="function"&&typeof r.has=="function"&&typeof r.set=="function"&&typeof r.sort=="function"&&r[pn]==="URLSearchParams",dr=r=>r&&typeof r=="object"&&typeof r.arrayBuffer=="function"&&typeof r.type=="string"&&typeof r.stream=="function"&&typeof r.constructor=="function"&&/^(Blob|File)$/.test(r[pn]),jo=r=>typeof r=="object"&&(r[pn]==="AbortSignal"||r[pn]==="EventTarget"),vo=(r,t)=>{let n=new URL(t).hostname,s=new URL(r).hostname;return n===s||n.endsWith(`.${s}`)},Ao=(r,t)=>{let n=new URL(t).protocol,s=new URL(r).protocol;return n===s};var zd=(0,Fe.promisify)(Ee.default.pipeline),pe=Symbol("Body internals"),ze=class{constructor(t,{size:n=0}={}){let s=null;t===null?t=null:Pa(t)?t=ge.Buffer.from(t.toString()):dr(t)||ge.Buffer.isBuffer(t)||(Fe.types.isAnyArrayBuffer(t)?t=ge.Buffer.from(t):ArrayBuffer.isView(t)?t=ge.Buffer.from(t.buffer,t.byteOffset,t.byteLength):t instanceof Ee.default||(t instanceof dt?(t=xo(t),s=t.type.split("=")[1]):t=ge.Buffer.from(String(t))));let o=t;ge.Buffer.isBuffer(t)?o=Ee.default.Readable.from(t):dr(t)&&(o=Ee.default.Readable.from(t.stream())),this[pe]={body:t,stream:o,boundary:s,disturbed:!1,error:null},this.size=n,t instanceof Ee.default&&t.on("error",c=>{let u=c instanceof We?c:new fe(`Invalid response body while trying to fetch ${this.url}: ${c.message}`,"system",c);this[pe].error=u})}get body(){return this[pe].stream}get bodyUsed(){return this[pe].disturbed}async arrayBuffer(){let{buffer:t,byteOffset:n,byteLength:s}=await ja(this);return t.slice(n,n+s)}async formData(){let t=this.headers.get("content-type");if(t.startsWith("application/x-www-form-urlencoded")){let s=new dt,o=new URLSearchParams(await this.text());for(let[c,u]of o)s.append(c,u);return s}let{toFormData:n}=await Promise.resolve().then(()=>(Mo(),qo));return n(this.body,t)}async blob(){let t=this.headers&&this.headers.get("content-type")||this[pe].body&&this[pe].body.type||"",n=await this.arrayBuffer();return new Be([n],{type:t})}async json(){let t=await this.text();return JSON.parse(t)}async text(){let t=await ja(this);return new TextDecoder().decode(t)}buffer(){return ja(this)}};ze.prototype.buffer=(0,Fe.deprecate)(ze.prototype.buffer,"Please use 'response.arrayBuffer()' instead of 'response.buffer()'","node-fetch#buffer");Object.defineProperties(ze.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0},data:{get:(0,Fe.deprecate)(()=>{},"data doesn't exist, use json(), text(), arrayBuffer(), or body instead","https://github.com/node-fetch/node-fetch/issues/1000 (response)")}});async function ja(r){if(r[pe].disturbed)throw new TypeError(`body used already for: ${r.url}`);if(r[pe].disturbed=!0,r[pe].error)throw r[pe].error;let{body:t}=r;if(t===null)return ge.Buffer.alloc(0);if(!(t instanceof Ee.default))return ge.Buffer.alloc(0);let n=[],s=0;try{for await(let o of t){if(r.size>0&&s+o.length>r.size){let c=new fe(`content size at ${r.url} over limit: ${r.size}`,"max-size");throw t.destroy(c),c}s+=o.length,n.push(o)}}catch(o){throw o instanceof We?o:new fe(`Invalid response body while trying to fetch ${r.url}: ${o.message}`,"system",o)}if(t.readableEnded===!0||t._readableState.ended===!0)try{return n.every(o=>typeof o=="string")?ge.Buffer.from(n.join("")):ge.Buffer.concat(n,s)}catch(o){throw new fe(`Could not create Buffer from response body for ${r.url}: ${o.message}`,"system",o)}else throw new fe(`Premature close of server response while trying to fetch ${r.url}`)}var Ut=(r,t)=>{let n,s,{body:o}=r[pe];if(r.bodyUsed)throw new Error("cannot clone body after it is used");return o instanceof Ee.default&&typeof o.getBoundary!="function"&&(n=new Ee.PassThrough({highWaterMark:t}),s=new Ee.PassThrough({highWaterMark:t}),o.pipe(n),o.pipe(s),r[pe].stream=n,o=s),o},Ld=(0,Fe.deprecate)(r=>r.getBoundary(),"form-data doesn't follow the spec and requires special treatment. Use alternative package","https://github.com/node-fetch/node-fetch/issues/1167"),yn=(r,t)=>r===null?null:typeof r=="string"?"text/plain;charset=UTF-8":Pa(r)?"application/x-www-form-urlencoded;charset=UTF-8":dr(r)?r.type||null:ge.Buffer.isBuffer(r)||Fe.types.isAnyArrayBuffer(r)||ArrayBuffer.isView(r)?null:r instanceof dt?`multipart/form-data; boundary=${t[pe].boundary}`:r&&typeof r.getBoundary=="function"?`multipart/form-data;boundary=${Ld(r)}`:r instanceof Ee.default?null:"text/plain;charset=UTF-8",zo=r=>{let{body:t}=r[pe];return t===null?0:dr(t)?t.size:ge.Buffer.isBuffer(t)?t.length:t&&typeof t.getLengthSync=="function"&&t.hasKnownLength&&t.hasKnownLength()?t.getLengthSync():null},Lo=async(r,{body:t})=>{t===null?r.end():await zd(t,r)};var va=require("node:util"),pr=te(require("node:http"),1),gn=typeof pr.default.validateHeaderName=="function"?pr.default.validateHeaderName:r=>{if(!/^[\^`\-\w!#$%&'*+.|~]+$/.test(r)){let t=new TypeError(`Header name must be a valid HTTP token [${r}]`);throw Object.defineProperty(t,"code",{value:"ERR_INVALID_HTTP_TOKEN"}),t}},Aa=typeof pr.default.validateHeaderValue=="function"?pr.default.validateHeaderValue:(r,t)=>{if(/[^\t\u0020-\u007E\u0080-\u00FF]/.test(t)){let n=new TypeError(`Invalid character in header content ["${r}"]`);throw Object.defineProperty(n,"code",{value:"ERR_INVALID_CHAR"}),n}},Se=class r extends URLSearchParams{constructor(t){let n=[];if(t instanceof r){let s=t.raw();for(let[o,c]of Object.entries(s))n.push(...c.map(u=>[o,u]))}else if(t!=null)if(typeof t=="object"&&!va.types.isBoxedPrimitive(t)){let s=t[Symbol.iterator];if(s==null)n.push(...Object.entries(t));else{if(typeof s!="function")throw new TypeError("Header pairs must be iterable");n=[...t].map(o=>{if(typeof o!="object"||va.types.isBoxedPrimitive(o))throw new TypeError("Each header pair must be an iterable object");return[...o]}).map(o=>{if(o.length!==2)throw new TypeError("Each header pair must be a name/value tuple");return[...o]})}}else throw new TypeError("Failed to construct 'Headers': The provided value is not of type '(sequence<sequence<ByteString>> or record<ByteString, ByteString>)");return n=n.length>0?n.map(([s,o])=>(gn(s),Aa(s,String(o)),[String(s).toLowerCase(),String(o)])):void 0,super(n),new Proxy(this,{get(s,o,c){switch(o){case"append":case"set":return(u,m)=>(gn(u),Aa(u,String(m)),URLSearchParams.prototype[o].call(s,String(u).toLowerCase(),String(m)));case"delete":case"has":case"getAll":return u=>(gn(u),URLSearchParams.prototype[o].call(s,String(u).toLowerCase()));case"keys":return()=>(s.sort(),new Set(URLSearchParams.prototype.keys.call(s)).keys());default:return Reflect.get(s,o,c)}}})}get[Symbol.toStringTag](){return this.constructor.name}toString(){return Object.prototype.toString.call(this)}get(t){let n=this.getAll(t);if(n.length===0)return null;let s=n.join(", ");return/^content-encoding$/i.test(t)&&(s=s.toLowerCase()),s}forEach(t,n=void 0){for(let s of this.keys())Reflect.apply(t,n,[this.get(s),s,this])}*values(){for(let t of this.keys())yield this.get(t)}*entries(){for(let t of this.keys())yield[t,this.get(t)]}[Symbol.iterator](){return this.entries()}raw(){return[...this.keys()].reduce((t,n)=>(t[n]=this.getAll(n),t),{})}[Symbol.for("nodejs.util.inspect.custom")](){return[...this.keys()].reduce((t,n)=>{let s=this.getAll(n);return n==="host"?t[n]=s[0]:t[n]=s.length>1?s:s[0],t},{})}};Object.defineProperties(Se.prototype,["get","entries","forEach","values"].reduce((r,t)=>(r[t]={enumerable:!0},r),{}));function Do(r=[]){return new Se(r.reduce((t,n,s,o)=>(s%2===0&&t.push(o.slice(s,s+2)),t),[]).filter(([t,n])=>{try{return gn(t),Aa(t,String(n)),!0}catch{return!1}}))}var Dd=new Set([301,302,303,307,308]),Sn=r=>Dd.has(r);var Ae=Symbol("Response internals"),Re=class r extends ze{constructor(t=null,n={}){super(t,n);let s=n.status!=null?n.status:200,o=new Se(n.headers);if(t!==null&&!o.has("Content-Type")){let c=yn(t,this);c&&o.append("Content-Type",c)}this[Ae]={type:"default",url:n.url,status:s,statusText:n.statusText||"",headers:o,counter:n.counter,highWaterMark:n.highWaterMark}}get type(){return this[Ae].type}get url(){return this[Ae].url||""}get status(){return this[Ae].status}get ok(){return this[Ae].status>=200&&this[Ae].status<300}get redirected(){return this[Ae].counter>0}get statusText(){return this[Ae].statusText}get headers(){return this[Ae].headers}get highWaterMark(){return this[Ae].highWaterMark}clone(){return new r(Ut(this,this.highWaterMark),{type:this.type,url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected,size:this.size,highWaterMark:this.highWaterMark})}static redirect(t,n=302){if(!Sn(n))throw new RangeError('Failed to execute "redirect" on "response": Invalid status code');return new r(null,{headers:{location:new URL(t).toString()},status:n})}static error(){let t=new r(null,{status:0,statusText:""});return t[Ae].type="error",t}static json(t=void 0,n={}){let s=JSON.stringify(t);if(s===void 0)throw new TypeError("data is not JSON serializable");let o=new Se(n&&n.headers);return o.has("content-type")||o.set("content-type","application/json"),new r(s,{...n,headers:o})}get[Symbol.toStringTag](){return"Response"}};Object.defineProperties(Re.prototype,{type:{enumerable:!0},url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}});var Go=require("node:url"),Yo=require("node:util");var Bo=r=>{if(r.search)return r.search;let t=r.href.length-1,n=r.hash||(r.href[t]==="#"?"#":"");return r.href[t-n.length]==="?"?"?":""};var Fo=require("node:net");function Wo(r,t=!1){return r==null||(r=new URL(r),/^(about|blob|data):$/.test(r.protocol))?"no-referrer":(r.username="",r.password="",r.hash="",t&&(r.pathname="",r.search=""),r)}var No=new Set(["","no-referrer","no-referrer-when-downgrade","same-origin","origin","strict-origin","origin-when-cross-origin","strict-origin-when-cross-origin","unsafe-url"]),Qo="strict-origin-when-cross-origin";function Vo(r){if(!No.has(r))throw new TypeError(`Invalid referrerPolicy: ${r}`);return r}function Bd(r){if(/^(http|ws)s:$/.test(r.protocol))return!0;let t=r.host.replace(/(^\[)|(]$)/g,""),n=(0,Fo.isIP)(t);return n===4&&/^127\./.test(t)||n===6&&/^(((0+:){7})|(::(0+:){0,6}))0*1$/.test(t)?!0:r.host==="localhost"||r.host.endsWith(".localhost")?!1:r.protocol==="file:"}function qt(r){return/^about:(blank|srcdoc)$/.test(r)||r.protocol==="data:"||/^(blob|filesystem):$/.test(r.protocol)?!0:Bd(r)}function Jo(r,{referrerURLCallback:t,referrerOriginCallback:n}={}){if(r.referrer==="no-referrer"||r.referrerPolicy==="")return null;let s=r.referrerPolicy;if(r.referrer==="about:client")return"no-referrer";let o=r.referrer,c=Wo(o),u=Wo(o,!0);c.toString().length>4096&&(c=u),t&&(c=t(c)),n&&(u=n(u));let m=new URL(r.url);switch(s){case"no-referrer":return"no-referrer";case"origin":return u;case"unsafe-url":return c;case"strict-origin":return qt(c)&&!qt(m)?"no-referrer":u.toString();case"strict-origin-when-cross-origin":return c.origin===m.origin?c:qt(c)&&!qt(m)?"no-referrer":u;case"same-origin":return c.origin===m.origin?c:"no-referrer";case"origin-when-cross-origin":return c.origin===m.origin?c:u;case"no-referrer-when-downgrade":return qt(c)&&!qt(m)?"no-referrer":c;default:throw new TypeError(`Invalid referrerPolicy: ${s}`)}}function Ho(r){let t=(r.get("referrer-policy")||"").split(/[,\s]+/),n="";for(let s of t)s&&No.has(s)&&(n=s);return n}var Z=Symbol("Request internals"),mr=r=>typeof r=="object"&&typeof r[Z]=="object",Wd=(0,Yo.deprecate)(()=>{},".data is not a valid RequestInit property, use .body instead","https://github.com/node-fetch/node-fetch/issues/1000 (request)"),pt=class r extends ze{constructor(t,n={}){let s;if(mr(t)?s=new URL(t.url):(s=new URL(t),t={}),s.username!==""||s.password!=="")throw new TypeError(`${s} is an url with embedded credentials.`);let o=n.method||t.method||"GET";if(/^(delete|get|head|options|post|put)$/i.test(o)&&(o=o.toUpperCase()),!mr(n)&&"data"in n&&Wd(),(n.body!=null||mr(t)&&t.body!==null)&&(o==="GET"||o==="HEAD"))throw new TypeError("Request with GET/HEAD method cannot have body");let c=n.body?n.body:mr(t)&&t.body!==null?Ut(t):null;super(c,{size:n.size||t.size||0});let u=new Se(n.headers||t.headers||{});if(c!==null&&!u.has("Content-Type")){let b=yn(c,this);b&&u.set("Content-Type",b)}let m=mr(t)?t.signal:null;if("signal"in n&&(m=n.signal),m!=null&&!jo(m))throw new TypeError("Expected signal to be an instanceof AbortSignal or EventTarget");let f=n.referrer==null?t.referrer:n.referrer;if(f==="")f="no-referrer";else if(f){let b=new URL(f);f=/^about:(\/\/)?client$/.test(b)?"client":b}else f=void 0;this[Z]={method:o,redirect:n.redirect||t.redirect||"follow",headers:u,parsedURL:s,signal:m,referrer:f},this.follow=n.follow===void 0?t.follow===void 0?20:t.follow:n.follow,this.compress=n.compress===void 0?t.compress===void 0?!0:t.compress:n.compress,this.counter=n.counter||t.counter||0,this.agent=n.agent||t.agent,this.highWaterMark=n.highWaterMark||t.highWaterMark||16384,this.insecureHTTPParser=n.insecureHTTPParser||t.insecureHTTPParser||!1,this.referrerPolicy=n.referrerPolicy||t.referrerPolicy||""}get method(){return this[Z].method}get url(){return(0,Go.format)(this[Z].parsedURL)}get headers(){return this[Z].headers}get redirect(){return this[Z].redirect}get signal(){return this[Z].signal}get referrer(){if(this[Z].referrer==="no-referrer")return"";if(this[Z].referrer==="client")return"about:client";if(this[Z].referrer)return this[Z].referrer.toString()}get referrerPolicy(){return this[Z].referrerPolicy}set referrerPolicy(t){this[Z].referrerPolicy=Vo(t)}clone(){return new r(this)}get[Symbol.toStringTag](){return"Request"}};Object.defineProperties(pt.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0},referrer:{enumerable:!0},referrerPolicy:{enumerable:!0}});var Ko=r=>{let{parsedURL:t}=r[Z],n=new Se(r[Z].headers);n.has("Accept")||n.set("Accept","*/*");let s=null;if(r.body===null&&/^(post|put)$/i.test(r.method)&&(s="0"),r.body!==null){let m=zo(r);typeof m=="number"&&!Number.isNaN(m)&&(s=String(m))}s&&n.set("Content-Length",s),r.referrerPolicy===""&&(r.referrerPolicy=Qo),r.referrer&&r.referrer!=="no-referrer"?r[Z].referrer=Jo(r):r[Z].referrer="no-referrer",r[Z].referrer instanceof URL&&n.set("Referer",r.referrer),n.has("User-Agent")||n.set("User-Agent","node-fetch"),r.compress&&!n.has("Accept-Encoding")&&n.set("Accept-Encoding","gzip, deflate, br");let{agent:o}=r;typeof o=="function"&&(o=o(t));let c=Bo(t),u={path:t.pathname+c,method:r.method,headers:n[Symbol.for("nodejs.util.inspect.custom")](),insecureHTTPParser:r.insecureHTTPParser,agent:o};return{parsedURL:t,options:u}};var wn=class extends We{constructor(t,n="aborted"){super(t,n)}};fn();$a();var Fd=new Set(["data:","http:","https:"]);async function _n(r,t){return new Promise((n,s)=>{let o=new pt(r,t),{parsedURL:c,options:u}=Ko(o);if(!Fd.has(c.protocol))throw new TypeError(`node-fetch cannot load ${r}. URL scheme "${c.protocol.replace(/:$/,"")}" is not supported.`);if(c.protocol==="data:"){let w=_o(o.url),E=new Re(w,{headers:{"Content-Type":w.typeFull}});n(E);return}let m=(c.protocol==="https:"?Xo.default:Zo.default).request,{signal:f}=o,b=null,y=()=>{let w=new wn("The operation was aborted.");s(w),o.body&&o.body instanceof we.default.Readable&&o.body.destroy(w),!(!b||!b.body)&&b.body.emit("error",w)};if(f&&f.aborted){y();return}let _=()=>{y(),O()},k=m(c.toString(),u);f&&f.addEventListener("abort",_);let O=()=>{k.abort(),f&&f.removeEventListener("abort",_)};k.on("error",w=>{s(new fe(`request to ${o.url} failed, reason: ${w.message}`,"system",w)),O()}),Nd(k,w=>{b&&b.body&&b.body.destroy(w)}),process.version<"v14"&&k.on("socket",w=>{let E;w.prependListener("end",()=>{E=w._eventsCount}),w.prependListener("close",$=>{if(b&&E<w._eventsCount&&!$){let x=new Error("Premature close");x.code="ERR_STREAM_PREMATURE_CLOSE",b.body.emit("error",x)}})}),k.on("response",w=>{k.setTimeout(0);let E=Do(w.rawHeaders);if(Sn(w.statusCode)){let T=E.get("Location"),z=null;try{z=T===null?null:new URL(T,o.url)}catch{if(o.redirect!=="manual"){s(new fe(`uri requested responds with an invalid redirect URL: ${T}`,"invalid-redirect")),O();return}}switch(o.redirect){case"error":s(new fe(`uri requested responds with a redirect, redirect mode is set to error: ${o.url}`,"no-redirect")),O();return;case"manual":break;case"follow":{if(z===null)break;if(o.counter>=o.follow){s(new fe(`maximum redirect reached at: ${o.url}`,"max-redirect")),O();return}let C={headers:new Se(o.headers),follow:o.follow,counter:o.counter+1,agent:o.agent,compress:o.compress,method:o.method,body:Ut(o),signal:o.signal,size:o.size,referrer:o.referrer,referrerPolicy:o.referrerPolicy};if(!vo(o.url,z)||!Ao(o.url,z))for(let ee of["authorization","www-authenticate","cookie","cookie2"])C.headers.delete(ee);if(w.statusCode!==303&&o.body&&t.body instanceof we.default.Readable){s(new fe("Cannot follow redirect with body being a readable stream","unsupported-redirect")),O();return}(w.statusCode===303||(w.statusCode===301||w.statusCode===302)&&o.method==="POST")&&(C.method="GET",C.body=void 0,C.headers.delete("content-length"));let se=Ho(E);se&&(C.referrerPolicy=se),n(_n(new pt(z,C))),O();return}default:return s(new TypeError(`Redirect option '${o.redirect}' is not a valid value of RequestRedirect`))}}f&&w.once("end",()=>{f.removeEventListener("abort",_)});let $=(0,we.pipeline)(w,new we.PassThrough,T=>{T&&s(T)});process.version<"v12.10"&&w.on("aborted",_);let x={url:o.url,status:w.statusCode,statusText:w.statusMessage,headers:E,size:o.size,counter:o.counter,highWaterMark:o.highWaterMark},W=E.get("Content-Encoding");if(!o.compress||o.method==="HEAD"||W===null||w.statusCode===204||w.statusCode===304){b=new Re($,x),n(b);return}let F={flush:mt.default.Z_SYNC_FLUSH,finishFlush:mt.default.Z_SYNC_FLUSH};if(W==="gzip"||W==="x-gzip"){$=(0,we.pipeline)($,mt.default.createGunzip(F),T=>{T&&s(T)}),b=new Re($,x),n(b);return}if(W==="deflate"||W==="x-deflate"){let T=(0,we.pipeline)(w,new we.PassThrough,z=>{z&&s(z)});T.once("data",z=>{(z[0]&15)===8?$=(0,we.pipeline)($,mt.default.createInflate(),C=>{C&&s(C)}):$=(0,we.pipeline)($,mt.default.createInflateRaw(),C=>{C&&s(C)}),b=new Re($,x),n(b)}),T.once("end",()=>{b||(b=new Re($,x),n(b))});return}if(W==="br"){$=(0,we.pipeline)($,mt.default.createBrotliDecompress(),T=>{T&&s(T)}),b=new Re($,x),n(b);return}b=new Re($,x),n(b)}),Lo(k,o).catch(s)})}function Nd(r,t){let n=hr.Buffer.from(`0\r
\r
`),s=!1,o=!1,c;r.on("response",u=>{let{headers:m}=u;s=m["transfer-encoding"]==="chunked"&&!m["content-length"]}),r.on("socket",u=>{let m=()=>{if(s&&!o){let b=new Error("Premature close");b.code="ERR_STREAM_PREMATURE_CLOSE",t(b)}},f=b=>{o=hr.Buffer.compare(b.slice(-5),n)===0,!o&&c&&(o=hr.Buffer.compare(c.slice(-3),n.slice(0,3))===0&&hr.Buffer.compare(b.slice(-2),n.slice(3))===0),c=b};u.prependListener("close",m),u.on("data",f),r.on("close",()=>{u.removeListener("close",m),u.removeListener("data",f)})})}var Ca;Sa.onAuthorize=({token:r})=>{cr.headers={Authorization:`Bearer ${r}`},cr.fetch=_n,Ca=Oa};var ei=lo(Sa);function B(){if(!Ca)throw new Error("getSpotifyClient must be used when authenticated");return{spotifyClient:Ca}}async function ti(r,t){let{spotifyClient:n}=B();try{return(await n.search(r,["track"],{limit:t})).tracks}catch(s){let o=v(s);throw console.log("searchTracks.ts Error:",o),new Error(o)}}var ni=require("react");var ri=require("@raycast/api"),On=!1;async function kn(){return On=!!(await(0,ri.getApplications)()).find(n=>n.bundleId?n.bundleId==="com.spotify.client":n.name==="Spotify"),On}var ai=ei(({children:r})=>((0,ni.useEffect)(()=>{kn()},[]),r));var Ii=require("@raycast/api");function si(r){let t=Math.floor(r/36e5),n=Math.floor(r%36e5/6e4),s=Math.floor(r%6e4/1e3);return`${t>0?`${Ia(t)}:`:""}${Ia(n)}:${Ia(s)}`}var Ia=r=>String(r).padStart(2,"0");var Lt=require("@raycast/api");var li=require("@raycast/api");async function oi({albumId:r,limit:t}){let{spotifyClient:n}=B();try{return await n.getAlbumsByIdTracks(r,{limit:t})}catch(s){let o=v(s);throw console.log("getAlbumTracks.ts Error:",o),new Error(o)}}function ii({albumId:r="",limit:t=50,options:n}){let{data:s,error:o,isLoading:c}=Ue((u,m)=>oi({albumId:u,limit:m}),[r,t],{execute:n?.execute!==!1&&!!r&&!!t});return{albumTracksData:s,albumTracksError:o,albumTracksIsLoading:c}}async function ci(r,t,n){let{spotifyClient:s}=B(),o=[],c=null,u=n??0;try{let m;do{if(m=await s.getPlaylistsByPlaylistIdTracks(r,{limit:Math.min(t-o.length,50),offset:u}),m.items){let f=(m?.items??[]).map(b=>({...b.track||{}}));o.push(...f)}c=m.next,u+=50}while(c&&o.length<t&&m.items&&m.items.length>0);return{items:o}}catch(m){let f=v(m);throw console.log("getPlaylistTracks.ts Error:",f),new Error(f)}}function ui({playlistId:r="",limit:t=500,options:n}){let{data:s,error:o,isLoading:c}=Ue((u,m)=>ci(u,m),[r,t],{execute:n?.execute!==!1&&!!r&&!!t});return{playlistTracksData:s,playlistTracksError:o,playlistTracksIsLoading:c}}var Ua=require("react/jsx-runtime");function di({album:r,playlist:t,tracks:n,showGoToAlbum:s}){let{albumTracksData:o,albumTracksIsLoading:c}=ii({albumId:r?.id,options:{execute:!!r}}),{playlistTracksData:u,playlistTracksIsLoading:m}=ui({playlistId:t?.id,options:{execute:!!t}}),f=o?.items||u?.items||n;return(0,Ua.jsx)(li.List,{searchBarPlaceholder:"Search songs",isLoading:c||m,children:f&&f.map((b,y)=>(0,Ua.jsx)(br,{playingContext:r?.uri||t?.uri,track:b,album:r||b.album,showGoToAlbum:s},`${b.id}${y}`))})}async function fi({limit:r=50}={}){let{spotifyClient:t}=B(),n=null,s=null;try{for(n=await t.getMePlaylists({limit:r}),s=n?.next;s;){let o=await t.getNext(s);n={...n,...o,items:[...n?.items??[],...o.items??[]]},s=o?.next}return n}catch(o){let c=v(o);throw console.log("getMyPlaylists.ts Error:",c),new Error(c)}}function pi({options:r}={}){let{data:t,error:n,isLoading:s,revalidate:o}=Ue(()=>fi(),[],{execute:r?.execute!==!1});return{myPlaylistsData:t,myPlaylistsError:n,myPlaylistsIsLoading:s,myPlaylistsRevalidate:o}}async function mi(){let{spotifyClient:r}=B();try{return await r.getMe()}catch(t){let n=v(t);throw console.log("getMe.ts Error:",n),new Error(n)}}function hi({options:r}={}){let{data:t,error:n,isLoading:s,revalidate:o}=Ue(()=>mi(),[],{execute:r?.execute!==!1});return{meData:t,meError:n,meIsLoading:s,meRevalidate:o}}var ne=require("@raycast/api");async function En({playlistId:r,trackUris:t}){let{spotifyClient:n}=B();try{return await n.postPlaylistsByPlaylistIdTracks(r,{uris:t})}catch(s){let o=v(s);throw console.log("addToPlaylist.ts Error:",o),new Error(o)}}var qa=require("react/jsx-runtime");function bi({playlists:r,meData:t,uri:n}){let{closeWindowOnAction:s}=(0,ne.getPreferenceValues)();return(0,qa.jsx)(ne.ActionPanel.Submenu,{icon:ne.Icon.List,title:"Add to Playlist",children:r?.filter(o=>o.owner?.id===t?.id).map(o=>(0,qa.jsx)(ne.Action,{title:o.name,onAction:async()=>{try{if(await En({playlistId:o.id,trackUris:[n]}),s){await(0,ne.showHUD)(`Added to ${o.name}`),await(0,ne.popToRoot)();return}await(0,ne.showToast)({title:`Added to ${o.name}`})}catch(c){let u=ut(c);await(0,ne.showToast)({title:"Error adding song to playlist",message:u.message,style:ne.Toast.Style.Failure})}}},o.id))})}var me=require("@raycast/api");var ht=require("react/jsx-runtime");function yi({url:r,uri:t,title:n}){return(0,ht.jsxs)(me.ActionPanel.Section,{children:[(0,ht.jsx)(me.Action.CopyToClipboard,{icon:me.Icon.Link,title:"Copy URL",shortcut:me.Keyboard.Shortcut.Common.CopyDeeplink,content:{html:`<a href="${r}" title="${n}">${n}</a>`,text:r}}),(0,ht.jsx)(me.Action.CopyToClipboard,{icon:me.Icon.CopyClipboard,title:"Copy Artist and Title",shortcut:{macOS:{modifiers:["cmd","shift"],key:"t"},Windows:{modifiers:["ctrl","shift"],key:"t"}},content:n}),On?(0,ht.jsx)(me.Action.Open,{icon:"spotify-icon.svg",title:"Open on Spotify",shortcut:me.Keyboard.Shortcut.Common.Open,target:t||"spotify"}):(0,ht.jsx)(me.Action.OpenInBrowser,{title:"Open on Spotify Web",shortcut:me.Keyboard.Shortcut.Common.Open,url:r||"https://play.spotify.com"})]})}var ce=require("@raycast/api");async function Mt({uri:r}){let{spotifyClient:t}=B();try{return await t.postMePlayerQueue(r)}catch(n){let s=v(n);throw console.log("addToQueue.ts Error:",s),new Error(s)}}var Si=require("react/jsx-runtime");function gi({uri:r,title:t}){let{closeWindowOnAction:n}=(0,ce.getPreferenceValues)();return(0,Si.jsx)(ce.Action,{icon:ce.Icon.Plus,title:"Add to Queue",shortcut:{macOS:{modifiers:["opt"],key:"q"},Windows:{modifiers:["alt"],key:"q"}},onAction:async()=>{try{if(await Mt({uri:r}),n){await(0,ce.showHUD)("Added to queue"),await(0,ce.popToRoot)();return}(0,ce.showToast)({title:"Added to queue",message:t})}catch(s){let o=ut(s);(0,ce.showToast)({title:"Error adding song to queue",message:o.message,style:ce.Toast.Style.Failure})}}})}var X=require("@raycast/api");var wi=require("@raycast/api");function Ze(r){return`
    tell application "Spotify"
      if not application "Spotify" is running then
        activate

        set _maxOpenWaitTimeInSeconds to 5
        set _openCounter to 1
        repeat until application "Spotify" is running
          delay 1
          set _openCounter to _openCounter + 1
          if _openCounter > _maxOpenWaitTimeInSeconds then exit repeat
        end repeat
      end if
      ${r}
    end tell`}async function _i(r){await(0,wi.closeMainWindow)(),await cn(r)}var Rn=class extends Error{constructor(t){super(t),this.name="WinNotSupportedError"}};async function Xe(r,t=!1,n,s){process.platform==="win32"?await Qd(r,n):await Vd(r,t,n,s)}async function Qd(r,t){let n=`
  Add-Type -AssemblyName System.Runtime.WindowsRuntime
$asTaskGeneric = ([System.WindowsRuntimeSystemExtensions].GetMethods() | Where-Object { $_.Name -eq 'AsTask' -and $_.GetParameters().Count -eq 1 -and $_.GetParameters()[0].ParameterType.Name -eq 'IAsyncOperation\`1' })[0]

Function Await($WinRtTask, $ResultType) {
    $asTask = $asTaskGeneric.MakeGenericMethod($ResultType)
    $netTask = $asTask.Invoke($null, @($WinRtTask))
    $netTask.Wait(-1) | Out-Null
    $netTask.Result
}

Function Get-SpotifySession {
    [Windows.Media.Control.GlobalSystemMediaTransportControlsSessionManager,Windows.Media.Control,ContentType=WindowsRuntime] | Out-Null
    $mediaManager = Await ([Windows.Media.Control.GlobalSystemMediaTransportControlsSessionManager]::RequestAsync()) ([Windows.Media.Control.GlobalSystemMediaTransportControlsSessionManager])

    $sessions = $mediaManager.GetSessions()
    $spotifySession = $sessions | Where-Object {
        $_.SourceAppUserModelId -match "Spotify"
    }

    return $spotifySession
}

Function Start-Spotify {
    try {
        Start-Process "spotify:"

        $timeout = 15
        $elapsed = 0
        while ($elapsed -lt $timeout) {
            Start-Sleep -Seconds 1
            $elapsed++

            $session = Get-SpotifySession
            if ($session) {
                return $session
            }
        }

        return $null

    } catch {
        return $null
    }
}

Function Ensure-SpotifyRunning {
    $session = Get-SpotifySession

    if (-not $session) {
        $session = Start-Spotify

        if (-not $session) {
            # One more try after startup
            Start-Sleep -Seconds 2
            $session = Get-SpotifySession
        }
    }

    return $session
}
  `,s=async o=>{let c=`
${n}
$session = Ensure-SpotifyRunning
    if ($session) {
     Await ($session.${o}) ([bool])
  }
    `;await ha(c)};switch(r){case 0:await s("TryPlayAsync()");break;case 1:await s("TryPauseAsync()");break;case 2:await s("TrySkipNextAsync()");break;case 3:await s("TrySkipPreviousAsync()");break;case 4:await ha(`Start-Process "${t}"`);break;case 5:throw new Rn("Setting volume on non premium account is not supported on Windows");case 6:throw new Rn("Setting position on non premium account is not supported on Windows");default:break}}async function Vd(r,t=!1,n,s){let o=async c=>{s&&s>0&&(c=`
      delay ${s}
      ${c}
    `),t?await _i(c):await cn(c)};switch(r){case 0:await o(Ze("play"));break;case 1:await o(Ze("pause"));break;case 2:await o(Ze("next track"));break;case 3:await o(Ze("previous track"));break;case 4:await o(Ze(`play track "${n}"`));break;case 5:await o(Ze(`set sound volume to ${n}`));break;case 6:await o(Ze(`set player position to ${n}`));break;default:break}}async function Oi({trackIds:r,artistIds:t}){let{spotifyClient:n}=B();try{return await n.getRecommendations({seedTracks:r.join(),seedArtists:t?.join()})}catch(s){let o=v(s);throw console.log("getRecommendations.ts Error:",o),new Error(o)}}async function Ma({trackIds:r=[],artistIds:t=[]}={}){let{spotifyClient:n}=B();try{let o=(await Oi({trackIds:r,artistIds:t}))?.tracks;if(o)try{await n.putMePlayerPlay({uris:o.flatMap(c=>c.uri)})}catch(c){let u=v(c);(u?.toLocaleLowerCase().includes("no active device")||u?.toLocaleLowerCase().includes("restricted device")||u?.toLocaleLowerCase().includes("premium required"))&&await Xe(4,!0,o[0].uri)}}catch(s){let o=v(s);throw console.log("startRadio.ts Error:",o),new Error(o)}}var Ri=require("react/jsx-runtime");function Ei({trackId:r,artistId:t,onRadioStarted:n}){let{closeWindowOnAction:s}=(0,X.getPreferenceValues)();return(0,Ri.jsx)(X.Action,{icon:X.Icon.Music,title:"Start Radio",onAction:async()=>{if(s)try{await Ma({trackIds:r?[r]:void 0,artistIds:t?[t]:void 0}),await(0,X.showHUD)("Playing Radio"),await(0,X.popToRoot)();return}catch(c){let u=ut(c);await(0,X.showHUD)(u.message)}let o=await(0,X.showToast)({title:"Starting Radio...",style:X.Toast.Style.Animated});try{await Ma({trackIds:r?[r]:void 0,artistIds:t?[t]:void 0}),n||(o.title="Playing radio",o.style=X.Toast.Style.Success),n&&setTimeout(()=>{n(),o.title="Playing Radio",o.style=X.Toast.Style.Success},300)}catch(c){let u=ut(c);o.title="Error Starting Radio",o.message=u.message,o.style=X.Toast.Style.Failure}}})}var K=require("@raycast/api");async function Ti(){let{spotifyClient:r}=B();try{return await r.getMePlayerDevices()}catch(t){let n=v(t);throw console.log("getMyDevices.ts Error:",n),new Error(n)}}var zt={album:"spotify:album:",artist:"spotify:artist:",playlist:"spotify:playlist:",track:"spotify:track:",show:"spotify:show:",episode:"spotify:episode:"};async function yr({id:r,type:t,contextUri:n}={}){let{spotifyClient:s}=B(),{devices:o}=await Ti(),c=await kn();try{let u=o?.find(f=>f.is_active);if(!u&&c){await Pi({id:r,type:t});return}let m=u?.id??o?.[0]?.id??void 0;!t||!r?await s.putMePlayerPlay({context_uri:n},{deviceId:m}):t==="track"?n?await s.putMePlayerPlay({context_uri:n,offset:{uri:`${zt.track}${r}`}},{deviceId:m}):await s.putMePlayerPlay({uris:[`${zt.track}${r}`]},{deviceId:m}):t==="episode"?await s.putMePlayerPlay({uris:[`${zt.episode}${r}`]},{deviceId:m}):await s.putMePlayerPlay({context_uri:`${zt[t]}${r}`},{deviceId:m})}catch(u){let m=v(u);if(c&&(m?.toLocaleLowerCase().includes("no device found")||m?.toLocaleLowerCase().includes("no active device")||m?.toLocaleLowerCase().includes("restricted device")||m?.toLocaleLowerCase().includes("premium required"))){await Pi({id:r,type:t});return}throw new Error(m)}}async function Pi({id:r,type:t}){try{!t||!r?await Xe(0):t==="track"?await Xe(4,!1,`${zt[t]}${r}`):await Xe(4,!1,`${zt[t]}${r}`,1)}catch(n){let s=v(n);throw new Error(s)}}var xi=require("react/jsx-runtime");function $i({id:r,type:t,playingContext:n,onPlay:s,tracksToQueue:o}){let{closeWindowOnAction:c}=(0,K.getPreferenceValues)(),u=async()=>{try{if(await yr({id:r,type:t,contextUri:n}),c)await(0,K.showHUD)("Playing"),await(0,K.popToRoot)();else{let m=await(0,K.showToast)({title:"Playing...",style:K.Toast.Style.Animated});s&&s(),m.title="Playing",m.style=K.Toast.Style.Success}if(o)for(let m of o)await Mt({uri:m.uri})}catch(m){let f=v(m);c?(await(0,K.showHUD)("Failed to play"),await(0,K.popToRoot)()):await Ct(m,{title:f.toLowerCase().includes("no active device")?"No active device":"Failed to play",primaryAction:{title:"Copy Error",shortcut:{macOS:{modifiers:["cmd"],key:"t"},Windows:{modifiers:["ctrl"],key:"t"}},onAction:async()=>{await K.Clipboard.copy(f)}}})}};return(0,xi.jsx)(K.Action,{icon:K.Icon.Play,title:"Play",onAction:u})}var J=require("@raycast/api");async function za({trackIds:r}){let{spotifyClient:t}=B();try{return await t.putMeTracks(r.join())}catch(n){let s=v(n);throw console.log("addToMySavedTracks.ts Error:",s),new Error(s)}}async function ji({trackIds:r}){let{spotifyClient:t}=B();try{return await t.getMeTracksContains(r.join())}catch(n){let s=v(n);throw console.log("containsMySavedTracks.ts Error:",s),new Error(s)}}function vi({trackIds:r,options:t}){let{data:n,error:s,isLoading:o,revalidate:c}=Ue(u=>ji({trackIds:u}),[r],{execute:t?.execute!==!1&&r.length>0});return{containsMySavedTracksData:n,containsMySavedTracksError:s,containsMySavedTracksIsLoading:o,containsMySavedTracksRevalidate:c}}async function La({trackIds:r}){let{spotifyClient:t}=B();try{return await t.deleteMeTracks(r.join())}catch(n){let s=v(n);throw console.log("removeFromMySavedTracks.ts Error:",s),new Error(s)}}var bt=require("react/jsx-runtime");function Ai({trackId:r}){let{closeWindowOnAction:t}=(0,J.getPreferenceValues)(),{containsMySavedTracksData:n,containsMySavedTracksRevalidate:s}=vi({trackIds:r?[r]:[]}),o=n?.[0];return(0,bt.jsxs)(bt.Fragment,{children:[o&&(0,bt.jsx)(J.Action,{icon:J.Icon.HeartDisabled,title:"Dislike",onAction:async()=>{if(t)try{await La({trackIds:r?[r]:[]}),await(0,J.showHUD)("Disliked"),await(0,J.popToRoot)();return}catch(u){let m=v(u);await(0,J.showHUD)(m)}let c=await(0,J.showToast)({title:"Disliking...",style:J.Toast.Style.Animated});try{await La({trackIds:r?[r]:[]}),await s(),c.title="Disliked",c.style=J.Toast.Style.Success}catch(u){let m=v(u);c.style=J.Toast.Style.Failure,c.title="Something went wrong",c.message=m}}}),!o&&(0,bt.jsx)(J.Action,{icon:J.Icon.Heart,title:"Like",onAction:async()=>{if(t)try{await za({trackIds:r?[r]:[]}),await(0,J.showHUD)("Liked"),await(0,J.popToRoot)();return}catch(u){let m=v(u);await(0,J.showHUD)(m)}let c=await(0,J.showToast)({title:"Liking...",style:J.Toast.Style.Animated});try{await za({trackIds:r?[r]:[]}),await s(),c.title="Liked",c.style=J.Toast.Style.Success}catch(u){let m=v(u);c.style=J.Toast.Style.Failure,c.title="Something went wrong",c.message=m}}})]})}var Ce=require("react/jsx-runtime");function Ci({title:r,track:t,album:n,showAddToSaved:s,showGoToAlbum:o,playingContext:c,tracksToQueue:u}){let{myPlaylistsData:m}=pi(),{meData:f}=hi();return(0,Ce.jsxs)(Lt.ActionPanel,{children:[(0,Ce.jsx)($i,{id:t.id,type:"track",playingContext:c,tracksToQueue:u}),n&&o&&(0,Ce.jsx)(Lt.Action.Push,{icon:Lt.Icon.AppWindowList,title:"Go to Album",target:(0,Ce.jsx)(di,{album:n,showGoToAlbum:!1})}),(0,Ce.jsx)(Ei,{trackId:t.id}),s&&(0,Ce.jsx)(Ai,{trackId:t.id}),t.uri&&(0,Ce.jsx)(gi,{uri:t.uri,title:r}),m?.items&&f&&t.uri&&(0,Ce.jsx)(bi,{playlists:m.items,meData:f,uri:t.uri}),(0,Ce.jsx)(yi,{url:t?.external_urls?.spotify,uri:t.uri,title:r})]})}var Da=require("react/jsx-runtime");function br({track:r,album:t,showAddToSaved:n,showGoToAlbum:s,playingContext:o,tracksToQueue:c}){let u=r.name||"",m=r?.artists?.map(b=>b.name).join(", "),f;return t?.images&&(f={source:t.images[t.images.length-1]?.url}),(0,Da.jsx)(Ii.List.Item,{icon:f,title:u,subtitle:m,accessories:[{text:r.duration_ms?si(r.duration_ms):void 0}],actions:(0,Da.jsx)(Ci,{title:u,track:r,album:t,showAddToSaved:n,showGoToAlbum:s,playingContext:o,tracksToQueue:c})})}async function Ui({name:r,description:t}){let{spotifyClient:n}=B();try{let o=(await n.getMe()).id;if(o)return await n.postUsersByUserIdPlaylists(o,{name:r,description:t})}catch(s){let o=v(s);throw console.log("createPlaylist.ts Error:",o),new Error(o)}}function qi(r){return new Promise(t=>setTimeout(t,r))}async function Mi(){let{spotifyClient:r}=B();try{await r.postMePlayerNext(),await qi(100)}catch(t){let n=v(t);if(n?.toLocaleLowerCase().includes("restricted device")||n?.toLocaleLowerCase().includes("premium required")){await Xe(2);return}throw console.log("skipToNext.ts Error:",n),new Error(n)}}var ue=require("react/jsx-runtime");function zi(r){let{data:t,isLoading:n}=ma(async()=>{let m=(await N.AI.ask(`Generate a playlist of at least 20 songs and no more than 75 songs based strictly on the description "${r.arguments.description}", using ONLY the listed artists if any are explicitly mentioned, but if no artists are listed then infer culturally relevant songs, themes, and sub genres with high specificity, selecting deep and intentional tracks that fit the exact vibe, enforcing smooth energy progression and subgenre consistency, avoiding generic picks, and returning only a fully minified valid JSON object with the following structure:

{
  "name": <Playlist name>,
  "description": <Playlist description>,
  "tracks": [
    {
      "title": <Song title>,
      "artist": <Song's artist>
    },
    ...
  ]
}

If you have listed fewer than 20 songs you must keep adding valid songs until the playlist length is at least 20.

`,{model:N.AI.Model["OpenAI_GPT5-mini"]})).match(/[{\\[]{1}([,:{}\\[\]0-9.\-+Eaeflnr-u \n\r\t]|".*?")+[}\]]{1}/gis)?.[0];if(!m)throw new Error("Invalid result returned from AI");let f=JSON.parse(m),b=await Promise.all(f.tracks.map(async y=>{try{let k=(await ti(`track:${y.title} artist:${y.artist}`,1))?.items?.[0];if(k)return k}catch(_){return console.error(_),null}}));return{name:f.name,description:f.description,tracks:b}},[],{failureToastOptions:{title:"Could not generate playlist",message:"Please try again."}});async function s(){if(t)try{await(0,N.showToast)({style:N.Toast.Style.Animated,title:"Adding playlist to Spotify"});let u=await Ui({name:t.name,description:t.description});if(u?.id){let m=c?.map(f=>f?.uri).filter(Boolean)??[];await En({playlistId:u.id,trackUris:m}),await(0,N.showToast)({style:N.Toast.Style.Success,title:"Added playlist to Spotify",message:`"${t.name}" has been added to your Spotify Library`,primaryAction:{title:`Play "${t.name}"`,onAction:async()=>{await yr({id:u.id,type:"playlist",contextUri:u.uri})}}})}}catch(u){await Ct(u,{title:"Could not add playlist to Spotify"})}}async function o(){if(t)try{await(0,N.showToast)({style:N.Toast.Style.Animated,title:"Adding songs to queue"});for(let u of c??[])!u||!u.uri||await Mt({uri:u?.uri});await(0,N.showToast)({style:N.Toast.Style.Success,title:"Added songs to queue",primaryAction:{title:"Play Next Song in Queue",onAction:async()=>{await Mi(),await yr()}}})}catch(u){await Ct(u,{title:"Could not add songs to queue"})}}let c=[...new Set(t?.tracks)];return(0,ue.jsx)(ai,{children:(0,ue.jsxs)(N.List,{isLoading:n,searchBarPlaceholder:c&&c.length>0?"Search songs":"Generating playlist\u2026",children:[c&&c.length>0?(0,ue.jsxs)(ue.Fragment,{children:[(0,ue.jsx)(N.List.Item,{icon:N.Icon.Stars,title:"Add Playlist to Spotify",actions:(0,ue.jsx)(N.ActionPanel,{children:(0,ue.jsx)(N.Action,{title:"Add to Spotify",onAction:s})})}),(0,ue.jsx)(N.List.Item,{icon:N.Icon.BulletPoints,title:"Add Songs to Queue",actions:(0,ue.jsx)(N.ActionPanel,{children:(0,ue.jsx)(N.Action,{title:"Add Songs",onAction:o})})})]}):null,(0,ue.jsx)(N.List.Section,{title:t?.name,children:c?.map(u=>u?(0,ue.jsx)(br,{track:u,album:u.album,showGoToAlbum:!0},u.id):null)})]})})}
/*! Bundled license information:

fetch-blob/index.js:
  (*! fetch-blob. MIT License. Jimmy Wrting <https://jimmy.warting.se/opensource> *)

formdata-polyfill/esm.min.js:
  (*! formdata-polyfill. MIT License. Jimmy Wrting <https://jimmy.warting.se/opensource> *)

node-domexception/index.js:
  (*! node-domexception. MIT License. Jimmy Wrting <https://jimmy.warting.se/opensource> *)
*/
