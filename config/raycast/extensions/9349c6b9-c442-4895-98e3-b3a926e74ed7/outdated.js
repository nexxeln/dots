"use strict";var Rn=Object.create;var We=Object.defineProperty;var Fn=Object.getOwnPropertyDescriptor;var Un=Object.getOwnPropertyNames;var On=Object.getPrototypeOf,Dn=Object.prototype.hasOwnProperty;var I=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Mn=(t,e)=>{for(var r in e)We(t,r,{get:e[r],enumerable:!0})},Yt=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of Un(e))!Dn.call(t,a)&&a!==r&&We(t,a,{get:()=>e[a],enumerable:!(n=Fn(e,a))||n.enumerable});return t};var v=(t,e,r)=>(r=t!=null?Rn(On(t)):{},Yt(e||!t||!t.__esModule?We(r,"default",{value:t,enumerable:!0}):r,t)),Ln=t=>Yt(We({},"__esModule",{value:!0}),t);var _t=I(Ge=>{"use strict";Object.defineProperty(Ge,"__esModule",{value:!0});Ge.redactString=kt;Ge.sanitizeArgs=aa;function gr(t){return t.replace(/([A-Za-z0-9._%+-])[^@\s]*(@[A-Za-z0-9.-]+\.[A-Za-z]{2,})/g,(e,r,n)=>`${r}***${n}`)}function kt(t){let e=t;return e=e.replace(/bearer\s+[^\s"']+/gi,"Bearer ***"),e=e.replace(/(password|pass|pwd|secret|token|auth|authorization|key)\s*[:=]\s*[^\s&"']+/gi,"$1=***"),e=e.replace(/((?:code|2fa|two[-\s]?factor|otp)\s*[:=\s]+)(\d{4,8})/gi,(r,n)=>`${n}******`),e=e.replace(/[a-f0-9]{32,}/gi,"***"),e=e.replace(/[A-Za-z0-9+/]{20,}={0,2}/g,"***"),e=gr(e),e}function br(t,e){let r=t.toLowerCase();if(e==null)return e;if(typeof e=="string")return["password","pass","pwd","secret","token","auth","authorization","applepassword"].includes(r)?"***":["code","otp","2fa","twofactor","two_factor"].includes(r)?"******":["email","appleid","apple_id","username","user"].includes(r)?gr(e):kt(e);if(typeof e=="number")return["code","otp","2fa"].includes(r)?0:e;if(typeof e=="object")try{let n=JSON.stringify(e,(a,s)=>br(a,s));return JSON.parse(n)}catch{return e}return e}function aa(t){return t.map(e=>{if(typeof e=="string")return kt(e);if(typeof e=="object"&&e!==null)try{let r=JSON.stringify(e,(n,a)=>br(n,a));return JSON.parse(r)}catch{return e}return e})}});var wr=I(Se=>{"use strict";Object.defineProperty(Se,"__esModule",{value:!0});Se.logger=Se.Logger=void 0;var sa=require("@raycast/api"),yr=_t(),Je=class t{constructor(e={}){this.config={isVerboseEnabled:e.isVerboseEnabled||this.defaultVerboseCheck,prefix:e.prefix||"",enableRedaction:e.enableRedaction??!0}}defaultVerboseCheck(){try{return(0,sa.getPreferenceValues)().verboseLogging||!1}catch(e){return console.error("[Logger] Failed to read preferences for verbose logging:",e),!1}}static getInstance(){return t.instance||(t.instance=new t),t.instance}formatMessage(e){return this.config.prefix?`${this.config.prefix} ${e}`:e}processLogData(e,r){let n=this.formatMessage(e);return this.config.enableRedaction?[(0,yr.redactString)(n),(0,yr.sanitizeArgs)(r)]:[n,r]}log(e,...r){if(this.config.isVerboseEnabled()){let[n,a]=this.processLogData(e,r);console.log(n,...a)}}error(e,...r){let[n,a]=this.processLogData(e,r);console.error(n,...a)}warn(e,...r){let[n,a]=this.processLogData(e,r);console.warn(n,...a)}child(e){let r=this.config.prefix?`${this.config.prefix} ${e}`:e;return new t({...this.config,prefix:r})}};Se.Logger=Je;Se.logger=Je.getInstance()});var xt=I(W=>{"use strict";Object.defineProperty(W,"__esModule",{value:!0});W.sanitizeArgs=W.redactString=W.logger=W.Logger=void 0;var kr=wr();Object.defineProperty(W,"Logger",{enumerable:!0,get:function(){return kr.Logger}});Object.defineProperty(W,"logger",{enumerable:!0,get:function(){return kr.logger}});var _r=_t();Object.defineProperty(W,"redactString",{enumerable:!0,get:function(){return _r.redactString}});Object.defineProperty(W,"sanitizeArgs",{enumerable:!0,get:function(){return _r.sanitizeArgs}})});var tt=I((Bs,Er)=>{"use strict";var{Readable:Ns,Writable:Vs,Duplex:ca,Transform:Pr}=require("stream"),la=Symbol.for("object-stream.none"),Ct=Symbol.for("object-stream.final"),At=Symbol.for("object-stream.many"),ua=t=>({[Ct]:t}),fa=t=>({[At]:t}),da=t=>t&&typeof t=="object"&&Ct in t,ha=t=>t&&typeof t=="object"&&At in t,ma=t=>t[Ct],pa=t=>t[At],ga=async(t,e)=>{for(;;){let r=t.next();if(r&&typeof r.then=="function"&&(r=await r),r.done)break;let n=r.value;n&&typeof n.then=="function"&&(n=await n),x.sanitize(n,e)}},ba=t=>new Pr({writableObjectMode:!0,readableObjectMode:!0,transform(e,r,n){try{let a=t.call(this,e,r);if(a&&typeof a.then=="function"){a.then(s=>(x.sanitize(s,this),n(null)),s=>n(s));return}if(a&&typeof a.next=="function"){ga(a,this).then(()=>n(null),s=>n(s));return}x.sanitize(a,this),n(null)}catch(a){n(a)}}}),ya=t=>new Pr({writableObjectMode:!0,readableObjectMode:!0,transform(e,r,n){try{let a=e;for(let s=0;s<t.length;++s){let i=t[s].call(this,a,r);if(i===x.none){n(null);return}if(x.isFinal(i)){a=x.getFinalValue(i);break}a=i}x.sanitize(a,this),n(null)}catch(a){n(a)}}}),Cr=t=>t&&typeof t.pipe=="function"&&typeof t.on=="function"&&(!t._writableState||(typeof t._readableState=="object"?t._readableState.readable:null)!==!1)&&(!t._writableState||t._readableState),Ar=t=>t&&typeof t.write=="function"&&typeof t.on=="function"&&(!t._readableState||(typeof t._writableState=="object"?t._writableState.writable:null)!==!1),wa=t=>t&&typeof t.pipe=="function"&&t._readableState&&typeof t.on=="function"&&typeof t.write=="function",x=class t extends ca{constructor(e,r){if(super(r||{writableObjectMode:!0,readableObjectMode:!0}),!(e instanceof Array)||!e.length)throw Error("Chain's argument should be a non-empty array.");this.streams=e.filter(n=>n).map((n,a,s)=>{if(typeof n=="function"||n instanceof Array)return t.convertToTransform(n);if(wa(n)||!a&&Cr(n)||a===s.length-1&&Ar(n))return n;throw Error("Arguments should be functions, arrays or streams.")}).filter(n=>n),this.input=this.streams[0],this.output=this.streams.reduce((n,a)=>n&&n.pipe(a)||a),Ar(this.input)||(this._write=(n,a,s)=>s(null),this._final=n=>n(null),this.input.on("end",()=>this.end())),Cr(this.output)?(this.output.on("data",n=>!this.push(n)&&this.output.pause()),this.output.on("end",()=>this.push(null))):(this._read=()=>{},this.resume(),this.output.on("finish",()=>this.push(null))),(!r||!r.skipEvents)&&this.streams.forEach(n=>n.on("error",a=>this.emit("error",a)))}_write(e,r,n){let a=null;try{this.input.write(e,r,s=>n(s||a))}catch(s){a=s}}_final(e){let r=null;try{this.input.end(null,null,n=>e(n||r))}catch(n){r=n}}_read(){this.output.resume()}static make(e,r){return new t(e,r)}static sanitize(e,r){t.isFinal(e)?e=t.getFinalValue(e):t.isMany(e)&&(e=t.getManyValues(e)),e!=null&&e!==t.none&&(e instanceof Array?e.forEach(n=>n!=null&&r.push(n)):r.push(e))}static convertToTransform(e){return typeof e=="function"?ba(e):e instanceof Array&&e.length?ya(e):null}};x.none=la;x.final=ua;x.isFinal=da;x.getFinalValue=ma;x.many=fa;x.isMany=ha;x.getManyValues=pa;x.chain=x.make;x.make.Constructor=x;Er.exports=x});var Ir=I((js,Tr)=>{"use strict";var{Transform:ka}=require("stream"),{StringDecoder:_a}=require("string_decoder"),Pt=class extends ka{constructor(e){super(Object.assign({},e,{writableObjectMode:!1})),this._buffer=""}_transform(e,r,n){typeof e=="string"?this._transform=this._transformString:(this._stringDecoder=new _a,this._transform=this._transformBuffer),this._transform(e,r,n)}_transformBuffer(e,r,n){this._buffer+=this._stringDecoder.write(e),this._processBuffer(n)}_transformString(e,r,n){this._buffer+=e.toString(),this._processBuffer(n)}_processBuffer(e){this._buffer&&(this.push(this._buffer,"utf8"),this._buffer=""),e(null)}_flushInput(){this._stringDecoder&&(this._buffer+=this._stringDecoder.end())}_flush(e){this._flushInput(),this._processBuffer(e)}};Tr.exports=Pt});var Et=I((Ws,Rr)=>{"use strict";var xa=Ir(),u={value1:/^(?:[\"\{\[\]\-\d]|true\b|false\b|null\b|\s{1,256})/,string:/^(?:[^\x00-\x1f\"\\]{1,256}|\\[bfnrt\"\\\/]|\\u[\da-fA-F]{4}|\")/,key1:/^(?:[\"\}]|\s{1,256})/,colon:/^(?:\:|\s{1,256})/,comma:/^(?:[\,\]\}]|\s{1,256})/,ws:/^\s{1,256}/,numberStart:/^\d/,numberDigit:/^\d{0,256}/,numberFraction:/^[\.eE]/,numberExponent:/^[eE]/,numberExpSign:/^[-+]/},$a=16,A=!0;try{new RegExp(".","y"),A=!1}catch{}!A&&Object.keys(u).forEach(t=>{let e=u[t].source.slice(1);e.slice(0,3)==="(?:"&&e.slice(-1)===")"&&(e=e.slice(3,-1)),u[t]=new RegExp(e,"y")});u.numberFracStart=u.numberExpStart=u.numberStart;u.numberFracDigit=u.numberExpDigit=u.numberDigit;var Sa={true:!0,false:!1,null:null},K={object:"objectStop",array:"arrayStop","":"done"},va=t=>String.fromCharCode(parseInt(t.slice(2),16)),Ca={b:"\b",f:"\f",n:`
`,r:"\r",t:"	",'"':'"',"\\":"\\","/":"/"},de=class t extends xa{static make(e){return new t(e)}constructor(e){super(Object.assign({},e,{readableObjectMode:!0})),this._packKeys=this._packStrings=this._packNumbers=this._streamKeys=this._streamStrings=this._streamNumbers=!0,e&&("packValues"in e&&(this._packKeys=this._packStrings=this._packNumbers=e.packValues),"packKeys"in e&&(this._packKeys=e.packKeys),"packStrings"in e&&(this._packStrings=e.packStrings),"packNumbers"in e&&(this._packNumbers=e.packNumbers),"streamValues"in e&&(this._streamKeys=this._streamStrings=this._streamNumbers=e.streamValues),"streamKeys"in e&&(this._streamKeys=e.streamKeys),"streamStrings"in e&&(this._streamStrings=e.streamStrings),"streamNumbers"in e&&(this._streamNumbers=e.streamNumbers),this._jsonStreaming=e.jsonStreaming),!this._packKeys&&(this._streamKeys=!0),!this._packStrings&&(this._streamStrings=!0),!this._packNumbers&&(this._streamNumbers=!0),this._done=!1,this._expect=this._jsonStreaming?"done":"value",this._stack=[],this._parent="",this._open_number=!1,this._accumulator=""}_flush(e){this._done=!0,super._flush(r=>{if(r)return e(r);this._open_number&&(this._streamNumbers&&this.push({name:"endNumber"}),this._open_number=!1,this._packNumbers&&(this.push({name:"numberValue",value:this._accumulator}),this._accumulator="")),e(null)})}_processBuffer(e){let r,n,a=0;e:for(;;)switch(this._expect){case"value1":case"value":if(u.value1.lastIndex=a,r=u.value1.exec(this._buffer),!r){if(this._done||a+$a<this._buffer.length)return a<this._buffer.length?e(new Error("Parser cannot parse input: expected a value")):e(new Error("Parser has expected a value"));break e}switch(n=r[0],n){case'"':this._streamStrings&&this.push({name:"startString"}),this._expect="string";break;case"{":this.push({name:"startObject"}),this._stack.push(this._parent),this._parent="object",this._expect="key1";break;case"[":this.push({name:"startArray"}),this._stack.push(this._parent),this._parent="array",this._expect="value1";break;case"]":if(this._expect!=="value1")return e(new Error("Parser cannot parse input: unexpected token ']'"));this._open_number&&(this._streamNumbers&&this.push({name:"endNumber"}),this._open_number=!1,this._packNumbers&&(this.push({name:"numberValue",value:this._accumulator}),this._accumulator="")),this.push({name:"endArray"}),this._parent=this._stack.pop(),this._expect=K[this._parent];break;case"-":this._open_number=!0,this._streamNumbers&&(this.push({name:"startNumber"}),this.push({name:"numberChunk",value:"-"})),this._packNumbers&&(this._accumulator="-"),this._expect="numberStart";break;case"0":this._open_number=!0,this._streamNumbers&&(this.push({name:"startNumber"}),this.push({name:"numberChunk",value:"0"})),this._packNumbers&&(this._accumulator="0"),this._expect="numberFraction";break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":this._open_number=!0,this._streamNumbers&&(this.push({name:"startNumber"}),this.push({name:"numberChunk",value:n})),this._packNumbers&&(this._accumulator=n),this._expect="numberDigit";break;case"true":case"false":case"null":if(this._buffer.length-a===n.length&&!this._done)break e;this.push({name:n+"Value",value:Sa[n]}),this._expect=K[this._parent];break}A?this._buffer=this._buffer.slice(n.length):a+=n.length;break;case"keyVal":case"string":if(u.string.lastIndex=a,r=u.string.exec(this._buffer),!r){if(a<this._buffer.length&&(this._done||this._buffer.length-a>=6))return e(new Error("Parser cannot parse input: escaped characters"));if(this._done)return e(new Error("Parser has expected a string value"));break e}if(n=r[0],n==='"')this._expect==="keyVal"?(this._streamKeys&&this.push({name:"endKey"}),this._packKeys&&(this.push({name:"keyValue",value:this._accumulator}),this._accumulator=""),this._expect="colon"):(this._streamStrings&&this.push({name:"endString"}),this._packStrings&&(this.push({name:"stringValue",value:this._accumulator}),this._accumulator=""),this._expect=K[this._parent]);else if(n.length>1&&n.charAt(0)==="\\"){let s=n.length==2?Ca[n.charAt(1)]:va(n);(this._expect==="keyVal"?this._streamKeys:this._streamStrings)&&this.push({name:"stringChunk",value:s}),(this._expect==="keyVal"?this._packKeys:this._packStrings)&&(this._accumulator+=s)}else(this._expect==="keyVal"?this._streamKeys:this._streamStrings)&&this.push({name:"stringChunk",value:n}),(this._expect==="keyVal"?this._packKeys:this._packStrings)&&(this._accumulator+=n);A?this._buffer=this._buffer.slice(n.length):a+=n.length;break;case"key1":case"key":if(u.key1.lastIndex=a,r=u.key1.exec(this._buffer),!r){if(a<this._buffer.length||this._done)return e(new Error("Parser cannot parse input: expected an object key"));break e}if(n=r[0],n==='"')this._streamKeys&&this.push({name:"startKey"}),this._expect="keyVal";else if(n==="}"){if(this._expect!=="key1")return e(new Error("Parser cannot parse input: unexpected token '}'"));this.push({name:"endObject"}),this._parent=this._stack.pop(),this._expect=K[this._parent]}A?this._buffer=this._buffer.slice(n.length):a+=n.length;break;case"colon":if(u.colon.lastIndex=a,r=u.colon.exec(this._buffer),!r){if(a<this._buffer.length||this._done)return e(new Error("Parser cannot parse input: expected ':'"));break e}n=r[0],n===":"&&(this._expect="value"),A?this._buffer=this._buffer.slice(n.length):a+=n.length;break;case"arrayStop":case"objectStop":if(u.comma.lastIndex=a,r=u.comma.exec(this._buffer),!r){if(a<this._buffer.length||this._done)return e(new Error("Parser cannot parse input: expected ','"));break e}if(this._open_number&&(this._streamNumbers&&this.push({name:"endNumber"}),this._open_number=!1,this._packNumbers&&(this.push({name:"numberValue",value:this._accumulator}),this._accumulator="")),n=r[0],n===",")this._expect=this._expect==="arrayStop"?"value":"key";else if(n==="}"||n==="]"){if(n==="}"?this._expect==="arrayStop":this._expect!=="arrayStop")return e(new Error("Parser cannot parse input: expected '"+(this._expect==="arrayStop"?"]":"}")+"'"));this.push({name:n==="}"?"endObject":"endArray"}),this._parent=this._stack.pop(),this._expect=K[this._parent]}A?this._buffer=this._buffer.slice(n.length):a+=n.length;break;case"numberStart":if(u.numberStart.lastIndex=a,r=u.numberStart.exec(this._buffer),!r){if(a<this._buffer.length||this._done)return e(new Error("Parser cannot parse input: expected a starting digit"));break e}n=r[0],this._streamNumbers&&this.push({name:"numberChunk",value:n}),this._packNumbers&&(this._accumulator+=n),this._expect=n==="0"?"numberFraction":"numberDigit",A?this._buffer=this._buffer.slice(n.length):a+=n.length;break;case"numberDigit":if(u.numberDigit.lastIndex=a,r=u.numberDigit.exec(this._buffer),!r){if(a<this._buffer.length||this._done)return e(new Error("Parser cannot parse input: expected a digit"));break e}if(n=r[0],n)this._streamNumbers&&this.push({name:"numberChunk",value:n}),this._packNumbers&&(this._accumulator+=n),A?this._buffer=this._buffer.slice(n.length):a+=n.length;else{if(a<this._buffer.length){this._expect="numberFraction";break}if(this._done){this._expect=K[this._parent];break}break e}break;case"numberFraction":if(u.numberFraction.lastIndex=a,r=u.numberFraction.exec(this._buffer),!r){if(a<this._buffer.length||this._done){this._expect=K[this._parent];break}break e}n=r[0],this._streamNumbers&&this.push({name:"numberChunk",value:n}),this._packNumbers&&(this._accumulator+=n),this._expect=n==="."?"numberFracStart":"numberExpSign",A?this._buffer=this._buffer.slice(n.length):a+=n.length;break;case"numberFracStart":if(u.numberFracStart.lastIndex=a,r=u.numberFracStart.exec(this._buffer),!r){if(a<this._buffer.length||this._done)return e(new Error("Parser cannot parse input: expected a fractional part of a number"));break e}n=r[0],this._streamNumbers&&this.push({name:"numberChunk",value:n}),this._packNumbers&&(this._accumulator+=n),this._expect="numberFracDigit",A?this._buffer=this._buffer.slice(n.length):a+=n.length;break;case"numberFracDigit":if(u.numberFracDigit.lastIndex=a,r=u.numberFracDigit.exec(this._buffer),n=r[0],n)this._streamNumbers&&this.push({name:"numberChunk",value:n}),this._packNumbers&&(this._accumulator+=n),A?this._buffer=this._buffer.slice(n.length):a+=n.length;else{if(a<this._buffer.length){this._expect="numberExponent";break}if(this._done){this._expect=K[this._parent];break}break e}break;case"numberExponent":if(u.numberExponent.lastIndex=a,r=u.numberExponent.exec(this._buffer),!r){if(a<this._buffer.length){this._expect=K[this._parent];break}if(this._done){this._expect="done";break}break e}n=r[0],this._streamNumbers&&this.push({name:"numberChunk",value:n}),this._packNumbers&&(this._accumulator+=n),this._expect="numberExpSign",A?this._buffer=this._buffer.slice(n.length):a+=n.length;break;case"numberExpSign":if(u.numberExpSign.lastIndex=a,r=u.numberExpSign.exec(this._buffer),!r){if(a<this._buffer.length){this._expect="numberExpStart";break}if(this._done)return e(new Error("Parser has expected an exponent value of a number"));break e}n=r[0],this._streamNumbers&&this.push({name:"numberChunk",value:n}),this._packNumbers&&(this._accumulator+=n),this._expect="numberExpStart",A?this._buffer=this._buffer.slice(n.length):a+=n.length;break;case"numberExpStart":if(u.numberExpStart.lastIndex=a,r=u.numberExpStart.exec(this._buffer),!r){if(a<this._buffer.length||this._done)return e(new Error("Parser cannot parse input: expected an exponent part of a number"));break e}n=r[0],this._streamNumbers&&this.push({name:"numberChunk",value:n}),this._packNumbers&&(this._accumulator+=n),this._expect="numberExpDigit",A?this._buffer=this._buffer.slice(n.length):a+=n.length;break;case"numberExpDigit":if(u.numberExpDigit.lastIndex=a,r=u.numberExpDigit.exec(this._buffer),n=r[0],n)this._streamNumbers&&this.push({name:"numberChunk",value:n}),this._packNumbers&&(this._accumulator+=n),A?this._buffer=this._buffer.slice(n.length):a+=n.length;else{if(a<this._buffer.length||this._done){this._expect=K[this._parent];break}break e}break;case"done":if(u.ws.lastIndex=a,r=u.ws.exec(this._buffer),!r){if(a<this._buffer.length){if(this._jsonStreaming){this._expect="value";break}return e(new Error("Parser cannot parse input: unexpected characters"))}break e}n=r[0],this._open_number&&(this._streamNumbers&&this.push({name:"endNumber"}),this._open_number=!1,this._packNumbers&&(this.push({name:"numberValue",value:this._accumulator}),this._accumulator="")),A?this._buffer=this._buffer.slice(n.length):a+=n.length;break}!A&&(this._buffer=this._buffer.slice(a)),e(null)}};de.parser=de.make;de.make.Constructor=de;Rr.exports=de});var Ur=I((zs,Fr)=>{"use strict";var Aa=t=>t.on("data",e=>t.emit(e.name,e.value));Fr.exports=Aa});var Rt=I((Hs,Or)=>{"use strict";var Tt=Et(),Pa=Ur(),It=t=>Pa(new Tt(t));It.Parser=Tt;It.parser=Tt.parser;Or.exports=It});var Ot=I((Ks,Dr)=>{"use strict";var{Transform:Ea}=require("stream"),q=class t extends Ea{static stringFilter(e,r){return n=>{let a=n.join(r);return a.length===e.length&&a===e||a.length>e.length&&a.substr(0,e.length)===e&&a.substr(e.length,r.length)===r}}static regExpFilter(e,r){return n=>e.test(n.join(r))}static arrayReplacement(e){return()=>e}constructor(e){super(Object.assign({},e,{writableObjectMode:!0,readableObjectMode:!0})),this._transform=this._check,this._stack=[];let r=e&&e.filter,n=e&&e.pathSeparator||".";typeof r=="string"?this._filter=t.stringFilter(r,n):typeof r=="function"?this._filter=r:r instanceof RegExp&&(this._filter=t.regExpFilter(r,n));let a=e&&e.replacement;typeof a=="function"?this._replacement=a:this._replacement=t.arrayReplacement(a||t.defaultReplacement),this._allowEmptyReplacement=e&&e.allowEmptyReplacement,this._streamKeys=!0,e&&("streamValues"in e&&(this._streamKeys=e.streamValues),"streamKeys"in e&&(this._streamKeys=e.streamKeys)),this._once=e&&e.once,this._previousToken=""}_check(e,r,n){switch(e.name){case"startObject":case"startArray":case"startString":case"startNumber":case"nullValue":case"trueValue":case"falseValue":typeof this._stack[this._stack.length-1]=="number"&&++this._stack[this._stack.length-1];break;case"keyValue":this._stack[this._stack.length-1]=e.value;break;case"numberValue":this._previousToken!=="endNumber"&&typeof this._stack[this._stack.length-1]=="number"&&++this._stack[this._stack.length-1];break;case"stringValue":this._previousToken!=="endString"&&typeof this._stack[this._stack.length-1]=="number"&&++this._stack[this._stack.length-1];break}if(this._previousToken=e.name,this._checkChunk(e))return n(null);switch(e.name){case"startObject":this._stack.push(null);break;case"startArray":this._stack.push(-1);break;case"endObject":case"endArray":this._stack.pop();break}n(null)}_passObject(e,r,n){switch(this.push(e),e.name){case"startObject":case"startArray":++this._depth;break;case"endObject":case"endArray":--this._depth;break}this._depth||(this._transform=this._once?this._skip:this._check),n(null)}_pass(e,r,n){this.push(e),n(null)}_skipObject(e,r,n){switch(e.name){case"startObject":case"startArray":++this._depth;break;case"endObject":case"endArray":--this._depth;break}this._depth||(this._transform=this._once?this._pass:this._check),n(null)}_skip(e,r,n){n(null)}};q.defaultReplacement=[{name:"nullValue",value:null}];var Ft=(t,e)=>function(r,n,a){if(this._expected){let s=this._expected;if(this._expected="",this._transform=this._once?this._skip:this._check,s===r.name)this.push(r);else return this._transform(r,n,a)}else this.push(r),r.name===t&&(this._expected=e);a(null)};q.prototype._passNumber=Ft("endNumber","numberValue");q.prototype._passString=Ft("endString","stringValue");q.prototype._passKey=Ft("endKey","keyValue");var Ut=(t,e)=>function(r,n,a){if(this._expected){let s=this._expected;if(this._expected="",this._transform=this._once?this._pass:this._check,s!==r.name)return this._transform(r,n,a)}else r.name===t&&(this._expected=e);a(null)};q.prototype._skipNumber=Ut("endNumber","numberValue");q.prototype._skipString=Ut("endString","stringValue");q.prototype._skipKey=Ut("endKey","keyValue");Dr.exports=q});var Me=I((qs,Mr)=>{"use strict";var{chain:Ta}=tt(),Ia=Et(),Ra=(t,e)=>Ta([new Ia(e),t(e)],Object.assign({},e,{writableObjectMode:!1,readableObjectMode:!0}));Mr.exports=Ra});var Nr=I((Gs,Lr)=>{"use strict";var Fa=Ot(),Ua=Me(),he=class t extends Fa{static make(e){return new t(e)}static withParser(e){return Ua(t.make,e)}constructor(e){super(e),this._once=!1,this._lastStack=[]}_flush(e){this._syncStack(),e(null)}_checkChunk(e){switch(e.name){case"startObject":this._filter(this._stack,e)&&(this._syncStack(),this.push(e),this._lastStack.push(null));break;case"startArray":this._filter(this._stack,e)&&(this._syncStack(),this.push(e),this._lastStack.push(-1));break;case"nullValue":case"trueValue":case"falseValue":case"stringValue":case"numberValue":this._filter(this._stack,e)&&(this._syncStack(),this.push(e));break;case"startString":this._filter(this._stack,e)?(this._syncStack(),this.push(e),this._transform=this._passString):this._transform=this._skipString;break;case"startNumber":this._filter(this._stack,e)?(this._syncStack(),this.push(e),this._transform=this._passNumber):this._transform=this._skipNumber;break}return!1}_syncStack(){let e=this._stack,r=this._lastStack,n=e.length,a=r.length,s=0;for(let i=Math.min(n,a);s<i&&e[s]===r[s];++s);for(let i=a-1;i>s;--i)this.push({name:typeof r[i]=="number"?"endArray":"endObject"});if(s<a)if(s<n){if(typeof e[s]=="string"){let i=e[s];this._streamKeys&&(this.push({name:"startKey"}),this.push({name:"stringChunk",value:i}),this.push({name:"endKey"})),this.push({name:"keyValue",value:i})}++s}else this.push({name:typeof r[s]=="number"?"endArray":"endObject"});for(let i=s;i<n;++i){let o=e[i];typeof o=="number"?o>=0&&this.push({name:"startArray"}):typeof o=="string"&&(this.push({name:"startObject"}),this._streamKeys&&(this.push({name:"startKey"}),this.push({name:"stringChunk",value:o}),this.push({name:"endKey"})),this.push({name:"keyValue",value:o}))}this._lastStack=Array.prototype.concat.call(e)}};he.filter=he.make;he.make.Constructor=he;Lr.exports=he});var jr=I((Js,Br)=>{"use strict";var Oa=require("events"),Vr=t=>function(){this.done?this.done=!1:this.stack.push(this.current,this.key),this.current=new t,this.key=null},J=class t extends Oa{static connectTo(e,r){return new t(r).connectTo(e)}constructor(e){super(),this.stack=[],this.current=this.key=null,this.done=!0,e&&(this.reviver=typeof e.reviver=="function"&&e.reviver,this.reviver&&(this.stringValue=this._saveValue=this._saveValueWithReviver),e.numberAsString&&(this.numberValue=this.stringValue))}connectTo(e){return e.on("data",r=>{this[r.name]&&(this[r.name](r.value),this.done&&this.emit("done",this))}),this}get depth(){return(this.stack.length>>1)+(this.done?0:1)}get path(){let e=[];for(let r=0;r<this.stack.length;r+=2){let n=this.stack[r+1];e.push(n===null?this.stack[r].length:n)}return e}dropToLevel(e){if(e<this.depth)if(e){let r=e-1<<1;this.current=this.stack[r],this.key=this.stack[r+1],this.stack.splice(r)}else this.stack=[],this.current=this.key=null,this.done=!0;return this}consume(e){return this[e.name]&&this[e.name](e.value),this}keyValue(e){this.key=e}numberValue(e){this._saveValue(parseFloat(e))}nullValue(){this._saveValue(null)}trueValue(){this._saveValue(!0)}falseValue(){this._saveValue(!1)}endObject(){if(this.stack.length){let e=this.current;this.key=this.stack.pop(),this.current=this.stack.pop(),this._saveValue(e)}else this.done=!0}_saveValue(e){this.done?this.current=e:this.current instanceof Array?this.current.push(e):(this.current[this.key]=e,this.key=null)}_saveValueWithReviver(e){this.done?this.current=this.reviver("",e):this.current instanceof Array?(e=this.reviver(""+this.current.length,e),this.current.push(e),e===void 0&&delete this.current[this.current.length-1]):(e=this.reviver(this.key,e),e!==void 0&&(this.current[this.key]=e),this.key=null)}};J.prototype.stringValue=J.prototype._saveValue;J.prototype.startObject=Vr(Object);J.prototype.startArray=Vr(Array);J.prototype.endArray=J.prototype.endObject;Br.exports=J});var Lt=I((Zs,Wr)=>{"use strict";var{Transform:Da}=require("stream"),Ma=jr(),Dt=class{constructor(e){this.depth=e}startObject(){++this.depth}endObject(){--this.depth}startArray(){++this.depth}endArray(){--this.depth}},Mt=class extends Da{constructor(e){super(Object.assign({},e,{writableObjectMode:!0,readableObjectMode:!0})),e&&(this.objectFilter=e.objectFilter,this.includeUndecided=e.includeUndecided),typeof this.objectFilter!="function"&&(this._filter=this._transform),this._transform=this._wait||this._filter,this._assembler=new Ma(e)}_transform(e,r,n){this._assembler[e.name]&&(this._assembler[e.name](e.value),this._assembler.depth===this._level&&this._push()),n(null)}_filter(e,r,n){if(this._assembler[e.name]){this._assembler[e.name](e.value);let a=this.objectFilter(this._assembler);if(a)return this._assembler.depth===this._level&&(this._push(),this._transform=this._filter),this._transform=this._accept,n(null);if(a===!1)return this._saved_assembler=this._assembler,this._assembler=new Dt(this._saved_assembler.depth),this._saved_assembler.dropToLevel(this._level),this._assembler.depth===this._level&&(this._assembler=this._saved_assembler,this._transform=this._filter),this._transform=this._reject,n(null);this._assembler.depth===this._level&&this._push(!this.includeUndecided)}n(null)}_accept(e,r,n){this._assembler[e.name]&&(this._assembler[e.name](e.value),this._assembler.depth===this._level&&(this._push(),this._transform=this._filter)),n(null)}_reject(e,r,n){this._assembler[e.name]&&(this._assembler[e.name](e.value),this._assembler.depth===this._level&&(this._assembler=this._saved_assembler,this._transform=this._filter)),n(null)}};Wr.exports=Mt});var Hr=I((Ys,zr)=>{"use strict";var La=Lt(),Na=Me(),me=class t extends La{static make(e){return new t(e)}static withParser(e){return Na(t.make,e)}constructor(e){super(e),this._level=1,this._counter=0}_wait(e,r,n){return e.name!=="startArray"?n(new Error("Top-level object should be an array.")):(this._transform=this._filter,this._transform(e,r,n))}_push(e){this._assembler.current.length&&(e?(++this._counter,this._assembler.current.pop()):this.push({key:this._counter++,value:this._assembler.current.pop()}))}};me.streamArray=me.make;me.make.Constructor=me;zr.exports=me});var cn=I(($i,on)=>{"use strict";var Ga=Ot(),Ja=Me(),ge=class t extends Ga{static make(e){return new t(e)}static withParser(e){return Ja(t.make,e)}_checkChunk(e){switch(e.name){case"startObject":case"startArray":if(this._filter(this._stack,e))return this.push(e),this._transform=this._passObject,this._depth=1,!0;break;case"startString":if(this._filter(this._stack,e))return this.push(e),this._transform=this._passString,!0;break;case"startNumber":if(this._filter(this._stack,e))return this.push(e),this._transform=this._passNumber,!0;break;case"nullValue":case"trueValue":case"falseValue":case"stringValue":case"numberValue":if(this._filter(this._stack,e))return this.push(e),this._transform=this._once?this._skip:this._check,!0;break}return!1}};ge.pick=ge.make;ge.make.Constructor=ge;on.exports=ge});var un=I((Si,ln)=>{"use strict";var Za=Lt(),Ya=Me(),be=class t extends Za{static make(e){return new t(e)}static withParser(e){return Ya(t.make,e)}constructor(e){super(e),this._level=1,this._lastKey=null}_wait(e,r,n){return e.name!=="startObject"?n(new Error("Top-level object should be an object.")):(this._transform=this._filter,this._transform(e,r,n))}_push(e){this._lastKey===null?this._lastKey=this._assembler.key:(!e&&this.push({key:this._lastKey,value:this._assembler.current[this._lastKey]}),this._assembler.current={},this._lastKey=null)}};be.streamObject=be.make;be.make.Constructor=be;ln.exports=be});var Ps={};Mn(Ps,{default:()=>Pn});module.exports=Ln(Ps);var An=require("react"),R=require("@raycast/api");var h=v(require("react")),g=require("@raycast/api");var Xt=Object.prototype.hasOwnProperty;function ze(t,e){var r,n;if(t===e)return!0;if(t&&e&&(r=t.constructor)===e.constructor){if(r===Date)return t.getTime()===e.getTime();if(r===RegExp)return t.toString()===e.toString();if(r===Array){if((n=t.length)===e.length)for(;n--&&ze(t[n],e[n]););return n===-1}if(!r||typeof t=="object"){n=0;for(r in t)if(Xt.call(t,r)&&++n&&!Xt.call(e,r)||!(r in e)||!ze(t[r],e[r]))return!1;return Object.keys(e).length===n}}return t!==t&&e!==e}var le=v(require("node:fs")),Ke=v(require("node:path")),or=v(require("node:crypto")),cr=v(require("node:child_process")),lr=require("node:buffer"),$e=v(require("node:stream")),ur=require("node:util");var fr=require("react/jsx-runtime");var ht=globalThis;function Nn(t){let e=(0,h.useRef)(t),r=(0,h.useRef)(0);return ze(t,e.current)||(e.current=t,r.current+=1),(0,h.useMemo)(()=>e.current,[r.current])}function B(t){let e=(0,h.useRef)(t);return e.current=t,e}function Vn(t,e){let r=t instanceof Error?t.message:String(t);return(0,g.showToast)({style:g.Toast.Style.Failure,title:e?.title??"Something went wrong",message:e?.message??r,primaryAction:e?.primaryAction??Qt(t),secondaryAction:e?.primaryAction?Qt(t):void 0})}var Qt=t=>{let e=!0,r="[Extension Name]...",n="";try{let i=JSON.parse((0,le.readFileSync)((0,Ke.join)(g.environment.assetsPath,"..","package.json"),"utf8"));r=`[${i.title}]...`,n=`https://raycast.com/${i.owner||i.author}/${i.name}`,(!i.owner||i.access==="public")&&(e=!1)}catch{}let a=g.environment.isDevelopment||e,s=t instanceof Error?t?.stack||t?.message||"":String(t);return{title:a?"Copy Logs":"Report Error",onAction(i){i.hide(),a?g.Clipboard.copy(s):(0,g.open)(`https://github.com/raycast/extensions/issues/new?&labels=extension%2Cbug&template=extension_bug_report.yml&title=${encodeURIComponent(r)}&extension-url=${encodeURI(n)}&description=${encodeURIComponent(`#### Error:
\`\`\`
${s}
\`\`\`
`)}`)}}};function Bn(t,e,r){let n=(0,h.useRef)(0),[a,s]=(0,h.useState)({isLoading:!0}),i=B(t),o=B(r?.abortable),c=B(e||[]),f=B(r?.onError),l=B(r?.onData),m=B(r?.onWillExecute),P=B(r?.failureToastOptions),V=B(a.data),U=(0,h.useRef)(null),d=(0,h.useRef)({page:0}),C=(0,h.useRef)(!1),E=(0,h.useRef)(!0),G=(0,h.useRef)(50),T=(0,h.useCallback)(()=>(o.current&&(o.current.current?.abort(),o.current.current=new AbortController),++n.current),[o]),w=(0,h.useCallback)((...ee)=>{let M=T();m.current?.(ee),s(y=>({...y,isLoading:!0}));let ke=jn(i.current)(...ee);function _e(y){return y.name=="AbortError"||M===n.current&&(f.current?f.current(y):g.environment.launchType!==g.LaunchType.Background&&Vn(y,{title:"Failed to fetch latest data",primaryAction:{title:"Retry",onAction(ce){ce.hide(),U.current?.(...c.current||[])}},...P.current}),s({error:y,isLoading:!1})),y}return typeof ke=="function"?(C.current=!0,ke(d.current).then(({data:y,hasMore:ce,cursor:Tn})=>(M===n.current&&(d.current&&(d.current.cursor=Tn,d.current.lastItem=y?.[y.length-1]),l.current&&l.current(y,d.current),ce&&(G.current=y.length),E.current=ce,s(In=>d.current.page===0?{data:y,isLoading:!1}:{data:(In.data||[])?.concat(y),isLoading:!1})),y),y=>(E.current=!1,_e(y)))):(C.current=!1,ke.then(y=>(M===n.current&&(l.current&&l.current(y),s({data:y,isLoading:!1})),y),_e))},[l,f,c,i,s,U,m,d,P,T]);U.current=w;let b=(0,h.useCallback)(()=>{d.current={page:0};let ee=c.current||[];return w(...ee)},[w,c]),$=(0,h.useCallback)(async(ee,M)=>{let ke;try{if(M?.optimisticUpdate){T(),typeof M?.rollbackOnError!="function"&&M?.rollbackOnError!==!1&&(ke=structuredClone(V.current?.value));let _e=M.optimisticUpdate;s(y=>({...y,data:_e(y.data)}))}return await ee}catch(_e){if(typeof M?.rollbackOnError=="function"){let y=M.rollbackOnError;s(ce=>({...ce,data:y(ce.data)}))}else M?.optimisticUpdate&&M?.rollbackOnError!==!1&&s(y=>({...y,data:ke}));throw _e}finally{M?.shouldRevalidateAfter!==!1&&(g.environment.launchType===g.LaunchType.Background||g.environment.commandMode==="menu-bar"?await b():b())}},[b,V,s,T]),j=(0,h.useCallback)(()=>{d.current.page+=1;let ee=c.current||[];w(...ee)},[d,c,w]);(0,h.useEffect)(()=>{d.current={page:0},r?.execute!==!1?w(...e||[]):T()},[Nn([e,r?.execute,w]),o,d]),(0,h.useEffect)(()=>()=>{T()},[T]);let Fe=r?.execute!==!1?a.isLoading:!1,Q={...a,isLoading:Fe},En=C.current?{pageSize:G.current,hasMore:E.current,onLoadMore:j}:void 0;return{...Q,revalidate:b,mutate:$,pagination:En}}function jn(t){return t===Promise.all||t===Promise.race||t===Promise.resolve||t===Promise.reject?t.bind(Promise):t}function er(t){return typeof t!="function"?!1:/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(t))!==null}function Wn(t){return t instanceof URLSearchParams?t.toString():t}function dr(t,e=[]){function r(n){return"update"in t?t.update(n,"utf8"):t.write(n)}return{dispatch:function(n){n=Wn(n),n===null?this._null():this["_"+typeof n](n)},_object:function(n){let a=/\[object (.*)\]/i,s=Object.prototype.toString.call(n),i=a.exec(s)?.[1]??"unknown:["+s+"]";i=i.toLowerCase();let o=null;if((o=e.indexOf(n))>=0){this.dispatch("[CIRCULAR:"+o+"]");return}else e.push(n);if(Buffer.isBuffer(n))return r("buffer:"),r(n.toString("utf8"));if(i!=="object"&&i!=="function"&&i!=="asyncfunction")if(this["_"+i])this["_"+i](n);else throw new Error('Unknown object type "'+i+'"');else{let c=Object.keys(n);c=c.sort(),er(n)||c.splice(0,0,"prototype","__proto__","constructor"),r("object:"+c.length+":");let f=this;return c.forEach(function(l){f.dispatch(l),r(":"),f.dispatch(n[l]),r(",")})}},_array:function(n,a){a=typeof a<"u"?a:!1;let s=this;if(r("array:"+n.length+":"),!a||n.length<=1){n.forEach(function(c){s.dispatch(c)});return}let i=[],o=n.map(function(c){let f=zn(),l=e.slice();return dr(f,l).dispatch(c),i=i.concat(l.slice(e.length)),f.read().toString()});e=e.concat(i),o.sort(),this._array(o,!1)},_date:function(n){r("date:"+n.toJSON())},_symbol:function(n){r("symbol:"+n.toString())},_error:function(n){r("error:"+n.toString())},_boolean:function(n){r("bool:"+n.toString())},_string:function(n){r("string:"+n.length+":"),r(n.toString())},_function:function(n){r("fn:"),er(n)?this.dispatch("[native]"):this.dispatch(n.toString()),this.dispatch("function-name:"+String(n.name)),this._object(n)},_number:function(n){r("number:"+n.toString())},_xml:function(n){r("xml:"+n.toString())},_null:function(){r("Null")},_undefined:function(){r("Undefined")},_regexp:function(n){r("regex:"+n.toString())},_uint8array:function(n){r("uint8array:"),this.dispatch(Array.prototype.slice.call(n))},_uint8clampedarray:function(n){r("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(n))},_int8array:function(n){r("int8array:"),this.dispatch(Array.prototype.slice.call(n))},_uint16array:function(n){r("uint16array:"),this.dispatch(Array.prototype.slice.call(n))},_int16array:function(n){r("int16array:"),this.dispatch(Array.prototype.slice.call(n))},_uint32array:function(n){r("uint32array:"),this.dispatch(Array.prototype.slice.call(n))},_int32array:function(n){r("int32array:"),this.dispatch(Array.prototype.slice.call(n))},_float32array:function(n){r("float32array:"),this.dispatch(Array.prototype.slice.call(n))},_float64array:function(n){r("float64array:"),this.dispatch(Array.prototype.slice.call(n))},_arraybuffer:function(n){r("arraybuffer:"),this.dispatch(new Uint8Array(n))},_url:function(n){r("url:"+n.toString())},_map:function(n){r("map:");let a=Array.from(n);this._array(a,!0)},_set:function(n){r("set:");let a=Array.from(n);this._array(a,!0)},_file:function(n){r("file:"),this.dispatch([n.name,n.size,n.type,n.lastModified])},_blob:function(){throw Error(`Hashing Blob objects is currently not supported
(see https://github.com/puleos/object-hash/issues/26)
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow:function(){r("domwindow")},_bigint:function(n){r("bigint:"+n.toString())},_process:function(){r("process")},_timer:function(){r("timer")},_pipe:function(){r("pipe")},_tcp:function(){r("tcp")},_udp:function(){r("udp")},_tty:function(){r("tty")},_statwatcher:function(){r("statwatcher")},_securecontext:function(){r("securecontext")},_connection:function(){r("connection")},_zlib:function(){r("zlib")},_context:function(){r("context")},_nodescript:function(){r("nodescript")},_httpparser:function(){r("httpparser")},_dataview:function(){r("dataview")},_signal:function(){r("signal")},_fsevent:function(){r("fsevent")},_tlswrap:function(){r("tlswrap")}}}function zn(){return{buf:"",write:function(t){this.buf+=t},end:function(t){this.buf+=t},read:function(){return this.buf}}}function Hn(t,e){let r=this[t];return r instanceof Date?`__raycast_cached_date__${r.toISOString()}`:Buffer.isBuffer(r)?`__raycast_cached_buffer__${r.toString("base64")}`:e}function Kn(t,e){return typeof e=="string"&&e.startsWith("__raycast_cached_date__")?new Date(e.replace("__raycast_cached_date__","")):typeof e=="string"&&e.startsWith("__raycast_cached_buffer__")?Buffer.from(e.replace("__raycast_cached_buffer__",""),"base64"):e}function tr(t){let e=or.default.createHash("sha1");return dr(e).dispatch(t),e.digest("hex")}var qn=Symbol("cache without namespace"),rr=new Map;function Gn(t,e,r){let n=r?.cacheNamespace||qn,a=rr.get(n)||rr.set(n,new g.Cache({namespace:r?.cacheNamespace})).get(n);if(!a)throw new Error("Missing cache");let s=B(t),i=B(e),o=(0,h.useSyncExternalStore)(a.subscribe,()=>{try{return a.get(s.current)}catch(m){console.error("Could not get Cache data:",m);return}}),c=(0,h.useMemo)(()=>{if(typeof o<"u"){if(o==="undefined")return;try{return JSON.parse(o,Kn)}catch(m){return console.warn("The cached data is corrupted",m),i.current}}else return i.current},[o,i]),f=B(c),l=(0,h.useCallback)(m=>{let P=typeof m=="function"?m(f.current):m;if(typeof P>"u")a.set(s.current,"undefined");else{let V=JSON.stringify(P,Hn);a.set(s.current,V)}return P},[a,s,f]);return[c,l]}var xe=Symbol();function qe(t,e,r){let{initialData:n,keepPreviousData:a,internal_cacheKeySuffix:s,...i}=r||{},o=(0,h.useRef)(null),[c,f]=Gn(tr(e||[])+s,xe,{cacheNamespace:tr(t)}),l=(0,h.useRef)(c!==xe?c:n),m=(0,h.useRef)(void 0),{mutate:P,revalidate:V,...U}=Bn(t,e||[],{...i,onData(T,w){m.current=w,i.onData&&i.onData(T,w),!(w&&w.page>0)&&(o.current="promise",l.current=T,f(T))}}),d,C=U.pagination;m.current&&m.current.page>0&&U.data?d=U.data:o.current==="promise"?d=l.current:a&&c!==xe?(d=c,C&&(C.hasMore=!0,C.pageSize=c.length)):a&&c===xe?d=l.current:c!==xe?(d=c,C&&(C.hasMore=!0,C.pageSize=c.length)):d=n;let E=B(d),G=(0,h.useCallback)(async(T,w)=>{let b;try{if(w?.optimisticUpdate){typeof w?.rollbackOnError!="function"&&w?.rollbackOnError!==!1&&(b=structuredClone(E.current));let $=w.optimisticUpdate(E.current);o.current="cache",l.current=$,f($)}return await P(T,{shouldRevalidateAfter:w?.shouldRevalidateAfter})}catch($){if(typeof w?.rollbackOnError=="function"){let j=w.rollbackOnError(E.current);o.current="cache",l.current=j,f(j)}else w?.optimisticUpdate&&w?.rollbackOnError!==!1&&(o.current="cache",l.current=b,f(b));throw $}},[f,P,E,l,o]);return(0,h.useEffect)(()=>{c!==xe&&(o.current="cache",l.current=c)},[c]),{data:d,isLoading:U.isLoading,error:U.error,mutate:m.current&&m.current.page>0?P:G,pagination:C,revalidate:V}}var He=t=>!!t&&typeof t=="object"&&typeof t.removeListener=="function"&&typeof t.emit=="function"&&typeof t.reallyExit=="function"&&typeof t.listeners=="function"&&typeof t.kill=="function"&&typeof t.pid=="number"&&typeof t.on=="function",mt=Symbol.for("signal-exit emitter"),gt=class{constructor(){if(this.emitted={afterExit:!1,exit:!1},this.listeners={afterExit:[],exit:[]},this.count=0,this.id=Math.random(),ht[mt])return ht[mt];Object.defineProperty(ht,mt,{value:this,writable:!1,enumerable:!1,configurable:!1})}on(e,r){this.listeners[e].push(r)}removeListener(e,r){let n=this.listeners[e],a=n.indexOf(r);a!==-1&&(a===0&&n.length===1?n.length=0:n.splice(a,1))}emit(e,r,n){if(this.emitted[e])return!1;this.emitted[e]=!0;let a=!1;for(let s of this.listeners[e])a=s(r,n)===!0||a;return e==="exit"&&(a=this.emit("afterExit",r,n)||a),a}},bt=class{onExit(){return()=>{}}load(){}unload(){}},yt=class{#o;#t;#e;#s;#i;#a;#n;#r;constructor(e){this.#o=process.platform==="win32"?"SIGINT":"SIGHUP",this.#t=new gt,this.#a={},this.#n=!1,this.#r=[],this.#r.push("SIGHUP","SIGINT","SIGTERM"),globalThis.process.platform!=="win32"&&this.#r.push("SIGALRM","SIGABRT","SIGVTALRM","SIGXCPU","SIGXFSZ","SIGUSR2","SIGTRAP","SIGSYS","SIGQUIT","SIGIOT"),globalThis.process.platform==="linux"&&this.#r.push("SIGIO","SIGPOLL","SIGPWR","SIGSTKFLT"),this.#e=e,this.#a={};for(let r of this.#r)this.#a[r]=()=>{let n=this.#e.listeners(r),{count:a}=this.#t,s=e;if(typeof s.__signal_exit_emitter__=="object"&&typeof s.__signal_exit_emitter__.count=="number"&&(a+=s.__signal_exit_emitter__.count),n.length===a){this.unload();let i=this.#t.emit("exit",null,r),o=r==="SIGHUP"?this.#o:r;i||e.kill(e.pid,o)}};this.#i=e.reallyExit,this.#s=e.emit}onExit(e,r){if(!He(this.#e))return()=>{};this.#n===!1&&this.load();let n=r?.alwaysLast?"afterExit":"exit";return this.#t.on(n,e),()=>{this.#t.removeListener(n,e),this.#t.listeners.exit.length===0&&this.#t.listeners.afterExit.length===0&&this.unload()}}load(){if(!this.#n){this.#n=!0,this.#t.count+=1;for(let e of this.#r)try{let r=this.#a[e];r&&this.#e.on(e,r)}catch{}this.#e.emit=(e,...r)=>this.#l(e,...r),this.#e.reallyExit=e=>this.#c(e)}}unload(){this.#n&&(this.#n=!1,this.#r.forEach(e=>{let r=this.#a[e];if(!r)throw new Error("Listener not defined for signal: "+e);try{this.#e.removeListener(e,r)}catch{}}),this.#e.emit=this.#s,this.#e.reallyExit=this.#i,this.#t.count-=1)}#c(e){return He(this.#e)?(this.#e.exitCode=e||0,this.#t.emit("exit",this.#e.exitCode,null),this.#i.call(this.#e,this.#e.exitCode)):0}#l(e,...r){let n=this.#s;if(e==="exit"&&He(this.#e)){typeof r[0]=="number"&&(this.#e.exitCode=r[0]);let a=n.call(this.#e,e,...r);return this.#t.emit("exit",this.#e.exitCode,null),a}else return n.call(this.#e,e,...r)}},pt=null,Jn=(t,e)=>(pt||(pt=He(process)?new yt(process):new bt),pt.onExit(t,e));function Zn(t,{timeout:e}={}){let r=new Promise((o,c)=>{t.on("exit",(f,l)=>{o({exitCode:f,signal:l,timedOut:!1})}),t.on("error",f=>{c(f)}),t.stdin&&t.stdin.on("error",f=>{c(f)})}),n=Jn(()=>{t.kill()});if(e===0||e===void 0)return r.finally(()=>n());let a,s=new Promise((o,c)=>{a=setTimeout(()=>{t.kill("SIGTERM"),c(Object.assign(new Error("Timed out"),{timedOut:!0,signal:"SIGTERM"}))},e)}),i=r.finally(()=>{clearTimeout(a)});return Promise.race([s,i]).finally(()=>n())}var wt=class extends Error{constructor(){super("The output is too big"),this.name="MaxBufferError"}};function Yn(t){let{encoding:e}=t,r=e==="buffer",n=new $e.default.PassThrough({objectMode:!1});e&&e!=="buffer"&&n.setEncoding(e);let a=0,s=[];return n.on("data",i=>{s.push(i),a+=i.length}),n.getBufferedValue=()=>r?Buffer.concat(s,a):s.join(""),n.getBufferedLength=()=>a,n}async function nr(t,e){let r=Yn(e);return await new Promise((n,a)=>{let s=i=>{i&&r.getBufferedLength()<=lr.constants.MAX_LENGTH&&(i.bufferedData=r.getBufferedValue()),a(i)};(async()=>{try{await(0,ur.promisify)($e.default.pipeline)(t,r),n()}catch(i){s(i)}})(),r.on("data",()=>{r.getBufferedLength()>8e7&&s(new wt)})}),r.getBufferedValue()}async function ar(t,e){t.destroy();try{return await e}catch(r){return r.bufferedData}}async function Xn({stdout:t,stderr:e},{encoding:r},n){let a=nr(t,{encoding:r}),s=nr(e,{encoding:r});try{return await Promise.all([n,a,s])}catch(i){return Promise.all([{error:i,exitCode:null,signal:i.signal,timedOut:i.timedOut||!1},ar(t,a),ar(e,s)])}}function Qn(t){let e=typeof t=="string"?`
`:10,r=typeof t=="string"?"\r":13;return t[t.length-1]===e&&(t=t.slice(0,-1)),t[t.length-1]===r&&(t=t.slice(0,-1)),t}function sr(t,e){return t.stripFinalNewline?Qn(e):e}function ea({timedOut:t,timeout:e,signal:r,exitCode:n}){return t?`timed out after ${e} milliseconds`:r!=null?`was killed with ${r}`:n!=null?`failed with exit code ${n}`:"failed"}function ta({stdout:t,stderr:e,error:r,signal:n,exitCode:a,command:s,timedOut:i,options:o,parentError:c}){let l=`Command ${ea({timedOut:i,timeout:o?.timeout,signal:n,exitCode:a})}: ${s}`,m=r?`${l}
${r.message}`:l,P=[m,e,t].filter(Boolean).join(`
`);return r?r.originalMessage=r.message:r=c,r.message=P,r.shortMessage=m,r.command=s,r.exitCode=a,r.signal=n,r.stdout=t,r.stderr=e,"bufferedData"in r&&delete r.bufferedData,r}function ra({stdout:t,stderr:e,error:r,exitCode:n,signal:a,timedOut:s,command:i,options:o,parentError:c}){if(r||n!==0||a!==null)throw ta({error:r,exitCode:n,signal:a,stdout:t,stderr:e,command:i,timedOut:s,options:o,parentError:c});return t}function ir(t,e,r,n){let a=(n-90)*Math.PI/180;return{x:t+r*Math.cos(a),y:e+r*Math.sin(a)}}function na(t,e,r,n,a){let s=ir(t,e,r,a),i=ir(t,e,r,n),o=a-n<=180?"0":"1";return["M",s.x,s.y,"A",r,r,0,o,0,i.x,i.y].join(" ")}function hr(t,e=g.Color.Red,r){let n=r?.background||(g.environment.appearance==="light"?"black":"white"),a=r?.backgroundOpacity||.1,s=10,o=50-5-s/2,c=`<svg xmlns="http://www.w3.org/2000/svg" width="100px" height="100px">
      <circle cx="50" cy="50" r="${o}" stroke-width="${s}" stroke="${t<1?n:e}" opacity="${t<1?a:"1"}" fill="none" />
      ${t>0&&t<1?`<path d="${na(50,50,o,0,t*360)}" stroke="${e}" stroke-width="${s}" fill="none" />`:""}
    </svg>
  `.replaceAll(`
`,"");return`data:image/svg+xml,${encodeURIComponent(c)}`}async function mr(t,e,r){if(process.platform!=="darwin")throw new Error("AppleScript is only supported on macOS");let{humanReadableOutput:n,language:a,timeout:s,...i}=Array.isArray(e)?r||{}:e||{},o=n!==!1?[]:["-ss"];a==="JavaScript"&&o.push("-l","JavaScript"),Array.isArray(e)&&o.push("-",...e);let c=cr.default.spawn("osascript",o,{...i,env:{PATH:"/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin"}}),f=Zn(c,{timeout:s??1e4});c.stdin.end(t);let[{error:l,exitCode:m,signal:P,timedOut:V},U,d]=await Xn(c,{encoding:"utf8"},f),C=sr({stripFinalNewline:!0},U),E=sr({stripFinalNewline:!0},d);return ra({stdout:C,stderr:E,error:l,exitCode:m,signal:P,timedOut:V,command:"osascript",options:r,parentError:new Error})}var ie=require("react"),Ee=require("@raycast/api");var pr=require("@raycast/api"),p=(0,pr.getPreferenceValues)();var xr=v(xt()),ue=new xr.Logger({prefix:"[Brew]"}),_=ue.child("[Commands]"),Ue=ue.child("[Cache]"),L=ue.child("[Actions]"),$t=ue.child("[Fetch]"),$r=ue.child("[Search]"),te=ue.child("[UI]");var O=class extends Error{constructor(e,r){super(e),this.name="BrewError",this.brewCause=r?.cause}},ve=class extends O{constructor(e,r){super(e,{cause:r?.cause}),this.name="NetworkError",this.statusCode=r?.statusCode,this.url=r?.url}};var Ce=class extends O{constructor(e,r){super(e,{cause:r?.cause}),this.name="BrewCommandError",this.command=r?.command,this.exitCode=r?.exitCode,this.stderr=r?.stderr}},Ze=class extends O{constructor(e,r){super(e,{cause:r?.cause}),this.name="BrewNotFoundError",this.path=r?.path}};var z=class extends O{constructor(e,r){super(e,{cause:r?.cause}),this.name="BrewLockError",this.command=r?.command}},Oe=class extends O{constructor(e,r){super(e,{cause:r?.cause}),this.name="DownloadTimeoutError",this.packageName=r?.packageName,this.phase=r?.phase,this.timeoutMs=r?.timeoutMs,this.elapsedMs=r?.elapsedMs}},re=class extends O{constructor(e,r){super(e,{cause:r?.cause}),this.name="StaleProcessError",this.packageName=r?.packageName,this.lastPhase=r?.lastPhase,this.staleDurationMs=r?.staleDurationMs}},Ye=class extends O{constructor(e,r){super(e,{cause:r?.cause}),this.name="PackageNotFoundError",this.packageName=r?.packageName,this.packageType=r?.packageType}},Xe=class extends O{constructor(e,r){super(e,{cause:r?.cause}),this.name="PackageDisabledError",this.packageName=r?.packageName,this.packageType=r?.packageType,this.disabledDate=r?.disabledDate,this.reason=r?.reason}},Qe=class extends O{constructor(e,r){super(e,{cause:r?.cause}),this.name="PackageConflictError",this.packageName=r?.packageName,this.conflictsWith=r?.conflictsWith}},et=class extends O{constructor(e,r){super(e,{cause:r?.cause}),this.name="UnsupportedMacOSError",this.packageName=r?.packageName,this.requiredVersion=r?.requiredVersion,this.currentVersion=r?.currentVersion}};function vt(t){return t instanceof ve}function ne(t){return t instanceof z}function Sr(t){return t instanceof Oe}function vr(t){return t instanceof re}function Ae(t){return vt(t)||ne(t)||Sr(t)||vr(t)}var ia=[/lockf:.*already locked/i,/another active Homebrew/i,/another brew process/i,/another.*brew.*update.*process/i,/Homebrew is already running/i,/Error: Another active Homebrew/i,/Error: Another.*brew.*process/i,/waiting for lock/i,/lock file/i,/has already locked/i,/brew upgrade.*process has already/i],oa=/Error: (Cask|Formula) '([^']+)' has been disabled(?: because (.+?))?(?:! It was disabled on (\d{4}-\d{2}-\d{2}))?/i;function De(t){return ia.some(e=>e.test(t))}function St(t){let e=t.match(oa);return e?{packageType:e[1].toLowerCase(),packageName:e[2],reason:e[3]?.trim(),disabledDate:e[4]}:null}function H(t){return t instanceof Error?t:new Error(String(t))}function fe(t){if(t instanceof z)return"Another brew process is already running. Please wait for it to finish and try again.";if(t instanceof Oe){let e=t.packageName?` for "${t.packageName}"`:"",r=t.phase?` during ${t.phase}`:"";return`Download timed out${e}${r}. Please try again.`}if(t instanceof re){let e=t.packageName?` for "${t.packageName}"`:"",r=t.lastPhase?` (stuck at ${t.lastPhase})`:"";return`Process appears stuck${e}${r}. The operation was cancelled.`}if(t instanceof Xe){let e=t.packageType??"package",n=`${e.charAt(0).toUpperCase()+e.slice(1)} "${t.packageName}" has been discontinued`;return t.reason&&(n+=`: ${t.reason}`),t.disabledDate&&(n+=` (disabled on ${t.disabledDate})`),n}if(t instanceof Qe){let e=t.conflictsWith?.join(", ")??"another package";return`"${t.packageName}" conflicts with ${e}. Please uninstall the conflicting package first.`}if(t instanceof et){let e=`"${t.packageName}" requires a different macOS version`;return t.requiredVersion&&(e+=` (requires ${t.requiredVersion})`),e}if(t instanceof ve)return t.statusCode?`Network error (HTTP ${t.statusCode}): ${t.message}`:`Network error: ${t.message}`;if(t instanceof Ze)return`Homebrew not found: ${t.message}`;if(t instanceof Ye){let e=t.packageType??"package";return`${e.charAt(0).toUpperCase()+e.slice(1)} not found: ${t.packageName??t.message}`}if(t instanceof Ce){if(t.exitCode===void 0||t.exitCode===null)return"Cancelled";if(t.stderr){let e=St(t.stderr);if(e){let r=`${e.packageType.charAt(0).toUpperCase()+e.packageType.slice(1)} "${e.packageName}" has been discontinued`;return e.reason&&(r+=`: ${e.reason}`),e.disabledDate&&(r+=` (disabled on ${e.disabledDate})`),r}}return t.stderr??t.message}if(t instanceof O)return t.message;if(t instanceof Error){if(t.name==="AbortError")return"Cancelled";let e=t;if(e.stderr){let r=St(e.stderr);if(r){let n=`${r.packageType.charAt(0).toUpperCase()+r.packageType.slice(1)} "${r.packageName}" has been discontinued`;return r.reason&&(n+=`: ${r.reason}`),r.disabledDate&&(n+=` (disabled on ${r.disabledDate})`),n}return e.stderr}return t.message}return String(t)}var Pe=require("@raycast/api"),Nt=v(require("path")),Kr=v(require("fs"));var ja=v(tt()),Wa=v(Rt()),za=v(Nr()),Ha=v(Hr());var qr=(()=>{try{Kr.default.mkdirSync(Pe.environment.supportPath,{recursive:!0})}catch{Ue.warn("Failed to create supportPath")}return Pe.environment.supportPath})(),Vt=Pe.environment.supportPath.split(Nt.default.sep).find(t=>!!t.startsWith("com.raycast"))??"com.raycast.macos";function Le(t){return Nt.default.join(qr,t)}var F=require("@raycast/api");function Ne(t){let e={style:F.Toast.Style.Animated,title:t.title,message:t.message},r;t.cancelable&&(r=new AbortController,e.primaryAction={title:"Cancel",onAction:()=>{r?.abort(),n.hide()}});let n=new F.Toast(e);return n.show(),{abort:r,updateMessage:a=>{n.message=a},updateTitle:a=>{n.title=a},showSuccessHUD:async a=>{p.closeAfterAction?(n.hide(),await(0,F.showHUD)(`\u2705 ${a}`)):(n.style=F.Toast.Style.Success,n.title=a,n.message=void 0,n.primaryAction=void 0)},showFailureHUD:async a=>{p.closeAfterAction?(n.hide(),await(0,F.showHUD)(`\u274C ${a}`)):(n.style=F.Toast.Style.Failure,n.title=a,n.message=void 0,n.primaryAction=void 0)},hide:()=>{n.hide()}}}async function pe(t,e,r){if(e.name==="AbortError"){te.log("Operation aborted by user");return}let n=e,a=fe(e),s=ne(e);te.error(t,{errorType:e.name,message:e.message,stderr:n.stderr,code:n.code,recoverable:Ae(e),isLockError:s});let i=s?"Brew is Busy":t,o={style:F.Toast.Style.Failure,title:i,message:a,primaryAction:{title:"Copy Logs",onAction:()=>{let f=s?`${i}
${a}

Tip: Check Activity Monitor or run 'ps aux | grep brew' in Terminal to see what's running.`:a;F.Clipboard.copy(f)}}};if(Ae(e)&&r?.retryAction){let f=r.retryAction;o.secondaryAction={title:"Retry",onAction:async l=>{l.style=F.Toast.Style.Animated,l.title="Retrying...",l.message=void 0;try{await f(),l.style=F.Toast.Style.Success,l.title="Success"}catch(m){l.style=F.Toast.Style.Failure,l.title=ne(m)?"Brew is Busy":t,l.message=fe(m)}}}}await new F.Toast(o).show()}Array.prototype.first||(Array.prototype.first=function(){return this.at(0)});Array.prototype.last||(Array.prototype.last=function(){return this.at(-1)});Array.prototype.isTruncated||(Array.prototype.isTruncated=function(){return this.totalLength?this.length<this.totalLength:!1});String.ellipsis||(String.ellipsis="\u2026");var Gr=v(xt()),Ka=new Gr.Logger({prefix:"[Brew]"}).child("[Memory]");var Jr=require("child_process"),Bt=require("path"),Zr=require("os");var jt=(()=>{if(p.customBrewPath&&p.customBrewPath.length>0)return(0,Bt.join)(p.customBrewPath,"..","..");try{return(0,Jr.execSync)("brew --prefix",{encoding:"utf8"}).trim()}catch{return(0,Zr.cpus)()[0]?.model?.includes("Apple")?"/opt/homebrew":"/usr/local"}})(),rt=t=>(0,Bt.join)(jt,t),ae=()=>rt("bin/brew");var Xr=require("child_process"),Qr=require("util"),en=require("fs"),nt=v(require("fs/promises")),tn=require("path"),rn=require("@raycast/api");var qa=(0,Qr.promisify)(Xr.exec),Yr=!1;async function Z(t,e){try{let r=await at();return await qa(`${ae()} ${t}`,{signal:e?.signal,env:r,maxBuffer:10*1024*1024})}catch(r){let n=r,a=n?.stderr||n?.stdout||"";throw De(a)?(_.warn("Brew lock detected - another process is running",{command:t,stderr:n?.stderr}),new z("Another brew process is already running",{command:t,cause:n})):p.customBrewPath&&n&&n.code===127?(n.stderr=`Brew executable not found at: ${p.customBrewPath}`,n):r}}async function at(){let t=(0,tn.join)(rn.environment.assetsPath,"askpass.sh");try{await nt.access(t,en.constants.X_OK)}catch{await nt.chmod(t,493)}let e={...process.env};e.SUDO_ASKPASS=t,e.HOMEBREW_BROWSER=Vt;let r=p.disableDownloadConcurrency;r&&(e.HOMEBREW_DOWNLOAD_CONCURRENCY="1");let n=p.useInternalApi;return n&&(e.HOMEBREW_USE_INTERNAL_API="1"),Yr||(Yr=!0,_.log("Homebrew 5.0 Configuration",{downloadConcurrencyEnabled:!r,downloadConcurrencyMode:r?"sequential (1)":"parallel (auto)",internalApiEnabled:n,verboseLogging:p.verboseLogging})),e}var nn=require("child_process");var Wt=300*1e3,an=600*1e3;function sn(t){let e=t.trim();if(!e)return null;let r=e.replace(/^=+>\s*/,"");if(e.includes("Downloading"))return{phase:"downloading",message:r};let n=e.match(/#+\s*(\d+\.?\d*)%/);return n?{phase:"downloading",message:`Downloading... ${n[1]}%`,percentage:parseFloat(n[1])}:e.includes("Verifying")||e.includes("checksum")?{phase:"verifying",message:r}:e.includes("Pouring")||e.includes("Extracting")?{phase:"extracting",message:r}:e.includes("Installing")||e.includes("==> Installing")?{phase:"installing",message:r}:e.includes("Linking")||e.includes("==> Linking")?{phase:"linking",message:r}:e.includes("Cleaning")||e.includes("Removing")?{phase:"cleaning",message:r}:e.includes("==> Caveats")||e.includes("==> Summary")?{phase:"complete",message:r}:e.startsWith("==>")?{phase:"installing",message:r}:null}async function st(t,e,r,n){let a=await at(),s=t.split(/\s+/).filter(Boolean),i=n?.staleTimeoutMs??Wt,o=n?.packageName,c=n?.verboseLogging??!1;return _.log("Executing brew with progress",{command:t,packageName:o,staleTimeoutMs:i}),new Promise((f,l)=>{let m=(0,nn.spawn)(ae(),s,{env:a,stdio:["ignore","pipe","pipe"]}),P="",V="",U=Date.now(),d="starting",C=null,E=!1,G=()=>{C&&(clearInterval(C),C=null)},T=b=>{E||(E=!0,G(),m.kill("SIGTERM"),l(b))};C=setInterval(()=>{let $=Date.now()-U,j=d==="downloading"?an:i;$>j?(_.warn("Stale process detected",{command:t,packageName:o,lastPhase:d,staleDurationMs:$,timeoutMs:j}),T(new re(`Process appears stuck during ${d}`,{packageName:o,lastPhase:d,staleDurationMs:$}))):c&&_.log("Stale check passed",{command:t,phase:d,timeSinceLastProgress:$,timeout:j})},3e4),r&&r.addEventListener("abort",()=>{if(E)return;E=!0,G(),m.kill("SIGTERM");let b=new Error("Cancelled");b.name="AbortError",l(b)}),e?.({phase:"starting",message:`Running: brew ${t.trim()}`});let w=(b,$)=>{U=Date.now();let j=b.split(`
`);for(let Fe of j){let Q=sn(Fe);Q?(Q.phase!==d&&(_.log("Phase transition",{command:t,packageName:o,from:d,to:Q.phase,message:Q.message}),d=Q.phase),e?.(Q)):c&&Fe.trim()&&_.log(`Unparsed ${$}`,{line:Fe.trim()})}};m.stdout?.on("data",b=>{let $=b.toString();P+=$,w($,"stdout")}),m.stderr?.on("data",b=>{let $=b.toString();if(V+=$,De($)){T(new z("Another brew process is already running",{command:t}));return}w($,"stderr")}),m.on("close",b=>{G(),!E&&(_.log("Command completed",{command:t,packageName:o,exitCode:b,finalPhase:d}),b===0?(e?.({phase:"complete",message:"Operation completed successfully"}),f({stdout:P,stderr:V})):(e?.({phase:"error",message:`Command failed with exit code ${b}`}),l(new Ce(`brew ${t} failed with exit code ${b}`,{command:t,exitCode:b??void 0,stderr:V}))))}),m.on("error",b=>{G(),!E&&(e?.({phase:"error",message:b.message}),l(b))})})}var es=v(tt()),ts=v(Rt()),rs=v(cn()),ns=v(un());var Oi=Le("installedv2.json"),Di=Le("formula.json"),Mi=Le("cask.json");async function it(t,e,r=!1){_.log("Fetching outdated packages",{greedy:t,skipUpdate:r});let n="outdated --json=v2";t&&(n+=" --greedy"),r||await ot(e);let a=await Z(n,e?{signal:e}:void 0),s=JSON.parse(a.stdout);return _.log("Outdated packages fetched",{formulaeCount:s.formulae.length,casksCount:s.casks.length,skipUpdate:r}),s}async function ot(t){_.log("Running brew update"),await Z("update",t?{signal:t}:void 0),_.log("Brew update completed")}function se(t){return t.token!==void 0}function ye(t){return se(t)?t.token:t.name}function Y(t){return se(t)?t.name&&t.name[0]?t.name[0]:"Unknown":t.name}function we(t,e=!1){return se(t)?"--cask"+(e&&p.zapCask?" --zap":""):""}function ct(t){let e=ye(t);return`${ae()} uninstall ${we(t,!0)} ${e}`.replace(/ +/g," ")}function lt(t){let e=ye(t);return`${ae()} upgrade ${we(t)} ${e}`.replace(/ +/g," ")}async function zt(t,e){let r=ye(t);L.log("Uninstalling package",{identifier:r,type:se(t)?"cask":"formula",zap:p.zapCask}),await Z(`rm ${we(t,!0)} ${r}`,e?{signal:e}:void 0),L.log("Package uninstalled successfully",{identifier:r})}async function Ht(t,e,r){let n=ye(t);L.log("Upgrading package with progress",{identifier:n,type:se(t)?"cask":"formula"}),await st(`upgrade ${we(t)} ${n}`,e,r),L.log("Package upgraded successfully",{identifier:n})}async function Kt(t,e){L.log("Upgrading all packages",{greedy:t});let r="upgrade";t&&(r+=" --greedy"),await Z(r,e?{signal:e}:void 0),L.log("All packages upgraded successfully")}async function qt(t){L.log("Pinning formula",{name:t.name}),await Z(`pin ${t.name}`),t.pinned=!0,L.log("Formula pinned successfully",{name:t.name})}async function Gt(t){L.log("Unpinning formula",{name:t.name}),await Z(`unpin ${t.name}`),t.pinned=!1,L.log("Formula unpinned successfully",{name:t.name})}function dn(){let[t,e]=(0,ie.useState)(!1),r=(0,ie.useRef)(!1),n=qe(async()=>await it(p.greedyUpgrades,void 0,!0),[],{keepPreviousData:!0,onError:async s=>{_.error("Failed to fetch outdated packages",{errorType:s.name,message:s.message,isLockError:ne(s)});let i=ne(s),o=fe(s);await(0,Ee.showToast)({style:Ee.Toast.Style.Failure,title:i?"Brew is Busy":"Failed to fetch outdated packages",message:i?"Another brew process is running. Please wait and try again.":o,primaryAction:{title:"Retry",onAction:c=>{c.hide(),n.revalidate()}}})}}),a=(0,ie.useCallback)(async()=>{if(r.current||n.isLoading)return;r.current=!0,e(!0),_.log("Starting background refresh for outdated packages");let s;try{s=await(0,Ee.showToast)({style:Ee.Toast.Style.Animated,title:"Updating Homebrew Index\u2026"}),await ot(),s.title="Checking for Outdated Packages\u2026";let i=await it(p.greedyUpgrades,void 0,!0);i.formulae.length!==n.data?.formulae.length||i.casks.length!==n.data?.casks.length?(_.log("Background refresh found changes",{oldFormulae:n.data?.formulae.length??0,newFormulae:i.formulae.length,oldCasks:n.data?.casks.length??0,newCasks:i.casks.length}),n.revalidate()):_.log("Background refresh complete, no changes"),s?.hide()}catch(i){_.warn("Background refresh failed",{error:i}),s?.hide()}finally{e(!1)}},[n]);return(0,ie.useEffect)(()=>{!n.isLoading&&n.data&&!r.current&&a()},[n.isLoading,n.data,a]),{...n,isRefreshing:t}}var N=require("@raycast/api");var mn=require("react"),ut=require("@raycast/api");var hn=require("@raycast/api"),ps=require("react/jsx-runtime");var pn=require("react/jsx-runtime");var gn=require("react"),ft=require("@raycast/api");var bn=require("react/jsx-runtime");var k=require("@raycast/api");var Ve=require("react/jsx-runtime");function yn(t){return(0,Ve.jsx)(k.Action,{title:"Uninstall",icon:k.Icon.Trash,shortcut:k.Keyboard.Shortcut.Common.Remove,style:k.Action.Style.Destructive,onAction:async()=>{let e=await bs(t.formula);t.onAction(e)}})}function wn(t){return(0,Ve.jsx)(k.Action,{title:"Upgrade",icon:k.Icon.Hammer,shortcut:{modifiers:["cmd","shift"],key:"u"},onAction:async()=>{let e=await ys(t.formula);t.onAction(e)}})}function kn(t){return(0,Ve.jsx)(k.Action,{title:"Upgrade All",icon:k.Icon.Hammer,onAction:async()=>{let e=await ws();t.onAction(e)}})}function _n(t){let e=t.formula.pinned;return(0,Ve.jsx)(k.Action,{title:e?"Unpin":"Pin",icon:k.Icon.Pin,shortcut:k.Keyboard.Shortcut.Common.Pin,onAction:async()=>{e?t.onAction(await _s(t.formula)):t.onAction(await ks(t.formula))}})}async function bs(t){let e=Y(t),r=Ne({title:`Uninstalling ${e}`,message:"",cancelable:!0});try{return await zt(t,r.abort?.signal),await r.showSuccessHUD(`Uninstalled ${e}`),!0}catch(n){let a=H(n);return await r.showFailureHUD(`Failed to uninstall ${e}`),pe("Uninstall failed",a),!1}}async function ys(t){let e=Y(t),r=Ne({title:`Upgrading ${e}`,message:"",cancelable:!0});try{return await Ht(t,n=>{r.updateMessage(n.message)},r.abort?.signal),await r.showSuccessHUD(`Upgraded ${e}`),!0}catch(n){let a=H(n);return await r.showFailureHUD(`Failed to upgrade ${e}`),pe("Upgrade failed",a),!1}}async function ws(){let t=Ne({title:"Upgrading all packages",message:"This may take a while...",cancelable:!0});try{return await Kt(p.greedyUpgrades,t.abort?.signal),await t.showSuccessHUD("All packages upgraded"),!0}catch(e){let r=H(e);return await t.showFailureHUD("Failed to upgrade packages"),pe("Upgrade failed",r),!1}}async function ks(t){(0,k.showToast)(k.Toast.Style.Animated,`Pinning ${Y(t)}`);try{return await qt(t),t.pinned=!0,(0,k.showToast)(k.Toast.Style.Success,`Pinned ${Y(t)}`),!0}catch(e){return pe("Pin formula failed",H(e)),!1}}async function _s(t){(0,k.showToast)(k.Toast.Style.Animated,`Unpinning ${Y(t)}`);try{return await Gt(t),t.pinned=!1,(0,k.showToast)(k.Toast.Style.Success,`Unpinned ${Y(t)}`),!0}catch(e){return pe("Unpin formula failed",H(e)),!1}}var Be=require("@raycast/api");var oe={alacritty:"Alacritty",ghostty:"Ghostty",hyper:"Hyper",iterm:"iTerm",kitty:"kitty",terminal:"Terminal",warp:"Warp",wezterm:"WezTerm"},xn={alacritty:{fileIcon:"/Applications/Alacritty.app"},ghostty:{fileIcon:"/Applications/Ghostty.app"},hyper:{fileIcon:"/Applications/Hyper.app"},iterm:{fileIcon:"/Applications/iTerm.app"},kitty:{fileIcon:"/Applications/kitty.app"},terminal:{fileIcon:"/System/Applications/Utilities/Terminal.app"},warp:{fileIcon:"/Applications/Warp.app"},wezterm:{fileIcon:"/Applications/WezTerm.app"}},$s={alacritty:"org.alacritty",ghostty:"com.mitchellh.ghostty",hyper:"co.zeit.hyper",iterm:"com.googlecode.iterm2",kitty:"org.kovidgoyal.kitty",terminal:"com.apple.terminal",warp:"dev.warp.Warp-Stable",wezterm:"com.github.wez.wezterm"},Te=(t,e)=>`
    tell application "${e}" to activate
    tell application "System Events" to tell process "${e}"
        keystroke "t" using command down
        delay 0.5
        keystroke "${t}"
        keystroke return
    end tell
  `,$n={alacritty:t=>Te(t,oe.alacritty),ghostty:t=>Te(t,oe.ghostty),hyper:t=>Te(t,oe.hyper),iterm:t=>`
    tell application "iTerm"
      set newWindow to create window with default profile command "bash -c '${t}; read -n 1 -s -r -p \\"Press any key to exit - will not quit\\" ; echo' ; exit"
    end tell
    `,kitty:t=>Te(t,oe.kitty),terminal:t=>`
    tell application "Terminal"
      do shell script "open -a 'Terminal'"
      do script "echo ; ${t} ; bash -c 'read -n 1 -s -r -p \\"Press any key to exit - will not quit\\"' ; exit" in selected tab of the front window
    end tell
  `,warp:t=>Te(t,oe.warp),wezterm:t=>Te(t,oe.wezterm)},Jt=()=>{let{data:t}=qe(async e=>(await(0,Be.getApplications)()).some(n=>n.bundleId?.toLowerCase()===$s[e].toLowerCase()),[p.terminalApp],{failureToastOptions:{title:"Failed to check if Terminal App is installed"}});return{terminalIcon:t?xn[p.terminalApp]:xn.terminal,terminalName:t?oe[p.terminalApp]:oe.terminal,runCommandInTerminal:async e=>{await(0,Be.closeMainWindow)(),await new Promise(n=>setTimeout(n,400));let r=t?$n[p.terminalApp](e):$n.terminal(e);await mr(r),await(0,Be.closeMainWindow)()}}};var D=require("react/jsx-runtime");function Zt(t){let{outdated:e}=t,{terminalName:r,terminalIcon:n,runCommandInTerminal:a}=Jt();function s(i){return i.pinned!=null}return(0,D.jsxs)(N.ActionPanel,{children:[(0,D.jsxs)(N.ActionPanel.Section,{children:[(0,D.jsx)(wn,{formula:e,onAction:t.onAction}),(0,D.jsx)(kn,{onAction:t.onAction}),s(e)&&(0,D.jsx)(_n,{formula:e,onAction:t.onAction})]}),(0,D.jsxs)(N.ActionPanel.Section,{children:[(0,D.jsx)(N.Action.CopyToClipboard,{title:"Copy Upgrade Command",content:lt(e),shortcut:{modifiers:["cmd","opt"],key:"c"}}),(0,D.jsx)(N.Action,{title:`Run Upgrade in ${r}`,icon:n,onAction:()=>a(lt(e))})]}),(0,D.jsxs)(N.ActionPanel.Section,{children:[(0,D.jsx)(yn,{formula:e,onAction:t.onAction}),(0,D.jsx)(N.Action.CopyToClipboard,{title:"Copy Uninstall Command",content:ct(e)}),(0,D.jsx)(N.Action,{title:`Run Uninstall in ${r}`,icon:n,style:N.Action.Style.Destructive,onAction:()=>a(ct(e))})]})]})}var je=require("@raycast/api"),Ie=require("react/jsx-runtime");function Sn(t){return(0,Ie.jsxs)(je.List.Dropdown,{tooltip:"Filter by formula or cask",onChange:e=>{t.onSelect(e)},storeValue:!0,children:[(0,Ie.jsx)(je.List.Dropdown.Item,{value:"all",title:"All"}),(0,Ie.jsx)(je.List.Dropdown.Item,{value:"formulae",title:"Formulae"}),(0,Ie.jsx)(je.List.Dropdown.Item,{value:"casks",title:"Casks"})]})}function vn(t){return`Search ${t==="all"?"formulae or casks":t==="casks"?"casks":"formulae"} by name${String.ellipsis}`}var Cn=require("react"),X=require("@raycast/api");var Re=require("react/jsx-runtime"),dt=class extends Cn.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,r){te.error("React error boundary caught error",{error:e.message,stack:e.stack,componentStack:r.componentStack}),this.setState({errorInfo:r})}render(){if(this.state.hasError){if(this.props.fallback)return this.props.fallback;let{error:e,errorInfo:r}=this.state,n=["# An Error Occurred","","Something went wrong while rendering this view.","","## Error Message","```",e?.message??"Unknown error","```","",e?.stack?["## Stack Trace","```",e.stack,"```",""].join(`
`):"",r?.componentStack?["## Component Stack","```",r.componentStack,"```"].join(`
`):""].join(`
`);return(0,Re.jsx)(X.Detail,{markdown:n,actions:(0,Re.jsxs)(X.ActionPanel,{children:[(0,Re.jsx)(X.Action,{title:"Reload",icon:X.Icon.ArrowClockwise,onAction:()=>this.setState({hasError:!1,error:void 0,errorInfo:void 0})}),(0,Re.jsx)(X.Action.CopyToClipboard,{title:"Copy Error Details",content:n})]})})}return this.props.children}};var S=require("react/jsx-runtime");function Ss(){let[t,e]=(0,An.useState)("all"),{isLoading:r,data:n,revalidate:a}=dn();return(0,S.jsx)(As,{outdated:n,isLoading:r,filterType:t,searchBarAccessory:(0,S.jsx)(Sn,{onSelect:e}),onAction:()=>a()})}function Pn(){return(0,S.jsx)(dt,{children:(0,S.jsx)(Ss,{})})}function vs(t){let e=t.outdated,r=`${e.installed_versions} -> ${e.current_version}`;return(0,S.jsx)(R.List.Item,{id:e.name,title:e.name,accessories:[{text:r}],icon:{source:R.Icon.CheckCircle,tintColor:R.Color.Red},actions:(0,S.jsx)(Zt,{outdated:e,onAction:t.onAction})})}function Cs(t){let e=t.outdated,r="";return e.installed_versions.length>0&&(r=`${e.installed_versions[0]} -> ${e.current_version}`),(0,S.jsx)(R.List.Item,{id:e.name,title:e.name,subtitle:e.pinned?"Pinned":"",accessories:[{text:r}],icon:{source:R.Icon.CheckCircle,tintColor:R.Color.Red},actions:(0,S.jsx)(Zt,{outdated:e,onAction:t.onAction})})}function As(t){let e=t.filterType!="casks"?t.outdated?.formulae??[]:[],r=t.filterType!="formulae"?t.outdated?.casks??[]:[],n=e.length>0||r.length>0,a=()=>{switch(t.filterType){case"formulae":return"No formulae are outdated";case"casks":return"No casks are outdated";default:return"No casks or formulae are outdated"}},s=t.isLoading?"Checking for outdated packages\u2026":vn(t.filterType);return(0,S.jsxs)(R.List,{searchBarPlaceholder:s,searchBarAccessory:t.searchBarAccessory,isLoading:t.isLoading,children:[t.isLoading&&!t.outdated&&(0,S.jsx)(R.List.EmptyView,{icon:hr(.5),title:"Checking for outdated packages...",description:"Running brew outdated"}),!t.isLoading&&!n&&t.outdated!==void 0&&(0,S.jsx)(R.List.EmptyView,{icon:{source:R.Icon.CheckCircle,tintColor:R.Color.Green},title:a(),description:"All your packages are up to date"}),n&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(R.List.Section,{title:"Formulae",children:e.map(i=>(0,S.jsx)(Cs,{outdated:i,onAction:t.onAction},i.name))}),(0,S.jsx)(R.List.Section,{title:"Casks",children:r.map(i=>(0,S.jsx)(vs,{outdated:i,onAction:t.onAction},i.name))})]})]})}
