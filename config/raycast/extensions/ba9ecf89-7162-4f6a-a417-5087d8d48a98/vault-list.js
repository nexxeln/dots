"use strict";var Wt=Object.create;var ke=Object.defineProperty;var zt=Object.getOwnPropertyDescriptor;var jt=Object.getOwnPropertyNames;var Bt=Object.getPrototypeOf,Gt=Object.prototype.hasOwnProperty;var Kt=(e,r)=>{for(var t in r)ke(e,t,{get:r[t],enumerable:!0})},rt=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let a of jt(r))!Gt.call(e,a)&&a!==t&&ke(e,a,{get:()=>r[a],enumerable:!(n=zt(r,a))||n.enumerable});return e};var ce=(e,r,t)=>(t=e!=null?Wt(Bt(e)):{},rt(r||!e||!e.__esModule?ke(t,"default",{value:e,enumerable:!0}):t,e)),Ht=e=>rt(ke({},"__esModule",{value:!0}),e);var Cr={};Kt(Cr,{default:()=>Vt});module.exports=Ht(Cr);var Nt=require("@raycast/api");var f=require("@raycast/api"),j=require("react");var m=require("@raycast/api");var p=ce(require("react")),b=require("@raycast/api");var nt=Object.prototype.hasOwnProperty;function xe(e,r){var t,n;if(e===r)return!0;if(e&&r&&(t=e.constructor)===r.constructor){if(t===Date)return e.getTime()===r.getTime();if(t===RegExp)return e.toString()===r.toString();if(t===Array){if((n=e.length)===r.length)for(;n--&&xe(e[n],r[n]););return n===-1}if(!t||typeof e=="object"){n=0;for(t in e)if(nt.call(e,t)&&++n&&!nt.call(r,t)||!(t in r)||!xe(e[t],r[t]))return!1;return Object.keys(r).length===n}}return e!==e&&r!==r}var te=ce(require("node:fs")),Se=ce(require("node:path")),ft=ce(require("node:crypto")),dt=ce(require("node:child_process")),ht=require("node:buffer"),ue=ce(require("node:stream")),pt=require("node:util");var mt=require("react/jsx-runtime");var Ve=globalThis;function Zt(e){let r=(0,p.useRef)(e),t=(0,p.useRef)(0);return xe(e,r.current)||(r.current=e,t.current+=1),(0,p.useMemo)(()=>r.current,[t.current])}function R(e){let r=(0,p.useRef)(e);return r.current=e,r}function Jt(e,r){let t=e instanceof Error?e.message:String(e);return(0,b.showToast)({style:b.Toast.Style.Failure,title:r?.title??"Something went wrong",message:r?.message??t,primaryAction:r?.primaryAction??at(e),secondaryAction:r?.primaryAction?at(e):void 0})}var at=e=>{let r=!0,t="[Extension Name]...",n="";try{let s=JSON.parse((0,te.readFileSync)((0,Se.join)(b.environment.assetsPath,"..","package.json"),"utf8"));t=`[${s.title}]...`,n=`https://raycast.com/${s.owner||s.author}/${s.name}`,(!s.owner||s.access==="public")&&(r=!1)}catch{}let a=b.environment.isDevelopment||r,o=e instanceof Error?e?.stack||e?.message||"":String(e);return{title:a?"Copy Logs":"Report Error",onAction(s){s.hide(),a?b.Clipboard.copy(o):(0,b.open)(`https://github.com/raycast/extensions/issues/new?&labels=extension%2Cbug&template=extension_bug_report.yml&title=${encodeURIComponent(t)}&extension-url=${encodeURI(n)}&description=${encodeURIComponent(`#### Error:
\`\`\`
${o}
\`\`\`
`)}`)}}};function Yt(e,r,t){let n=(0,p.useRef)(0),[a,o]=(0,p.useState)({isLoading:!0}),s=R(e),c=R(t?.abortable),i=R(r||[]),l=R(t?.onError),u=R(t?.onData),g=R(t?.onWillExecute),h=R(t?.failureToastOptions),N=R(a.data),$=(0,p.useRef)(null),d=(0,p.useRef)({page:0}),k=(0,p.useRef)(!1),D=(0,p.useRef)(!0),oe=(0,p.useRef)(50),v=(0,p.useCallback)(()=>(c.current&&(c.current.current?.abort(),c.current.current=new AbortController),++n.current),[c]),w=(0,p.useCallback)((...z)=>{let C=v();g.current?.(z),o(y=>({...y,isLoading:!0}));let q=qt(s.current)(...z);function Q(y){return y.name=="AbortError"||C===n.current&&(l.current?l.current(y):b.environment.launchType!==b.LaunchType.Background&&Jt(y,{title:"Failed to fetch latest data",primaryAction:{title:"Retry",onAction(K){K.hide(),$.current?.(...i.current||[])}},...h.current}),o({error:y,isLoading:!1})),y}return typeof q=="function"?(k.current=!0,q(d.current).then(({data:y,hasMore:K,cursor:Me})=>(C===n.current&&(d.current&&(d.current.cursor=Me,d.current.lastItem=y?.[y.length-1]),u.current&&u.current(y,d.current),K&&(oe.current=y.length),D.current=K,o(Ne=>d.current.page===0?{data:y,isLoading:!1}:{data:(Ne.data||[])?.concat(y),isLoading:!1})),y),y=>(D.current=!1,Q(y)))):(k.current=!1,q.then(y=>(C===n.current&&(u.current&&u.current(y),o({data:y,isLoading:!1})),y),Q))},[u,l,i,s,o,$,g,d,h,v]);$.current=w;let V=(0,p.useCallback)(()=>{d.current={page:0};let z=i.current||[];return w(...z)},[w,i]),G=(0,p.useCallback)(async(z,C)=>{let q;try{if(C?.optimisticUpdate){v(),typeof C?.rollbackOnError!="function"&&C?.rollbackOnError!==!1&&(q=structuredClone(N.current?.value));let Q=C.optimisticUpdate;o(y=>({...y,data:Q(y.data)}))}return await z}catch(Q){if(typeof C?.rollbackOnError=="function"){let y=C.rollbackOnError;o(K=>({...K,data:y(K.data)}))}else C?.optimisticUpdate&&C?.rollbackOnError!==!1&&o(y=>({...y,data:q}));throw Q}finally{C?.shouldRevalidateAfter!==!1&&(b.environment.launchType===b.LaunchType.Background||b.environment.commandMode==="menu-bar"?await V():V())}},[V,N,o,v]),ie=(0,p.useCallback)(()=>{d.current.page+=1;let z=i.current||[];w(...z)},[d,i,w]);(0,p.useEffect)(()=>{d.current={page:0},t?.execute!==!1?w(...r||[]):v()},[Zt([r,t?.execute,w]),c,d]),(0,p.useEffect)(()=>()=>{v()},[v]);let Y=t?.execute!==!1?a.isLoading:!1,ye={...a,isLoading:Y},Fe=k.current?{pageSize:oe.current,hasMore:D.current,onLoadMore:ie}:void 0;return{...ye,revalidate:V,mutate:G,pagination:Fe}}function qt(e){return e===Promise.all||e===Promise.race||e===Promise.resolve||e===Promise.reject?e.bind(Promise):e}function st(e){return typeof e!="function"?!1:/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(e))!==null}function Qt(e){return e instanceof URLSearchParams?e.toString():e}function gt(e,r=[]){function t(n){return"update"in e?e.update(n,"utf8"):e.write(n)}return{dispatch:function(n){n=Qt(n),n===null?this._null():this["_"+typeof n](n)},_object:function(n){let a=/\[object (.*)\]/i,o=Object.prototype.toString.call(n),s=a.exec(o)?.[1]??"unknown:["+o+"]";s=s.toLowerCase();let c=null;if((c=r.indexOf(n))>=0){this.dispatch("[CIRCULAR:"+c+"]");return}else r.push(n);if(Buffer.isBuffer(n))return t("buffer:"),t(n.toString("utf8"));if(s!=="object"&&s!=="function"&&s!=="asyncfunction")if(this["_"+s])this["_"+s](n);else throw new Error('Unknown object type "'+s+'"');else{let i=Object.keys(n);i=i.sort(),st(n)||i.splice(0,0,"prototype","__proto__","constructor"),t("object:"+i.length+":");let l=this;return i.forEach(function(u){l.dispatch(u),t(":"),l.dispatch(n[u]),t(",")})}},_array:function(n,a){a=typeof a<"u"?a:!1;let o=this;if(t("array:"+n.length+":"),!a||n.length<=1){n.forEach(function(i){o.dispatch(i)});return}let s=[],c=n.map(function(i){let l=Xt(),u=r.slice();return gt(l,u).dispatch(i),s=s.concat(u.slice(r.length)),l.read().toString()});r=r.concat(s),c.sort(),this._array(c,!1)},_date:function(n){t("date:"+n.toJSON())},_symbol:function(n){t("symbol:"+n.toString())},_error:function(n){t("error:"+n.toString())},_boolean:function(n){t("bool:"+n.toString())},_string:function(n){t("string:"+n.length+":"),t(n.toString())},_function:function(n){t("fn:"),st(n)?this.dispatch("[native]"):this.dispatch(n.toString()),this.dispatch("function-name:"+String(n.name)),this._object(n)},_number:function(n){t("number:"+n.toString())},_xml:function(n){t("xml:"+n.toString())},_null:function(){t("Null")},_undefined:function(){t("Undefined")},_regexp:function(n){t("regex:"+n.toString())},_uint8array:function(n){t("uint8array:"),this.dispatch(Array.prototype.slice.call(n))},_uint8clampedarray:function(n){t("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(n))},_int8array:function(n){t("int8array:"),this.dispatch(Array.prototype.slice.call(n))},_uint16array:function(n){t("uint16array:"),this.dispatch(Array.prototype.slice.call(n))},_int16array:function(n){t("int16array:"),this.dispatch(Array.prototype.slice.call(n))},_uint32array:function(n){t("uint32array:"),this.dispatch(Array.prototype.slice.call(n))},_int32array:function(n){t("int32array:"),this.dispatch(Array.prototype.slice.call(n))},_float32array:function(n){t("float32array:"),this.dispatch(Array.prototype.slice.call(n))},_float64array:function(n){t("float64array:"),this.dispatch(Array.prototype.slice.call(n))},_arraybuffer:function(n){t("arraybuffer:"),this.dispatch(new Uint8Array(n))},_url:function(n){t("url:"+n.toString())},_map:function(n){t("map:");let a=Array.from(n);this._array(a,!0)},_set:function(n){t("set:");let a=Array.from(n);this._array(a,!0)},_file:function(n){t("file:"),this.dispatch([n.name,n.size,n.type,n.lastModified])},_blob:function(){throw Error(`Hashing Blob objects is currently not supported
(see https://github.com/puleos/object-hash/issues/26)
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow:function(){t("domwindow")},_bigint:function(n){t("bigint:"+n.toString())},_process:function(){t("process")},_timer:function(){t("timer")},_pipe:function(){t("pipe")},_tcp:function(){t("tcp")},_udp:function(){t("udp")},_tty:function(){t("tty")},_statwatcher:function(){t("statwatcher")},_securecontext:function(){t("securecontext")},_connection:function(){t("connection")},_zlib:function(){t("zlib")},_context:function(){t("context")},_nodescript:function(){t("nodescript")},_httpparser:function(){t("httpparser")},_dataview:function(){t("dataview")},_signal:function(){t("signal")},_fsevent:function(){t("fsevent")},_tlswrap:function(){t("tlswrap")}}}function Xt(){return{buf:"",write:function(e){this.buf+=e},end:function(e){this.buf+=e},read:function(){return this.buf}}}function er(e,r){let t=this[e];return t instanceof Date?`__raycast_cached_date__${t.toISOString()}`:Buffer.isBuffer(t)?`__raycast_cached_buffer__${t.toString("base64")}`:r}function tr(e,r){return typeof r=="string"&&r.startsWith("__raycast_cached_date__")?new Date(r.replace("__raycast_cached_date__","")):typeof r=="string"&&r.startsWith("__raycast_cached_buffer__")?Buffer.from(r.replace("__raycast_cached_buffer__",""),"base64"):r}function ot(e){let r=ft.default.createHash("sha1");return gt(r).dispatch(e),r.digest("hex")}var rr=Symbol("cache without namespace"),it=new Map;function He(e,r,t){let n=t?.cacheNamespace||rr,a=it.get(n)||it.set(n,new b.Cache({namespace:t?.cacheNamespace})).get(n);if(!a)throw new Error("Missing cache");let o=R(e),s=R(r),c=(0,p.useSyncExternalStore)(a.subscribe,()=>{try{return a.get(o.current)}catch(g){console.error("Could not get Cache data:",g);return}}),i=(0,p.useMemo)(()=>{if(typeof c<"u"){if(c==="undefined")return;try{return JSON.parse(c,tr)}catch(g){return console.warn("The cached data is corrupted",g),s.current}}else return s.current},[c,s]),l=R(i),u=(0,p.useCallback)(g=>{let h=typeof g=="function"?g(l.current):g;if(typeof h>"u")a.set(o.current,"undefined");else{let N=JSON.stringify(h,er);a.set(o.current,N)}return h},[a,o,l]);return[i,u]}var le=Symbol();function nr(e,r,t){let{initialData:n,keepPreviousData:a,internal_cacheKeySuffix:o,...s}=t||{},c=(0,p.useRef)(null),[i,l]=He(ot(r||[])+o,le,{cacheNamespace:ot(e)}),u=(0,p.useRef)(i!==le?i:n),g=(0,p.useRef)(void 0),{mutate:h,revalidate:N,...$}=Yt(e,r||[],{...s,onData(v,w){g.current=w,s.onData&&s.onData(v,w),!(w&&w.page>0)&&(c.current="promise",u.current=v,l(v))}}),d,k=$.pagination;g.current&&g.current.page>0&&$.data?d=$.data:c.current==="promise"?d=u.current:a&&i!==le?(d=i,k&&(k.hasMore=!0,k.pageSize=i.length)):a&&i===le?d=u.current:i!==le?(d=i,k&&(k.hasMore=!0,k.pageSize=i.length)):d=n;let D=R(d),oe=(0,p.useCallback)(async(v,w)=>{let V;try{if(w?.optimisticUpdate){typeof w?.rollbackOnError!="function"&&w?.rollbackOnError!==!1&&(V=structuredClone(D.current));let G=w.optimisticUpdate(D.current);c.current="cache",u.current=G,l(G)}return await h(v,{shouldRevalidateAfter:w?.shouldRevalidateAfter})}catch(G){if(typeof w?.rollbackOnError=="function"){let ie=w.rollbackOnError(D.current);c.current="cache",u.current=ie,l(ie)}else w?.optimisticUpdate&&w?.rollbackOnError!==!1&&(c.current="cache",u.current=V,l(V));throw G}},[l,h,D,u,c]);return(0,p.useEffect)(()=>{i!==le&&(c.current="cache",u.current=i)},[i]),{data:d,isLoading:$.isLoading,error:$.error,mutate:g.current&&g.current.page>0?h:oe,pagination:k,revalidate:N}}var ve=e=>!!e&&typeof e=="object"&&typeof e.removeListener=="function"&&typeof e.emit=="function"&&typeof e.reallyExit=="function"&&typeof e.listeners=="function"&&typeof e.kill=="function"&&typeof e.pid=="number"&&typeof e.on=="function",We=Symbol.for("signal-exit emitter"),je=class{constructor(){if(this.emitted={afterExit:!1,exit:!1},this.listeners={afterExit:[],exit:[]},this.count=0,this.id=Math.random(),Ve[We])return Ve[We];Object.defineProperty(Ve,We,{value:this,writable:!1,enumerable:!1,configurable:!1})}on(r,t){this.listeners[r].push(t)}removeListener(r,t){let n=this.listeners[r],a=n.indexOf(t);a!==-1&&(a===0&&n.length===1?n.length=0:n.splice(a,1))}emit(r,t,n){if(this.emitted[r])return!1;this.emitted[r]=!0;let a=!1;for(let o of this.listeners[r])a=o(t,n)===!0||a;return r==="exit"&&(a=this.emit("afterExit",t,n)||a),a}},Be=class{onExit(){return()=>{}}load(){}unload(){}},Ge=class{#i;#t;#e;#s;#o;#a;#n;#r;constructor(r){this.#i=process.platform==="win32"?"SIGINT":"SIGHUP",this.#t=new je,this.#a={},this.#n=!1,this.#r=[],this.#r.push("SIGHUP","SIGINT","SIGTERM"),globalThis.process.platform!=="win32"&&this.#r.push("SIGALRM","SIGABRT","SIGVTALRM","SIGXCPU","SIGXFSZ","SIGUSR2","SIGTRAP","SIGSYS","SIGQUIT","SIGIOT"),globalThis.process.platform==="linux"&&this.#r.push("SIGIO","SIGPOLL","SIGPWR","SIGSTKFLT"),this.#e=r,this.#a={};for(let t of this.#r)this.#a[t]=()=>{let n=this.#e.listeners(t),{count:a}=this.#t,o=r;if(typeof o.__signal_exit_emitter__=="object"&&typeof o.__signal_exit_emitter__.count=="number"&&(a+=o.__signal_exit_emitter__.count),n.length===a){this.unload();let s=this.#t.emit("exit",null,t),c=t==="SIGHUP"?this.#i:t;s||r.kill(r.pid,c)}};this.#o=r.reallyExit,this.#s=r.emit}onExit(r,t){if(!ve(this.#e))return()=>{};this.#n===!1&&this.load();let n=t?.alwaysLast?"afterExit":"exit";return this.#t.on(n,r),()=>{this.#t.removeListener(n,r),this.#t.listeners.exit.length===0&&this.#t.listeners.afterExit.length===0&&this.unload()}}load(){if(!this.#n){this.#n=!0,this.#t.count+=1;for(let r of this.#r)try{let t=this.#a[r];t&&this.#e.on(r,t)}catch{}this.#e.emit=(r,...t)=>this.#l(r,...t),this.#e.reallyExit=r=>this.#c(r)}}unload(){this.#n&&(this.#n=!1,this.#r.forEach(r=>{let t=this.#a[r];if(!t)throw new Error("Listener not defined for signal: "+r);try{this.#e.removeListener(r,t)}catch{}}),this.#e.emit=this.#s,this.#e.reallyExit=this.#o,this.#t.count-=1)}#c(r){return ve(this.#e)?(this.#e.exitCode=r||0,this.#t.emit("exit",this.#e.exitCode,null),this.#o.call(this.#e,this.#e.exitCode)):0}#l(r,...t){let n=this.#s;if(r==="exit"&&ve(this.#e)){typeof t[0]=="number"&&(this.#e.exitCode=t[0]);let a=n.call(this.#e,r,...t);return this.#t.emit("exit",this.#e.exitCode,null),a}else return n.call(this.#e,r,...t)}},ze=null,ar=(e,r)=>(ze||(ze=ve(process)?new Ge(process):new Be),ze.onExit(e,r));function sr(e,{timeout:r}={}){let t=new Promise((c,i)=>{e.on("exit",(l,u)=>{c({exitCode:l,signal:u,timedOut:!1})}),e.on("error",l=>{i(l)}),e.stdin&&e.stdin.on("error",l=>{i(l)})}),n=ar(()=>{e.kill()});if(r===0||r===void 0)return t.finally(()=>n());let a,o=new Promise((c,i)=>{a=setTimeout(()=>{e.kill("SIGTERM"),i(Object.assign(new Error("Timed out"),{timedOut:!0,signal:"SIGTERM"}))},r)}),s=t.finally(()=>{clearTimeout(a)});return Promise.race([o,s]).finally(()=>n())}var Ke=class extends Error{constructor(){super("The output is too big"),this.name="MaxBufferError"}};function or(e){let{encoding:r}=e,t=r==="buffer",n=new ue.default.PassThrough({objectMode:!1});r&&r!=="buffer"&&n.setEncoding(r);let a=0,o=[];return n.on("data",s=>{o.push(s),a+=s.length}),n.getBufferedValue=()=>t?Buffer.concat(o,a):o.join(""),n.getBufferedLength=()=>a,n}async function ct(e,r){let t=or(r);return await new Promise((n,a)=>{let o=s=>{s&&t.getBufferedLength()<=ht.constants.MAX_LENGTH&&(s.bufferedData=t.getBufferedValue()),a(s)};(async()=>{try{await(0,pt.promisify)(ue.default.pipeline)(e,t),n()}catch(s){o(s)}})(),t.on("data",()=>{t.getBufferedLength()>8e7&&o(new Ke)})}),t.getBufferedValue()}async function lt(e,r){e.destroy();try{return await r}catch(t){return t.bufferedData}}async function ir({stdout:e,stderr:r},{encoding:t},n){let a=ct(e,{encoding:t}),o=ct(r,{encoding:t});try{return await Promise.all([n,a,o])}catch(s){return Promise.all([{error:s,exitCode:null,signal:s.signal,timedOut:s.timedOut||!1},lt(e,a),lt(r,o)])}}function cr(e){let r=typeof e=="string"?`
`:10,t=typeof e=="string"?"\r":13;return e[e.length-1]===r&&(e=e.slice(0,-1)),e[e.length-1]===t&&(e=e.slice(0,-1)),e}function ut(e,r){return e.stripFinalNewline?cr(r):r}function lr({timedOut:e,timeout:r,signal:t,exitCode:n}){return e?`timed out after ${r} milliseconds`:t!=null?`was killed with ${t}`:n!=null?`failed with exit code ${n}`:"failed"}function ur({stdout:e,stderr:r,error:t,signal:n,exitCode:a,command:o,timedOut:s,options:c,parentError:i}){let u=`Command ${lr({timedOut:s,timeout:c?.timeout,signal:n,exitCode:a})}: ${o}`,g=t?`${u}
${t.message}`:u,h=[g,r,e].filter(Boolean).join(`
`);return t?t.originalMessage=t.message:t=i,t.message=h,t.shortMessage=g,t.command=o,t.exitCode=a,t.signal=n,t.stdout=e,t.stderr=r,"bufferedData"in t&&delete t.bufferedData,t}function fr({stdout:e,stderr:r,error:t,exitCode:n,signal:a,timedOut:o,command:s,options:c,parentError:i}){if(t||n!==0||a!==null)throw ur({error:t,exitCode:n,signal:a,stdout:e,stderr:r,command:s,timedOut:o,options:c,parentError:i});return e}var dr=/ +/g;function hr(e,r){if(r)return[e,...r];let t=[];for(let n of e.trim().split(dr)){let a=t[t.length-1];a&&a.endsWith("\\")?t[t.length-1]=`${a.slice(0,-1)} ${n}`:t.push(n)}return t}function Ee(e,r,t){let{parseOutput:n,input:a,onData:o,onWillExecute:s,initialData:c,execute:i,keepPreviousData:l,onError:u,failureToastOptions:g,...h}=Array.isArray(r)?t||{}:r||{},N={initialData:c,execute:i,keepPreviousData:l,onError:u,onData:o,onWillExecute:s,failureToastOptions:g},$=(0,p.useRef)(null),d=R(n||fr),k=(0,p.useCallback)(async(D,oe,v,w)=>{let[V,...G]=hr(D,oe),ie=[V,...G].join(" "),Y={stripFinalNewline:!0,...v,timeout:v?.timeout||1e4,signal:$.current?.signal,encoding:v?.encoding===null?"buffer":v?.encoding||"utf8",env:{PATH:"/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin",...process.env,...v?.env}},ye=dt.default.spawn(V,G,Y),Fe=sr(ye,Y);w&&ye.stdin.end(w);let[{error:z,exitCode:C,signal:q,timedOut:Q},y,K]=await ir(ye,Y,Fe),Me=ut(Y,y),Ne=ut(Y,K);return d.current({stdout:Me,stderr:Ne,error:z,exitCode:C,signal:q,timedOut:Q,command:ie,options:Y,parentError:new Error})},[d]);return nr(k,[e,Array.isArray(r)?r:[],h,a],{...N,abortable:$})}var be=require("node:child_process"),Je=require("node:fs"),Ae=(0,m.getPreferenceValues)(),I=class extends Error{title;constructor(r,t){t||(t=r),super(t),this.title=r}},F=class extends I{},H=class extends I{},Ze=class extends I{},Ce=class extends I{},P=()=>{let e=[Ae.cliPath,"/usr/local/bin/op","/opt/homebrew/bin/op"].filter(Boolean).find(r=>r?(0,Je.existsSync)(r):!1);if(!e)throw new F("1Password CLI is not found. Please set the path in the extension preferences.");return e},fe=[Ae.zshPath,"/bin/zsh"].find(e=>(0,Je.existsSync)(e)),yt=new RegExp(/\[\w+\]\s+\d{4}\/\d{2}\/\d{2}\s+\d{2}:\d{2}:\d{2}\s+(.*)$/m);function bt(e){let r=["open-in-1password","open-in-browser","copy-username","copy-password","copy-one-time-password","paste-username","paste-password","paste-one-time-password","share-item","switch-account"],t=[...new Set([Ae.primaryAction,Ae.secondaryAction,...r])];switch(e.category){case"LOGIN":return t;case"PASSWORD":return t.filter(n=>n!=="copy-username"&&n!=="paste-username");default:return["open-in-1password"]}}function $t(e){if(e.category==="LOGIN")return e.urls?.find(r=>r.primary)?.href}function wt(e){let r=P();if(r)return(0,be.execFileSync)(r,e,{maxBuffer:4194304}).toString();throw Error("1Password CLI is not found!")}var _=e=>{throw e.includes("no such host")?new H("No connection to 1Password.","Verify Your Internet Connection."):e.includes("could not get item")||e.includes("isn't an item")?new Ze("Item not found on 1Password.","Check it on your 1Password app."):e.includes("ENOENT")||e.includes("file")||e.includes("enoent")?new F("1Password CLI not found."):e.includes("does not have a field")?new I(`Item does not contain the field ${e.split("does not have a field ")[1].trim()}.`):new I(e)},kt=()=>!!fe,$e=e=>(0,be.execSync)(`${P()} signin ${e||""}`,{shell:fe}),xt=()=>{try{return(0,be.execSync)(`${P()} whoami`),!0}catch{return!1}},Ye=(e,r)=>Ee(P(),[...e,"--format=json"],{onError:async t=>{await(0,m.showToast)({style:m.Toast.Style.Failure,title:t.message})},parseOutput:({error:t,exitCode:n,stderr:a,stdout:o})=>(t&&_(t.message),a&&_(a),n!=0&&_(o),r?r(JSON.parse(o)):JSON.parse(o))}),vt=({account:e,execute:r=!0,flags:t=[]})=>Ee(P(),["--account",e,"items","list","--long","--format=json",...t],{execute:r,onError:async n=>{await(0,m.showToast)({style:m.Toast.Style.Failure,title:n.message})},parseOutput:({error:n,exitCode:a,stderr:o,stdout:s})=>(n&&_(n.message),o&&_(o),a!=0&&_(s),JSON.parse(s).sort((i,l)=>i.favorite&&!l.favorite?-1:!i.favorite&&l.favorite?1:i.title.localeCompare(l.title)))});var St=()=>Ye(["vault","list"],e=>e.sort((r,t)=>r.name.localeCompare(t.name))),Et=()=>Ye(["item","template","list"],e=>e.sort((r,t)=>r.name.localeCompare(t.name))),Pe=()=>Ye(["whoami"]),Ie=(e=!0)=>Ee(P(),["account","list","--format=json"],{execute:e,onError:async r=>{await(0,m.showToast)({style:m.Toast.Style.Failure,title:r.message})},parseOutput:({error:r,exitCode:t,stderr:n,stdout:a})=>(r&&_(r.message),n&&_(n),t!=0&&_(a),JSON.parse(a))});function Te(e){switch(e){case"API_CREDENTIAL":return m.Icon.Code;case"BANK_ACCOUNT":case"CUSTOM":return m.Icon.Wallet;case"CREDIT_CARD":return m.Icon.CreditCard;case"CRYPTO_WALLET":return m.Icon.Crypto;case"DATABASE":return m.Icon.HardDrive;case"DOCUMENT":return m.Icon.Document;case"DRIVER_LICENSE":return m.Icon.Car;case"EMAIL_ACCOUNT":return m.Icon.Envelope;case"IDENTITY":return m.Icon.Person;case"LOGIN":return m.Icon.Fingerprint;case"MEDICAL_RECORD":return m.Icon.Heartbeat;case"MEMBERSHIP":return m.Icon.StarCircle;case"OUTDOOR_LICENSE":return m.Icon.Tree;case"PASSPORT":return m.Icon.Globe;case"PASSWORD":return m.Icon.Key;case"REWARD_PROGRAM":return m.Icon.Gift;case"SECURE_NOTE":return m.Icon.Lock;case"SERVER":case"SSH_KEY":return m.Icon.Terminal;case"SOCIAL_SECURITY_NUMBER":return m.Icon.Shield;case"SOFTWARE_LICENSE":return m.Icon.CodeBlock;case"WIRELESS_ROUTER":return m.Icon.Wifi;default:return m.Icon.Key}}function qe(e){return e&&e[0].toUpperCase()+e.slice(1).toLowerCase()}var U=require("@raycast/api");var de=require("@raycast/api");async function re(){let e=await(0,de.showToast)({style:de.Toast.Style.Animated,title:"Clearing cache..."});try{wt(["signout","--all"]),e.style=de.Toast.Style.Success,e.title="Cleared cache"}catch(r){e.style=de.Toast.Style.Failure,e.title="Failed to clear cache",r instanceof Error&&(e.message=r.message)}}var ne=require("react/jsx-runtime");function X(){let e=P(),r=`
${e?"":"# 1Password CLI Tool Not Configured or Installed Properly"}
${e?"":"# Zsh Shell Not Configured or Installed Properly"}

${e?"":`
-  Ensure that the 1Password CLI is installed on your system. You can download it from [official 1Password CLI website](https://developer.1password.com/docs/cli/get-started).
-  Check if the path to the 1Password CLI is correctly added to your system's environment variables.
-  Run \`op --version\` to verify that the 1Password CLI is correctly installed.
`}


${fe?"":"\n-  Make sure that Zsh is installed by running `zsh --version` in your terminal.\n-  Review your `.zshrc` file for any incorrect configurations that might be causing issues.\n-  Review your extension preferences for the Zsh shell path.\n"}

### Need More Help?
If you continue to experience problems after following these steps, please reach out by opening an issue in our [Github](https://github.com/raycast/extensions/issues/new/choose)

We're here to help ensure a smooth setup process!

---`;return(0,ne.jsx)(U.Detail,{actions:(0,ne.jsxs)(U.ActionPanel,{children:[(0,ne.jsx)(U.Action,{icon:U.Icon.Gear,onAction:U.openExtensionPreferences,title:"Open Extension Preferences"}),(0,ne.jsx)(U.Action.Open,{target:"onepassword://settings",title:"Open 1Password Settings"}),(0,ne.jsx)(U.Action,{icon:U.Icon.Trash,onAction:()=>re(),title:"Reset Cache"})]}),markdown:r})}var E=require("@raycast/api"),Qe=require("node:path");var ae=require("react/jsx-runtime"),pr=(0,Qe.join)(E.environment.assetsPath,"binary-instruction.png"),mr=(0,Qe.join)(E.environment.assetsPath,"1password-settings.png"),gr=`
# You will need the following to run the extension

## \u2705 1Password CLI

### This extension utilizes the 1Password CLI tool. You can setup the tool by following their [official document](https://developer.1password.com/docs/cli/get-started/).

### In case there's an issue with the tool, check the following.
![Terminal Instruction](${pr})

## \u2705 Enable Command-Line Interface (CLI)

### To turn on the app integration and set up 1Password to authenticate with biometrics:
![1Password Settings](${mr})

1. Open [1Password](onepassword://settings).
2. Select the account or collection at the top of the sidebar and choose Preferences > Security.
3. Check [Touch ID](https://support.1password.com/touch-id-mac/).
4. Select Developer in the sidebar.
5. Check "Connect with 1Password CLI".

You can also unlock 1Password CLI with your [Apple Watch](https://support.1password.com/apple-watch-mac/).
`;function Re(){return(0,ae.jsx)(E.Detail,{actions:(0,ae.jsxs)(E.ActionPanel,{children:[(0,ae.jsx)(E.Action,{icon:E.Icon.Gear,onAction:E.openExtensionPreferences,title:"Open Extension Preferences"}),(0,ae.jsx)(E.Action.Open,{target:"onepassword://settings",title:"Open 1Password Settings"}),(0,ae.jsx)(E.Action,{icon:E.Icon.Trash,onAction:()=>re(),title:"Reset Cache"})]}),markdown:gr})}var O=require("react/jsx-runtime"),yr=(0,j.createContext)(void 0),At=({children:e})=>{try{P()}catch{return(0,O.jsx)(Re,{})}let[r,t]=(0,j.useState)(xt()),[n]=(0,j.useState)(!kt()),[a,o]=(0,j.useState)(!0),[s,c]=(0,j.useState)(""),{data:i,error:l,isLoading:u}=Ie(!a),g=f.environment.raycastVersion.includes("alpha")?"raycastinternal://":"raycast://",h=async $=>{let d=await(0,f.showToast)({style:f.Toast.Style.Animated,title:"Signing in..."});try{$e(`--account ${$.account}`),t(!0),o(!0),d.style=f.Toast.Style.Success,d.title="Signed in"}catch(k){d.style=f.Toast.Style.Failure,d.title="Failed to sign in",k instanceof Error&&(d.message=k.message,d.primaryAction={onAction:async D=>{await f.Clipboard.copy(k.message),D.hide()},title:"Copy logs"})}},N=async()=>{await(0,f.closeMainWindow)({popToRootType:f.PopToRootType.Suspended});let $=await(0,f.showToast)({style:f.Toast.Style.Animated,title:"Authenticating..."});try{if(!fe)throw new Ce("Zsh Binary Path Missing!");if(!P())throw new F("1Password CLI is missing! Please install it before use.");$e(),t(!0),o(!0),$.style=f.Toast.Style.Success,$.title="Authenticated!";return}catch(d){if(!(d instanceof Error)){$.style=f.Toast.Style.Failure,$.title="Error Authenticating.",$.message=String(d);return}let k=d.message.match(yt);if(k&&k[1]?c(k[1]):c(d.message),d.message.includes("multiple accounts found"))return o(!1);$.style=f.Toast.Style.Failure,$.title="Error Authenticating."}finally{await(0,f.open)(g)}};return(0,j.useEffect)(()=>{!r&&!n&&N()},[r,n]),a?n?(0,O.jsx)(X,{}):r?(0,O.jsx)(yr.Provider,{value:{isAuthenticated:r},children:e}):(0,O.jsx)(f.List,{children:(0,O.jsx)(f.List.EmptyView,{actions:(0,O.jsx)(f.ActionPanel,{children:(0,O.jsx)(f.Action,{icon:f.Icon.Repeat,onAction:()=>N(),title:"Reload"},"reload-view")}),description:s||"Please authenticate using the requested method to proceed.",icon:f.Icon.Key,title:"Authentication Required"})}):(0,O.jsx)(f.Form,{actions:(0,O.jsx)(f.ActionPanel,{children:(0,O.jsx)(f.Action.SubmitForm,{icon:f.Icon.Key,onSubmit:h,title:"Sign in"})}),isLoading:u,children:(0,O.jsx)(f.Form.Dropdown,{autoFocus:!0,id:"account",title:"Account",children:(i&&!l?i:[]).map($=>(0,O.jsx)(f.Form.Dropdown.Item,{title:`${$.url} - ${$.email}`,value:$.account_uuid},$.account_uuid))})})};var M=require("@raycast/api"),De=require("react");var J=require("@raycast/api");var me=require("@raycast/api");var S=require("@raycast/api"),Lt=require("react");var L=require("@raycast/api");var Oe=require("react");var he=require("@raycast/api");var pe=require("react/jsx-runtime"),we="null";function Ct({onCategoryChange:e}){let{data:r,error:t,isLoading:n}=Et();return t?(0,pe.jsx)(X,{}):(0,pe.jsxs)(he.List.Dropdown,{defaultValue:we,isLoading:n,onChange:e,storeValue:!0,tooltip:"Select Category",children:[(0,pe.jsx)(he.List.Dropdown.Item,{icon:he.Icon.AppWindowGrid3x3,title:"All Categories",value:we},"000"),(r||[]).map(a=>(0,pe.jsx)(he.List.Dropdown.Item,{icon:Te(a.name.replaceAll(" ","_").toUpperCase()),title:a.name,value:a.name},a.uuid))]})}var Z=require("@raycast/api");var x=require("@raycast/api"),Xe=require("node:child_process");var Pt=require("@raycast/api"),_e=require("react");function It(e=!1){let[r,t]=(0,_e.useState)({});return(0,_e.useEffect)(()=>{if(!e)return;(async()=>{try{let a=await(0,Pt.getFrontmostApplication)();t({icon:a.path?{fileIcon:a.path}:void 0,name:a.name})}catch{t({})}})()},[e]),r}var Tt=require("react/jsx-runtime");function se({attribute:e,field:r="password",id:t,isPasteAction:n,shortcut:a,vault_id:o}){let s=P(),c=It(!!n);return(0,Tt.jsx)(x.Action,{icon:n?c.icon??x.Icon.Text:x.Icon.Clipboard,onAction:async()=>{let i=await(0,x.showToast)({style:x.Toast.Style.Animated,title:n?`Pasting ${r}${c.name?` to ${c.name}`:""}...`:`Copying ${r}...`});try{let l;if(e==="otp")l=(0,Xe.execFileSync)(s,["item","get",t,"--otp"]);else{let g=e?`?attribute=${e}`:"",h=`op://${o}/${t}/${r}${g}`;l=(0,Xe.execFileSync)(s,["read",h])}let u=l.toString().trim();n?(await x.Clipboard.paste(u),i.style=x.Toast.Style.Success,i.title=`Pasted ${r}${c.name?` to ${c.name}`:""}`,await(0,x.showHUD)(`Pasted ${r}${c.name?` to ${c.name}`:""}`)):(await x.Clipboard.copy(u,{concealed:!0}),i.style=x.Toast.Style.Success,i.title="Copied to clipboard",await(0,x.showHUD)(`Copied ${r} to clipboard`))}catch(l){if(i.style=x.Toast.Style.Failure,i.title=`Failed to ${n?"paste":"copy"}`,l instanceof Error||l instanceof I)try{_(l.message)}catch(u){u instanceof I?(u.title!=u.message&&(i.message=u.message),i.title=u.title,i.primaryAction={onAction:async g=>{await x.Clipboard.copy(u.message),g.hide()},title:"Copy logs"}):u instanceof Error&&(i.title=u.message,i.primaryAction={onAction:async g=>{await x.Clipboard.copy(u.message),g.hide()},title:"Copy logs"})}}},shortcut:a,title:n?`Paste ${qe(r)}${c.name?` to ${c.name}`:""}`:`Copy ${qe(r)}`})}var A=require("@raycast/api"),Rt=require("node:child_process");var Ut=require("react/jsx-runtime");function _t({id:e,shortcut:r,title:t}){return(0,Ut.jsx)(A.Action,{icon:A.Icon.Link,onAction:async()=>{let n=await(0,A.showToast)({style:A.Toast.Style.Animated,title:`Sharing ${t}...`});try{let a=(0,Rt.execFileSync)(P(),["item","share",e]);await A.Clipboard.copy(a.toString().trim(),{concealed:!0}),n.style=A.Toast.Style.Success,n.title="Copied to clipboard",await(0,A.showHUD)("Copied sharing link to clipboard")}catch(a){if(n.style=A.Toast.Style.Failure,n.title="Failed to copy",a instanceof Error||a instanceof I)try{_(a.message)}catch(o){o instanceof I?(o.title!=o.message&&(n.message=o.message),n.title=o.title,n.primaryAction={onAction:async s=>{await A.Clipboard.copy(o.message),s.hide()},title:"Copy logs"}):o instanceof Error&&(n.title=o.message,n.primaryAction={onAction:async s=>{await A.Clipboard.copy(o.message),s.hide()},title:"Copy logs"})}}},shortcut:r,title:"Share Item"})}var T=require("react/jsx-runtime");function Ot({account:e,actions:r,item:t}){return(0,T.jsxs)(Z.ActionPanel,{children:[r.map(n=>{switch(n){case"copy-one-time-password":return br(t);case"copy-password":return $r(t);case"copy-username":return kr(t);case"open-in-1password":return xr(e,t);case"open-in-browser":return vr(t);case"paste-one-time-password":return Sr(t);case"paste-password":return Er(t);case"paste-username":return Ar(t);case"share-item":return wr(t)}}),(0,T.jsxs)(Z.ActionPanel.Section,{children:[Ue(),(0,T.jsx)(Z.Action,{icon:Z.Icon.Trash,onAction:()=>re(),title:"Reset Cache"})]})]})}function br(e){return(0,T.jsx)(se,{attribute:"otp",field:"one-time password",id:e.id,shortcut:{key:"c",modifiers:["cmd","ctrl"]},vault_id:e.vault.id},"copy-one-time-password")}function $r(e){return(0,T.jsx)(se,{field:"password",id:e.id,shortcut:{key:"c",modifiers:["cmd","opt"]},vault_id:e.vault.id},"copy-password")}function wr(e){return(0,T.jsx)(_t,{id:e.id,shortcut:{key:"s",modifiers:["cmd","shift"]},title:e.title},"share-item")}function kr(e){return(0,T.jsx)(se,{field:"username",id:e.id,shortcut:{key:"c",modifiers:["cmd","shift"]},vault_id:e.vault.id},"copy-username")}function xr(e,r){return e?(0,T.jsx)(Z.Action.Open,{application:"com.1password.1password",shortcut:{key:"o",modifiers:["cmd","shift"]},target:`onepassword://view-item/?a=${e.account_uuid}&v=${r.vault.id}&i=${r.id}`,title:"Open in 1Password"},"open-in-1password"):null}function vr(e){let r=$t(e);return r?(0,T.jsx)(Z.Action.OpenInBrowser,{shortcut:{key:"return",modifiers:["opt"]},title:"Open in Browser",url:r},"open-in-browser"):null}function Sr(e){return(0,T.jsx)(se,{attribute:"otp",field:"one-time password",id:e.id,isPasteAction:!0,shortcut:{key:"v",modifiers:["cmd","ctrl"]},vault_id:e.vault.id},"paste-one-time-password")}function Er(e){return(0,T.jsx)(se,{field:"password",id:e.id,isPasteAction:!0,shortcut:{key:"v",modifiers:["cmd","opt"]},vault_id:e.vault.id},"paste-password")}function Ar(e){return(0,T.jsx)(se,{field:"username",id:e.id,isPasteAction:!0,shortcut:{key:"v",modifiers:["cmd","shift"]},vault_id:e.vault.id},"paste-username")}var W=require("react/jsx-runtime");function Le({flags:e}){let[r,t]=He("selected_category",we),[n,a]=(0,Oe.useState)([]),{data:o,error:s,isLoading:c}=Pe(),{data:i,error:l,isLoading:u}=vt({account:o?.account_uuid??"",execute:!s&&!c,flags:e});(0,Oe.useMemo)(()=>{if(i){if(r===we)return a(i);a(i?.filter(h=>h.category===r.replaceAll(" ","_").toUpperCase()))}},[i,r]);let g=h=>{r!==h&&t(h)};return l instanceof F||s instanceof F?(0,W.jsx)(X,{}):l instanceof H||s instanceof H?(0,W.jsx)(L.List,{children:(0,W.jsx)(L.List.EmptyView,{description:l?.message||s?.message,icon:L.Icon.WifiDisabled,title:l?.title||s?.title})}):(0,W.jsxs)(L.List,{isLoading:u||c,searchBarAccessory:(0,W.jsx)(Ct,{onCategoryChange:g}),children:[(0,W.jsx)(L.List.EmptyView,{description:"Any items you have added in 1Password app will be listed here.",icon:"1password-noview.png",title:"No items found"}),(0,W.jsx)(L.List.Section,{subtitle:`${n?.length}`,title:"Items",children:n?.length?n.map(h=>(0,W.jsx)(L.List.Item,{accessories:[h?.favorite?{icon:{source:L.Icon.Stars,tintColor:L.Color.Yellow},tooltip:"Favorite item"}:{},{text:h.vault?.name}],actions:(0,W.jsx)(Ot,{account:o,actions:bt(h),item:h}),icon:{tooltip:h.category,value:{source:Te(h.category),tintColor:L.Color.Blue}},id:h.id,keywords:h.additional_information?[h.additional_information]:[],subtitle:h.additional_information,title:h.title},h.id)):null})]})}var ee=require("react/jsx-runtime");function Dt({reset:e=!1}){let[r,t]=(0,Lt.useState)(!1),{data:n,error:a,isLoading:o}=Ie();return a?(0,ee.jsx)(Re,{}):!e||r?(0,ee.jsx)(Le,{}):(0,ee.jsx)(S.Form,{actions:(0,ee.jsx)(S.ActionPanel,{children:(0,ee.jsx)(S.Action.SubmitForm,{icon:S.Icon.Key,onSubmit:async s=>{let c=await(0,S.showToast)({style:S.Toast.Style.Animated,title:"Signing in..."});try{$e(`--account ${s.account}`),t(!0),c.style=S.Toast.Style.Success,c.title="Signed in"}catch(i){c.style=S.Toast.Style.Failure,c.title="Failed to sign in",i instanceof Error&&(c.message=i.message,c.primaryAction={onAction:async l=>{await S.Clipboard.copy(i.message),l.hide()},title:"Copy logs"})}},title:"Sign in"})}),isLoading:o,children:(0,ee.jsx)(S.Form.Dropdown,{autoFocus:!0,id:"account",title:"Account",children:(n||[]).map(s=>(0,ee.jsx)(S.Form.Dropdown.Item,{title:`${s.url} - ${s.email}`,value:s.account_uuid},s.account_uuid))})})}var et=require("react/jsx-runtime");function Ue(){let{push:e}=(0,me.useNavigation)();return(0,et.jsx)(me.Action,{icon:me.Icon.Switch,onAction:()=>e((0,et.jsx)(Dt,{reset:!0})),title:"Switch Account"},"switch-account")}var ge=require("react/jsx-runtime");function Ft({vault:e}){let{push:r}=(0,J.useNavigation)();return(0,ge.jsx)(J.ActionPanel,{children:(0,ge.jsxs)(J.ActionPanel.Section,{children:[(0,ge.jsx)(J.Action,{icon:J.Icon.Folder,onAction:()=>r((0,ge.jsx)(Le,{flags:[`--vault=${e.id}`]})),title:"Enter Vault"}),Ue()]})})}var B=require("react/jsx-runtime");function Mt(){let[e,r]=(0,De.useState)([]),{data:t,error:n,isLoading:a}=Pe(),{data:o,error:s,isLoading:c}=St();return(0,De.useMemo)(()=>{o&&r(o)},[o]),s instanceof F||n instanceof F?(0,B.jsx)(X,{}):s instanceof H||n instanceof H?(0,B.jsx)(M.List,{children:(0,B.jsx)(M.List.EmptyView,{description:s?.message||n?.message,icon:M.Icon.WifiDisabled,title:s?.title||n?.title})}):(0,B.jsxs)(M.List,{isLoading:c||a,children:[(0,B.jsx)(M.List.EmptyView,{description:"Any vaults you have added in 1Password app will be listed here.",icon:"1password-noview.png",title:"No items found"}),(0,B.jsx)(M.List.Section,{subtitle:`${e?.length}`,title:"Vaults",children:e?.length&&e.map(i=>(0,B.jsx)(M.List.Item,{actions:(0,B.jsx)(Ft,{account:t,vault:i}),icon:{tooltip:"Vault",value:{source:M.Icon.Folder,tintColor:M.Color.Blue}},id:i.id,title:i.name},i.id))})]})}var tt=require("react/jsx-runtime");function Vt(){return(0,Nt.getPreferenceValues)().version==="v8"?(0,tt.jsx)(At,{children:(0,tt.jsx)(Mt,{})}):null}
