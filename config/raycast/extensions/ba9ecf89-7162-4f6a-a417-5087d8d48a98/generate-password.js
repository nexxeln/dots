"use strict";var at=Object.create;var ne=Object.defineProperty;var st=Object.getOwnPropertyDescriptor;var it=Object.getOwnPropertyNames;var ot=Object.getPrototypeOf,ct=Object.prototype.hasOwnProperty;var lt=(t,r)=>{for(var e in r)ne(t,e,{get:r[e],enumerable:!0})},Pe=(t,r,e,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let a of it(r))!ct.call(t,a)&&a!==e&&ne(t,a,{get:()=>r[a],enumerable:!(n=st(r,a))||n.enumerable});return t};var H=(t,r,e)=>(e=t!=null?at(ot(t)):{},Pe(r||!t||!t.__esModule?ne(e,"default",{value:t,enumerable:!0}):e,t)),ut=t=>Pe(ne({},"__esModule",{value:!0}),t);var Dt={};lt(Dt,{default:()=>nt});module.exports=ut(Dt);var rt=require("@raycast/api");var h=require("@raycast/api"),D=require("react");var j=require("@raycast/api");var l=H(require("react")),w=require("@raycast/api");var Ce=Object.prototype.hasOwnProperty;function ae(t,r){var e,n;if(t===r)return!0;if(t&&r&&(e=t.constructor)===r.constructor){if(e===Date)return t.getTime()===r.getTime();if(e===RegExp)return t.toString()===r.toString();if(e===Array){if((n=t.length)===r.length)for(;n--&&ae(t[n],r[n]););return n===-1}if(!e||typeof t=="object"){n=0;for(e in t)if(Ce.call(t,e)&&++n&&!Ce.call(r,e)||!(e in r)||!ae(t[e],r[e]))return!1;return Object.keys(r).length===n}}return t!==t&&r!==r}var F=H(require("node:fs")),ie=H(require("node:path")),De=H(require("node:crypto")),Ne=H(require("node:child_process")),Me=require("node:buffer"),J=H(require("node:stream")),We=require("node:util");var Ve=require("react/jsx-runtime");var fe=globalThis;function ft(t){let r=(0,l.useRef)(t),e=(0,l.useRef)(0);return ae(t,r.current)||(r.current=t,e.current+=1),(0,l.useMemo)(()=>r.current,[e.current])}function T(t){let r=(0,l.useRef)(t);return r.current=t,r}function dt(t,r){let e=t instanceof Error?t.message:String(t);return(0,w.showToast)({style:w.Toast.Style.Failure,title:r?.title??"Something went wrong",message:r?.message??e,primaryAction:r?.primaryAction??Re(t),secondaryAction:r?.primaryAction?Re(t):void 0})}var Re=t=>{let r=!0,e="[Extension Name]...",n="";try{let s=JSON.parse((0,F.readFileSync)((0,ie.join)(w.environment.assetsPath,"..","package.json"),"utf8"));e=`[${s.title}]...`,n=`https://raycast.com/${s.owner||s.author}/${s.name}`,(!s.owner||s.access==="public")&&(r=!1)}catch{}let a=w.environment.isDevelopment||r,i=t instanceof Error?t?.stack||t?.message||"":String(t);return{title:a?"Copy Logs":"Report Error",onAction(s){s.hide(),a?w.Clipboard.copy(i):(0,w.open)(`https://github.com/raycast/extensions/issues/new?&labels=extension%2Cbug&template=extension_bug_report.yml&title=${encodeURIComponent(e)}&extension-url=${encodeURI(n)}&description=${encodeURIComponent(`#### Error:
\`\`\`
${i}
\`\`\`
`)}`)}}};function ht(t,r,e){let n=(0,l.useRef)(0),[a,i]=(0,l.useState)({isLoading:!0}),s=T(t),c=T(e?.abortable),o=T(r||[]),f=T(e?.onError),u=T(e?.onData),g=T(e?.onWillExecute),v=T(e?.failureToastOptions),E=T(a.data),b=(0,l.useRef)(null),d=(0,l.useRef)({page:0}),S=(0,l.useRef)(!1),k=(0,l.useRef)(!0),$=(0,l.useRef)(50),p=(0,l.useCallback)(()=>(c.current&&(c.current.current?.abort(),c.current.current=new AbortController),++n.current),[c]),m=(0,l.useCallback)((...L)=>{let R=p();g.current?.(L),i(y=>({...y,isLoading:!0}));let W=pt(s.current)(...L);function V(y){return y.name=="AbortError"||R===n.current&&(f.current?f.current(y):w.environment.launchType!==w.LaunchType.Background&&dt(y,{title:"Failed to fetch latest data",primaryAction:{title:"Retry",onAction(N){N.hide(),b.current?.(...o.current||[])}},...v.current}),i({error:y,isLoading:!1})),y}return typeof W=="function"?(S.current=!0,W(d.current).then(({data:y,hasMore:N,cursor:le})=>(R===n.current&&(d.current&&(d.current.cursor=le,d.current.lastItem=y?.[y.length-1]),u.current&&u.current(y,d.current),N&&($.current=y.length),k.current=N,i(ue=>d.current.page===0?{data:y,isLoading:!1}:{data:(ue.data||[])?.concat(y),isLoading:!1})),y),y=>(k.current=!1,V(y)))):(S.current=!1,W.then(y=>(R===n.current&&(u.current&&u.current(y),i({data:y,isLoading:!1})),y),V))},[u,f,o,s,i,b,g,d,v,p]);b.current=m;let A=(0,l.useCallback)(()=>{d.current={page:0};let L=o.current||[];return m(...L)},[m,o]),P=(0,l.useCallback)(async(L,R)=>{let W;try{if(R?.optimisticUpdate){p(),typeof R?.rollbackOnError!="function"&&R?.rollbackOnError!==!1&&(W=structuredClone(E.current?.value));let V=R.optimisticUpdate;i(y=>({...y,data:V(y.data)}))}return await L}catch(V){if(typeof R?.rollbackOnError=="function"){let y=R.rollbackOnError;i(N=>({...N,data:y(N.data)}))}else R?.optimisticUpdate&&R?.rollbackOnError!==!1&&i(y=>({...y,data:W}));throw V}finally{R?.shouldRevalidateAfter!==!1&&(w.environment.launchType===w.LaunchType.Background||w.environment.commandMode==="menu-bar"?await A():A())}},[A,E,i,p]),K=(0,l.useCallback)(()=>{d.current.page+=1;let L=o.current||[];m(...L)},[d,o,m]);(0,l.useEffect)(()=>{d.current={page:0},e?.execute!==!1?m(...r||[]):p()},[ft([r,e?.execute,m]),c,d]),(0,l.useEffect)(()=>()=>{p()},[p]);let M=e?.execute!==!1?a.isLoading:!1,Q={...a,isLoading:M},ce=S.current?{pageSize:$.current,hasMore:k.current,onLoadMore:K}:void 0;return{...Q,revalidate:A,mutate:P,pagination:ce}}function pt(t){return t===Promise.all||t===Promise.race||t===Promise.resolve||t===Promise.reject?t.bind(Promise):t}function Te(t){return typeof t!="function"?!1:/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(t))!==null}function mt(t){return t instanceof URLSearchParams?t.toString():t}function ze(t,r=[]){function e(n){return"update"in t?t.update(n,"utf8"):t.write(n)}return{dispatch:function(n){n=mt(n),n===null?this._null():this["_"+typeof n](n)},_object:function(n){let a=/\[object (.*)\]/i,i=Object.prototype.toString.call(n),s=a.exec(i)?.[1]??"unknown:["+i+"]";s=s.toLowerCase();let c=null;if((c=r.indexOf(n))>=0){this.dispatch("[CIRCULAR:"+c+"]");return}else r.push(n);if(Buffer.isBuffer(n))return e("buffer:"),e(n.toString("utf8"));if(s!=="object"&&s!=="function"&&s!=="asyncfunction")if(this["_"+s])this["_"+s](n);else throw new Error('Unknown object type "'+s+'"');else{let o=Object.keys(n);o=o.sort(),Te(n)||o.splice(0,0,"prototype","__proto__","constructor"),e("object:"+o.length+":");let f=this;return o.forEach(function(u){f.dispatch(u),e(":"),f.dispatch(n[u]),e(",")})}},_array:function(n,a){a=typeof a<"u"?a:!1;let i=this;if(e("array:"+n.length+":"),!a||n.length<=1){n.forEach(function(o){i.dispatch(o)});return}let s=[],c=n.map(function(o){let f=gt(),u=r.slice();return ze(f,u).dispatch(o),s=s.concat(u.slice(r.length)),f.read().toString()});r=r.concat(s),c.sort(),this._array(c,!1)},_date:function(n){e("date:"+n.toJSON())},_symbol:function(n){e("symbol:"+n.toString())},_error:function(n){e("error:"+n.toString())},_boolean:function(n){e("bool:"+n.toString())},_string:function(n){e("string:"+n.length+":"),e(n.toString())},_function:function(n){e("fn:"),Te(n)?this.dispatch("[native]"):this.dispatch(n.toString()),this.dispatch("function-name:"+String(n.name)),this._object(n)},_number:function(n){e("number:"+n.toString())},_xml:function(n){e("xml:"+n.toString())},_null:function(){e("Null")},_undefined:function(){e("Undefined")},_regexp:function(n){e("regex:"+n.toString())},_uint8array:function(n){e("uint8array:"),this.dispatch(Array.prototype.slice.call(n))},_uint8clampedarray:function(n){e("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(n))},_int8array:function(n){e("int8array:"),this.dispatch(Array.prototype.slice.call(n))},_uint16array:function(n){e("uint16array:"),this.dispatch(Array.prototype.slice.call(n))},_int16array:function(n){e("int16array:"),this.dispatch(Array.prototype.slice.call(n))},_uint32array:function(n){e("uint32array:"),this.dispatch(Array.prototype.slice.call(n))},_int32array:function(n){e("int32array:"),this.dispatch(Array.prototype.slice.call(n))},_float32array:function(n){e("float32array:"),this.dispatch(Array.prototype.slice.call(n))},_float64array:function(n){e("float64array:"),this.dispatch(Array.prototype.slice.call(n))},_arraybuffer:function(n){e("arraybuffer:"),this.dispatch(new Uint8Array(n))},_url:function(n){e("url:"+n.toString())},_map:function(n){e("map:");let a=Array.from(n);this._array(a,!0)},_set:function(n){e("set:");let a=Array.from(n);this._array(a,!0)},_file:function(n){e("file:"),this.dispatch([n.name,n.size,n.type,n.lastModified])},_blob:function(){throw Error(`Hashing Blob objects is currently not supported
(see https://github.com/puleos/object-hash/issues/26)
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow:function(){e("domwindow")},_bigint:function(n){e("bigint:"+n.toString())},_process:function(){e("process")},_timer:function(){e("timer")},_pipe:function(){e("pipe")},_tcp:function(){e("tcp")},_udp:function(){e("udp")},_tty:function(){e("tty")},_statwatcher:function(){e("statwatcher")},_securecontext:function(){e("securecontext")},_connection:function(){e("connection")},_zlib:function(){e("zlib")},_context:function(){e("context")},_nodescript:function(){e("nodescript")},_httpparser:function(){e("httpparser")},_dataview:function(){e("dataview")},_signal:function(){e("signal")},_fsevent:function(){e("fsevent")},_tlswrap:function(){e("tlswrap")}}}function gt(){return{buf:"",write:function(t){this.buf+=t},end:function(t){this.buf+=t},read:function(){return this.buf}}}function bt(t,r){let e=this[t];return e instanceof Date?`__raycast_cached_date__${e.toISOString()}`:Buffer.isBuffer(e)?`__raycast_cached_buffer__${e.toString("base64")}`:r}function yt(t,r){return typeof r=="string"&&r.startsWith("__raycast_cached_date__")?new Date(r.replace("__raycast_cached_date__","")):typeof r=="string"&&r.startsWith("__raycast_cached_buffer__")?Buffer.from(r.replace("__raycast_cached_buffer__",""),"base64"):r}function Ie(t){let r=De.default.createHash("sha1");return ze(r).dispatch(t),r.digest("hex")}var $t=Symbol("cache without namespace"),_e=new Map;function wt(t,r,e){let n=e?.cacheNamespace||$t,a=_e.get(n)||_e.set(n,new w.Cache({namespace:e?.cacheNamespace})).get(n);if(!a)throw new Error("Missing cache");let i=T(t),s=T(r),c=(0,l.useSyncExternalStore)(a.subscribe,()=>{try{return a.get(i.current)}catch(g){console.error("Could not get Cache data:",g);return}}),o=(0,l.useMemo)(()=>{if(typeof c<"u"){if(c==="undefined")return;try{return JSON.parse(c,yt)}catch(g){return console.warn("The cached data is corrupted",g),s.current}}else return s.current},[c,s]),f=T(o),u=(0,l.useCallback)(g=>{let v=typeof g=="function"?g(f.current):g;if(typeof v>"u")a.set(i.current,"undefined");else{let E=JSON.stringify(v,bt);a.set(i.current,E)}return v},[a,i,f]);return[o,u]}var Z=Symbol();function kt(t,r,e){let{initialData:n,keepPreviousData:a,internal_cacheKeySuffix:i,...s}=e||{},c=(0,l.useRef)(null),[o,f]=wt(Ie(r||[])+i,Z,{cacheNamespace:Ie(t)}),u=(0,l.useRef)(o!==Z?o:n),g=(0,l.useRef)(void 0),{mutate:v,revalidate:E,...b}=ht(t,r||[],{...s,onData(p,m){g.current=m,s.onData&&s.onData(p,m),!(m&&m.page>0)&&(c.current="promise",u.current=p,f(p))}}),d,S=b.pagination;g.current&&g.current.page>0&&b.data?d=b.data:c.current==="promise"?d=u.current:a&&o!==Z?(d=o,S&&(S.hasMore=!0,S.pageSize=o.length)):a&&o===Z?d=u.current:o!==Z?(d=o,S&&(S.hasMore=!0,S.pageSize=o.length)):d=n;let k=T(d),$=(0,l.useCallback)(async(p,m)=>{let A;try{if(m?.optimisticUpdate){typeof m?.rollbackOnError!="function"&&m?.rollbackOnError!==!1&&(A=structuredClone(k.current));let P=m.optimisticUpdate(k.current);c.current="cache",u.current=P,f(P)}return await v(p,{shouldRevalidateAfter:m?.shouldRevalidateAfter})}catch(P){if(typeof m?.rollbackOnError=="function"){let K=m.rollbackOnError(k.current);c.current="cache",u.current=K,f(K)}else m?.optimisticUpdate&&m?.rollbackOnError!==!1&&(c.current="cache",u.current=A,f(A));throw P}},[f,v,k,u,c]);return(0,l.useEffect)(()=>{o!==Z&&(c.current="cache",u.current=o)},[o]),{data:d,isLoading:b.isLoading,error:b.error,mutate:g.current&&g.current.page>0?v:$,pagination:S,revalidate:E}}var se=t=>!!t&&typeof t=="object"&&typeof t.removeListener=="function"&&typeof t.emit=="function"&&typeof t.reallyExit=="function"&&typeof t.listeners=="function"&&typeof t.kill=="function"&&typeof t.pid=="number"&&typeof t.on=="function",de=Symbol.for("signal-exit emitter"),me=class{constructor(){if(this.emitted={afterExit:!1,exit:!1},this.listeners={afterExit:[],exit:[]},this.count=0,this.id=Math.random(),fe[de])return fe[de];Object.defineProperty(fe,de,{value:this,writable:!1,enumerable:!1,configurable:!1})}on(r,e){this.listeners[r].push(e)}removeListener(r,e){let n=this.listeners[r],a=n.indexOf(e);a!==-1&&(a===0&&n.length===1?n.length=0:n.splice(a,1))}emit(r,e,n){if(this.emitted[r])return!1;this.emitted[r]=!0;let a=!1;for(let i of this.listeners[r])a=i(e,n)===!0||a;return r==="exit"&&(a=this.emit("afterExit",e,n)||a),a}},ge=class{onExit(){return()=>{}}load(){}unload(){}},be=class{#o;#t;#e;#s;#i;#a;#n;#r;constructor(r){this.#o=process.platform==="win32"?"SIGINT":"SIGHUP",this.#t=new me,this.#a={},this.#n=!1,this.#r=[],this.#r.push("SIGHUP","SIGINT","SIGTERM"),globalThis.process.platform!=="win32"&&this.#r.push("SIGALRM","SIGABRT","SIGVTALRM","SIGXCPU","SIGXFSZ","SIGUSR2","SIGTRAP","SIGSYS","SIGQUIT","SIGIOT"),globalThis.process.platform==="linux"&&this.#r.push("SIGIO","SIGPOLL","SIGPWR","SIGSTKFLT"),this.#e=r,this.#a={};for(let e of this.#r)this.#a[e]=()=>{let n=this.#e.listeners(e),{count:a}=this.#t,i=r;if(typeof i.__signal_exit_emitter__=="object"&&typeof i.__signal_exit_emitter__.count=="number"&&(a+=i.__signal_exit_emitter__.count),n.length===a){this.unload();let s=this.#t.emit("exit",null,e),c=e==="SIGHUP"?this.#o:e;s||r.kill(r.pid,c)}};this.#i=r.reallyExit,this.#s=r.emit}onExit(r,e){if(!se(this.#e))return()=>{};this.#n===!1&&this.load();let n=e?.alwaysLast?"afterExit":"exit";return this.#t.on(n,r),()=>{this.#t.removeListener(n,r),this.#t.listeners.exit.length===0&&this.#t.listeners.afterExit.length===0&&this.unload()}}load(){if(!this.#n){this.#n=!0,this.#t.count+=1;for(let r of this.#r)try{let e=this.#a[r];e&&this.#e.on(r,e)}catch{}this.#e.emit=(r,...e)=>this.#l(r,...e),this.#e.reallyExit=r=>this.#c(r)}}unload(){this.#n&&(this.#n=!1,this.#r.forEach(r=>{let e=this.#a[r];if(!e)throw new Error("Listener not defined for signal: "+r);try{this.#e.removeListener(r,e)}catch{}}),this.#e.emit=this.#s,this.#e.reallyExit=this.#i,this.#t.count-=1)}#c(r){return se(this.#e)?(this.#e.exitCode=r||0,this.#t.emit("exit",this.#e.exitCode,null),this.#i.call(this.#e,this.#e.exitCode)):0}#l(r,...e){let n=this.#s;if(r==="exit"&&se(this.#e)){typeof e[0]=="number"&&(this.#e.exitCode=e[0]);let a=n.call(this.#e,r,...e);return this.#t.emit("exit",this.#e.exitCode,null),a}else return n.call(this.#e,r,...e)}},he=null,xt=(t,r)=>(he||(he=se(process)?new be(process):new ge),he.onExit(t,r));function St(t,{timeout:r}={}){let e=new Promise((c,o)=>{t.on("exit",(f,u)=>{c({exitCode:f,signal:u,timedOut:!1})}),t.on("error",f=>{o(f)}),t.stdin&&t.stdin.on("error",f=>{o(f)})}),n=xt(()=>{t.kill()});if(r===0||r===void 0)return e.finally(()=>n());let a,i=new Promise((c,o)=>{a=setTimeout(()=>{t.kill("SIGTERM"),o(Object.assign(new Error("Timed out"),{timedOut:!0,signal:"SIGTERM"}))},r)}),s=e.finally(()=>{clearTimeout(a)});return Promise.race([i,s]).finally(()=>n())}var ye=class extends Error{constructor(){super("The output is too big"),this.name="MaxBufferError"}};function vt(t){let{encoding:r}=t,e=r==="buffer",n=new J.default.PassThrough({objectMode:!1});r&&r!=="buffer"&&n.setEncoding(r);let a=0,i=[];return n.on("data",s=>{i.push(s),a+=s.length}),n.getBufferedValue=()=>e?Buffer.concat(i,a):i.join(""),n.getBufferedLength=()=>a,n}async function Ue(t,r){let e=vt(r);return await new Promise((n,a)=>{let i=s=>{s&&e.getBufferedLength()<=Me.constants.MAX_LENGTH&&(s.bufferedData=e.getBufferedValue()),a(s)};(async()=>{try{await(0,We.promisify)(J.default.pipeline)(t,e),n()}catch(s){i(s)}})(),e.on("data",()=>{e.getBufferedLength()>8e7&&i(new ye)})}),e.getBufferedValue()}async function Oe(t,r){t.destroy();try{return await r}catch(e){return e.bufferedData}}async function Et({stdout:t,stderr:r},{encoding:e},n){let a=Ue(t,{encoding:e}),i=Ue(r,{encoding:e});try{return await Promise.all([n,a,i])}catch(s){return Promise.all([{error:s,exitCode:null,signal:s.signal,timedOut:s.timedOut||!1},Oe(t,a),Oe(r,i)])}}function At(t){let r=typeof t=="string"?`
`:10,e=typeof t=="string"?"\r":13;return t[t.length-1]===r&&(t=t.slice(0,-1)),t[t.length-1]===e&&(t=t.slice(0,-1)),t}function Le(t,r){return t.stripFinalNewline?At(r):r}function Pt({timedOut:t,timeout:r,signal:e,exitCode:n}){return t?`timed out after ${r} milliseconds`:e!=null?`was killed with ${e}`:n!=null?`failed with exit code ${n}`:"failed"}function Ct({stdout:t,stderr:r,error:e,signal:n,exitCode:a,command:i,timedOut:s,options:c,parentError:o}){let u=`Command ${Pt({timedOut:s,timeout:c?.timeout,signal:n,exitCode:a})}: ${i}`,g=e?`${u}
${e.message}`:u,v=[g,r,t].filter(Boolean).join(`
`);return e?e.originalMessage=e.message:e=o,e.message=v,e.shortMessage=g,e.command=i,e.exitCode=a,e.signal=n,e.stdout=t,e.stderr=r,"bufferedData"in e&&delete e.bufferedData,e}function Rt({stdout:t,stderr:r,error:e,exitCode:n,signal:a,timedOut:i,command:s,options:c,parentError:o}){if(e||n!==0||a!==null)throw Ct({error:e,exitCode:n,signal:a,stdout:t,stderr:r,command:s,timedOut:i,options:c,parentError:o});return t}var Tt=/ +/g;function It(t,r){if(r)return[t,...r];let e=[];for(let n of t.trim().split(Tt)){let a=e[e.length-1];a&&a.endsWith("\\")?e[e.length-1]=`${a.slice(0,-1)} ${n}`:e.push(n)}return e}function Fe(t,r,e){let{parseOutput:n,input:a,onData:i,onWillExecute:s,initialData:c,execute:o,keepPreviousData:f,onError:u,failureToastOptions:g,...v}=Array.isArray(r)?e||{}:r||{},E={initialData:c,execute:o,keepPreviousData:f,onError:u,onData:i,onWillExecute:s,failureToastOptions:g},b=(0,l.useRef)(null),d=T(n||Rt),S=(0,l.useCallback)(async(k,$,p,m)=>{let[A,...P]=It(k,$),K=[A,...P].join(" "),M={stripFinalNewline:!0,...p,timeout:p?.timeout||1e4,signal:b.current?.signal,encoding:p?.encoding===null?"buffer":p?.encoding||"utf8",env:{PATH:"/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin",...process.env,...p?.env}},Q=Ne.default.spawn(A,P,M),ce=St(Q,M);m&&Q.stdin.end(m);let[{error:L,exitCode:R,signal:W,timedOut:V},y,N]=await Et(Q,M,ce),le=Le(M,y),ue=Le(M,N);return d.current({stdout:le,stderr:ue,error:L,exitCode:R,signal:W,timedOut:V,command:K,options:M,parentError:new Error})},[d]);return kt(S,[t,Array.isArray(r)?r:[],v,a],{...E,abortable:b})}function pe(t,r){if(t){if(typeof t=="function")return t(r);if(t==="required"){let e=typeof r<"u"&&r!==null;if(e)switch(typeof r){case"string":e=r.length>0;break;case"object":Array.isArray(r)?e=r.length>0:r instanceof Date&&(e=r.getTime()>0);break;default:break}if(!e)return"The item is required"}}}function je(t){let{onSubmit:r,validation:e,initialValues:n={}}=t,[a,i]=(0,l.useState)(n),[s,c]=(0,l.useState)({}),o=(0,l.useRef)({}),f=T(e||{}),u=T(r),g=(0,l.useCallback)(k=>{o.current[k]?.focus()},[o]),v=(0,l.useCallback)(async k=>{let $=!1;for(let[m,A]of Object.entries(f.current)){let P=pe(A,k[m]);P&&($||($={},g(m)),$[m]=P)}if($)return c($),!1;let p=await u.current(k);return typeof p=="boolean"?p:!0},[f,u,g]),E=(0,l.useCallback)((k,$)=>{c(p=>({...p,[k]:$}))},[c]),b=(0,l.useCallback)(function(k,$){i(p=>({...p,[k]:typeof $=="function"?$(p[k]):$}))},[i]),d=(0,l.useMemo)(()=>new Proxy({},{get(k,$){let p=f.current[$],m=a[$];return{onChange(A){s[$]&&(pe(p,A)||E($,void 0)),b($,A)},onBlur(A){let P=pe(p,A.target.value);P&&E($,P)},error:s[$],id:$,value:typeof m>"u"?null:m,ref:A=>{o.current[$]=A}}}}),[s,f,E,a,o,b]),S=(0,l.useCallback)(k=>{c({}),Object.entries(o.current).forEach(([$,p])=>{k?.[$]||p?.reset()}),k&&i(k)},[i,c,o]);return{handleSubmit:v,setValidationError:E,setValue:b,values:a,itemProps:d,focus:g,reset:S}}var ee=require("node:child_process"),xe=require("node:fs"),Be=(0,j.getPreferenceValues)(),z=class extends Error{title;constructor(r,e){e||(e=r),super(e),this.title=r}},Y=class extends z{},we=class extends z{},ke=class extends z{},oe=class extends z{},U=()=>{let t=[Be.cliPath,"/usr/local/bin/op","/opt/homebrew/bin/op"].filter(Boolean).find(r=>r?(0,xe.existsSync)(r):!1);if(!t)throw new Y("1Password CLI is not found. Please set the path in the extension preferences.");return t},q=[Be.zshPath,"/bin/zsh"].find(t=>(0,xe.existsSync)(t)),Ge=new RegExp(/\[\w+\]\s+\d{4}\/\d{2}\/\d{2}\s+\d{2}:\d{2}:\d{2}\s+(.*)$/m);function Ke(t){let r=U();if(r)return(0,ee.execFileSync)(r,t,{maxBuffer:4194304}).toString();throw Error("1Password CLI is not found!")}var $e=t=>{throw t.includes("no such host")?new we("No connection to 1Password.","Verify Your Internet Connection."):t.includes("could not get item")||t.includes("isn't an item")?new ke("Item not found on 1Password.","Check it on your 1Password app."):t.includes("ENOENT")||t.includes("file")||t.includes("enoent")?new Y("1Password CLI not found."):t.includes("does not have a field")?new z(`Item does not contain the field ${t.split("does not have a field ")[1].trim()}.`):new z(t)},He=()=>!!q,Se=t=>(0,ee.execSync)(`${U()} signin ${t||""}`,{shell:q}),Ze=()=>{try{return(0,ee.execSync)(`${U()} whoami`),!0}catch{return!1}};var Je=(t=!0)=>Fe(U(),["account","list","--format=json"],{execute:t,onError:async r=>{await(0,j.showToast)({style:j.Toast.Style.Failure,title:r.message})},parseOutput:({error:r,exitCode:e,stderr:n,stdout:a})=>(r&&$e(r.message),n&&$e(n),e!=0&&$e(a),JSON.parse(a))});var I=require("@raycast/api");var X=require("@raycast/api");async function te(){let t=await(0,X.showToast)({style:X.Toast.Style.Animated,title:"Clearing cache..."});try{Ke(["signout","--all"]),t.style=X.Toast.Style.Success,t.title="Cleared cache"}catch(r){t.style=X.Toast.Style.Failure,t.title="Failed to clear cache",r instanceof Error&&(t.message=r.message)}}var B=require("react/jsx-runtime");function Ye(){let t=U(),r=`
${t?"":"# 1Password CLI Tool Not Configured or Installed Properly"}
${t?"":"# Zsh Shell Not Configured or Installed Properly"}

${t?"":`
-  Ensure that the 1Password CLI is installed on your system. You can download it from [official 1Password CLI website](https://developer.1password.com/docs/cli/get-started).
-  Check if the path to the 1Password CLI is correctly added to your system's environment variables.
-  Run \`op --version\` to verify that the 1Password CLI is correctly installed.
`}


${q?"":"\n-  Make sure that Zsh is installed by running `zsh --version` in your terminal.\n-  Review your `.zshrc` file for any incorrect configurations that might be causing issues.\n-  Review your extension preferences for the Zsh shell path.\n"}

### Need More Help?
If you continue to experience problems after following these steps, please reach out by opening an issue in our [Github](https://github.com/raycast/extensions/issues/new/choose)

We're here to help ensure a smooth setup process!

---`;return(0,B.jsx)(I.Detail,{actions:(0,B.jsxs)(I.ActionPanel,{children:[(0,B.jsx)(I.Action,{icon:I.Icon.Gear,onAction:I.openExtensionPreferences,title:"Open Extension Preferences"}),(0,B.jsx)(I.Action.Open,{target:"onepassword://settings",title:"Open 1Password Settings"}),(0,B.jsx)(I.Action,{icon:I.Icon.Trash,onAction:()=>te(),title:"Reset Cache"})]}),markdown:r})}var C=require("@raycast/api"),ve=require("node:path");var G=require("react/jsx-runtime"),_t=(0,ve.join)(C.environment.assetsPath,"binary-instruction.png"),Ut=(0,ve.join)(C.environment.assetsPath,"1password-settings.png"),Ot=`
# You will need the following to run the extension

## \u2705 1Password CLI

### This extension utilizes the 1Password CLI tool. You can setup the tool by following their [official document](https://developer.1password.com/docs/cli/get-started/).

### In case there's an issue with the tool, check the following.
![Terminal Instruction](${_t})

## \u2705 Enable Command-Line Interface (CLI)

### To turn on the app integration and set up 1Password to authenticate with biometrics:
![1Password Settings](${Ut})

1. Open [1Password](onepassword://settings).
2. Select the account or collection at the top of the sidebar and choose Preferences > Security.
3. Check [Touch ID](https://support.1password.com/touch-id-mac/).
4. Select Developer in the sidebar.
5. Check "Connect with 1Password CLI".

You can also unlock 1Password CLI with your [Apple Watch](https://support.1password.com/apple-watch-mac/).
`;function qe(){return(0,G.jsx)(C.Detail,{actions:(0,G.jsxs)(C.ActionPanel,{children:[(0,G.jsx)(C.Action,{icon:C.Icon.Gear,onAction:C.openExtensionPreferences,title:"Open Extension Preferences"}),(0,G.jsx)(C.Action.Open,{target:"onepassword://settings",title:"Open 1Password Settings"}),(0,G.jsx)(C.Action,{icon:C.Icon.Trash,onAction:()=>te(),title:"Reset Cache"})]}),markdown:Ot})}var _=require("react/jsx-runtime"),Lt=(0,D.createContext)(void 0),Xe=({children:t})=>{try{U()}catch{return(0,_.jsx)(qe,{})}let[r,e]=(0,D.useState)(Ze()),[n]=(0,D.useState)(!He()),[a,i]=(0,D.useState)(!0),[s,c]=(0,D.useState)(""),{data:o,error:f,isLoading:u}=Je(!a),g=h.environment.raycastVersion.includes("alpha")?"raycastinternal://":"raycast://",v=async b=>{let d=await(0,h.showToast)({style:h.Toast.Style.Animated,title:"Signing in..."});try{Se(`--account ${b.account}`),e(!0),i(!0),d.style=h.Toast.Style.Success,d.title="Signed in"}catch(S){d.style=h.Toast.Style.Failure,d.title="Failed to sign in",S instanceof Error&&(d.message=S.message,d.primaryAction={onAction:async k=>{await h.Clipboard.copy(S.message),k.hide()},title:"Copy logs"})}},E=async()=>{await(0,h.closeMainWindow)({popToRootType:h.PopToRootType.Suspended});let b=await(0,h.showToast)({style:h.Toast.Style.Animated,title:"Authenticating..."});try{if(!q)throw new oe("Zsh Binary Path Missing!");if(!U())throw new Y("1Password CLI is missing! Please install it before use.");Se(),e(!0),i(!0),b.style=h.Toast.Style.Success,b.title="Authenticated!";return}catch(d){if(!(d instanceof Error)){b.style=h.Toast.Style.Failure,b.title="Error Authenticating.",b.message=String(d);return}let S=d.message.match(Ge);if(S&&S[1]?c(S[1]):c(d.message),d.message.includes("multiple accounts found"))return i(!1);b.style=h.Toast.Style.Failure,b.title="Error Authenticating."}finally{await(0,h.open)(g)}};return(0,D.useEffect)(()=>{!r&&!n&&E()},[r,n]),a?n?(0,_.jsx)(Ye,{}):r?(0,_.jsx)(Lt.Provider,{value:{isAuthenticated:r},children:t}):(0,_.jsx)(h.List,{children:(0,_.jsx)(h.List.EmptyView,{actions:(0,_.jsx)(h.ActionPanel,{children:(0,_.jsx)(h.Action,{icon:h.Icon.Repeat,onAction:()=>E(),title:"Reload"},"reload-view")}),description:s||"Please authenticate using the requested method to proceed.",icon:h.Icon.Key,title:"Authentication Required"})}):(0,_.jsx)(h.Form,{actions:(0,_.jsx)(h.ActionPanel,{children:(0,_.jsx)(h.Action.SubmitForm,{icon:h.Icon.Key,onSubmit:v,title:"Sign in"})}),isLoading:u,children:(0,_.jsx)(h.Form.Dropdown,{autoFocus:!0,id:"account",title:"Account",children:(o&&!f?o:[]).map(b=>(0,_.jsx)(h.Form.Dropdown.Item,{title:`${b.url} - ${b.email}`,value:b.account_uuid},b.account_uuid))})})};var x=require("@raycast/api");var et=require("node:child_process"),re=require("react");var O=require("react/jsx-runtime"),Qe=x.Keyboard.Shortcut,Ee=x.Toast.Style;function tt(){let[t,r]=(0,re.useState)(!1),[e,n]=(0,re.useState)(null),{handleSubmit:a,itemProps:i,values:s}=je({initialValues:{length:"12",numbers:!0,symbols:!0},onSubmit:async c=>{r(!0),n(null);let o=await(0,x.showToast)(Ee.Animated,"Generating password...","Please wait a moment"),f=["letters",c.length];c.numbers&&f.push("digits"),c.symbols&&f.push("symbols");try{let u=(0,et.execFileSync)(U(),["item","create","--dry-run","--category","Password",`--generate-password=${f.join(",")}`,"--format","json"]),v=JSON.parse(u.toString()).fields?.filter(E=>E.id==="password").filter(Boolean).map(E=>E.value).at(0);n(v||"ERROR"),await x.Clipboard.copy(v||"",{concealed:!0}),o.style=Ee.Success,o.title="Copied to clipboard!",o.message=""}catch(u){o.style=Ee.Failure,o.title="Failed to generate password",u instanceof Error&&(o.message=u.message,o.primaryAction={onAction:async g=>{await x.Clipboard.copy(u.message),await g.hide()},title:"Copy logs"})}finally{r(!1)}},validation:{length:c=>{if(c&&isNaN(parseInt(c)))return"Must be a number";if(c&&(parseInt(c)<4||parseInt(c)>64))return"Password length must be between 5 and 64 characters";if(!c)return"The item is required"}}});return(0,re.useEffect)(()=>{a(s)},[]),(0,O.jsxs)(x.Form,{actions:(0,O.jsxs)(x.ActionPanel,{children:[(0,O.jsx)(x.Action.SubmitForm,{icon:x.Icon.Key,onSubmit:a,shortcut:Qe.Common.Refresh,title:"Regenerate Password"}),e&&(0,O.jsx)(x.Action.CopyToClipboard,{concealed:!0,content:e||"",icon:x.Icon.Clipboard,shortcut:Qe.Common.Copy})]}),isLoading:t,navigationTitle:"Customize your password",children:[(0,O.jsx)(x.Form.Description,{text:`${e||"Generating..."}


`,title:"\u{1F511} Password"}),(0,O.jsx)(x.Form.Separator,{}),(0,O.jsx)(x.Form.TextField,{title:"Characters",...i.length}),(0,O.jsx)(x.Form.Checkbox,{label:"0123456789",title:"Numbers",...i.numbers}),(0,O.jsx)(x.Form.Checkbox,{label:"!@.-_*",title:"Symbols",...i.symbols})]})}var Ae=require("react/jsx-runtime");function nt(){return(0,rt.getPreferenceValues)().version=="v8"?(0,Ae.jsx)(Xe,{children:(0,Ae.jsx)(tt,{})}):null}
